import{y as R,r as c,c as T,z as A,e as r,g,f as y,w as l,d as e,l as n,i as H,h as I,t as V,p as J}from"./index-BV9e5Yt5.js";import{u as K,a as L,g as Q}from"./ProyectoEstructuraView-DVKqiHsd.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./useProcedenciaFondos-DCzG2v-v.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const so={__name:"ProductoGralNodo",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(b,{emit:x}){const s=b,{updateProductoGeneral:P}=Q(),{getNodes:C,getEdges:w,updateNode:k}=K(),{actualizarNodosEdges:N}=L(),E=x,U=R("proyectoEstructura"),t=c({...s.node.data}),v=c(!1),u=c(!1),p=T(()=>!s.node.id);A(()=>s.node,d=>{t.value={...d.data}},{deep:!0});const D=async()=>{try{const d=t.value.nodoProyecto.id,o=U.value.mapa_nodo.id;console.log(d),console.log(o),await P(d,t.value.nodoProyecto),k(t.value.id,t.value),await N(o,C.value,w.value),E("guardar")}catch(d){console.error("Update informacion",d)}},q=()=>{u.value=!0},B=async()=>{u.value=!1,v.value=!0};return(d,o)=>{const G=r("v-text-field"),m=r("v-textarea"),S=r("v-checkbox"),_=r("v-spacer"),i=r("v-btn"),f=r("v-card-actions"),$=r("v-icon"),j=r("v-card-title"),z=r("v-card-text"),F=r("v-card"),M=r("v-dialog"),O=r("v-form");return y(),g(O,{onSubmit:J(D,["prevent"])},{default:l(()=>[e(G,{modelValue:t.value.nodoProyecto.codigo,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.nodoProyecto.codigo=a),variant:"outlined",label:"Codigo",outlined:"",dense:"",clearable:"",rules:[a=>!!a||"Código requerido"]},null,8,["modelValue","rules"]),e(m,{modelValue:t.value.nodoProyecto.descripcion,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.nodoProyecto.descripcion=a),variant:"outlined",label:"Descripcion",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.supuestos,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.nodoProyecto.supuestos=a),variant:"outlined",label:"Supuestos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.riesgos,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.nodoProyecto.riesgos=a),variant:"outlined",label:"Riesgos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(S,{modelValue:t.value.nodoProyecto.entregado,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.nodoProyecto.entregado=a)},{label:l(()=>o[8]||(o[8]=[H("div",{class:"custom-label"},"Entregado",-1)])),_:1},8,["modelValue"]),e(f,null,{default:l(()=>[e(_),p.value?I("",!0):(y(),g(i,{key:0,color:"error",text:"",onClick:q},{default:l(()=>o[9]||(o[9]=[n(" Eliminar ")])),_:1,__:[9]})),e(i,{color:"error",text:"",onClick:o[5]||(o[5]=a=>d.$emit("cancelar"))},{default:l(()=>o[10]||(o[10]=[n("Cancelar")])),_:1,__:[10]}),e(i,{color:"primary",type:"submit",loading:v.value},{default:l(()=>[n(V(p.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),n(" "+V(t.value)+" ",1),e(M,{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=a=>u.value=a),"max-width":"400"},{default:l(()=>[e(F,null,{default:l(()=>[e(j,{class:"text-h6"},{default:l(()=>[e($,{left:"",color:"error"},{default:l(()=>o[11]||(o[11]=[n("mdi-alert-circle")])),_:1,__:[11]}),o[12]||(o[12]=n(" Confirmar eliminación "))]),_:1,__:[12]}),e(z,null,{default:l(()=>o[13]||(o[13]=[n(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[13]}),e(f,null,{default:l(()=>[e(_),e(i,{color:"grey",variant:"text",onClick:o[6]||(o[6]=a=>u.value=!1)},{default:l(()=>o[14]||(o[14]=[n(" Cancelar ")])),_:1,__:[14]}),e(i,{color:"error",variant:"flat",onClick:B},{default:l(()=>o[15]||(o[15]=[n(" Confirmar ")])),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{so as default};
