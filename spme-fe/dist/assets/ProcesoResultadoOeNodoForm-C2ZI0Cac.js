import{y as T,r as c,c as G,z as M,e as r,g as y,f as V,w as t,d as e,h as R,l as d,t as A,p as H}from"./index-BV9e5Yt5.js";import{u as I,a as J,h as K}from"./ProyectoEstructuraView-DVKqiHsd.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./useProcedenciaFondos-DCzG2v-v.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const io={__name:"ProcesoResultadoOeNodoForm",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(C,{emit:x}){const s=C,{updateProceso:P}=K(),{getNodes:b,getEdges:w,updateNode:k}=I(),{actualizarNodosEdges:N}=J(),E=x,m=T("proyectoEstructura"),a=c({...s.node.data}),p=c(!1),i=c(!1),v=G(()=>!s.node.id);M(()=>s.node,n=>{a.value={...n.data}},{deep:!0});const D=async()=>{try{const n=a.value.nodoProyecto.id;console.log(n);const o=m.value.mapa_nodo.id;console.log(m),await P(n,a.value.nodoProyecto),k(a.value.id,a.value),await N(o,b.value,w.value),E("guardar")}catch(n){console.error("Update informacion",n)}},U=()=>{i.value=!0},q=async()=>{i.value=!1,p.value=!0};return(n,o)=>{const $=r("v-text-field"),_=r("v-textarea"),f=r("v-spacer"),u=r("v-btn"),g=r("v-card-actions"),j=r("v-icon"),z=r("v-card-title"),B=r("v-card-text"),F=r("v-card"),O=r("v-dialog"),S=r("v-form");return V(),y(S,{onSubmit:H(D,["prevent"])},{default:t(()=>[e($,{modelValue:a.value.nodoProyecto.codigo,"onUpdate:modelValue":o[0]||(o[0]=l=>a.value.nodoProyecto.codigo=l),variant:"outlined",label:"Código",outlined:"",dense:"",clearable:"",rules:[l=>!!l||"Código requerido"]},null,8,["modelValue","rules"]),e(_,{modelValue:a.value.nodoProyecto.titulo,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value.nodoProyecto.titulo=l),variant:"outlined",label:"Titulo",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(_,{modelValue:a.value.nodoProyecto.descripcion,"onUpdate:modelValue":o[2]||(o[2]=l=>a.value.nodoProyecto.descripcion=l),variant:"outlined",label:"Descripción",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(g,null,{default:t(()=>[e(f),v.value?R("",!0):(V(),y(u,{key:0,color:"error",text:"",onClick:U},{default:t(()=>o[6]||(o[6]=[d(" Eliminar ")])),_:1,__:[6]})),e(u,{color:"error",text:"",onClick:o[3]||(o[3]=l=>n.$emit("cancelar"))},{default:t(()=>o[7]||(o[7]=[d("Cancelar")])),_:1,__:[7]}),e(u,{color:"primary",type:"submit",loading:p.value},{default:t(()=>[d(A(v.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),e(O,{modelValue:i.value,"onUpdate:modelValue":o[5]||(o[5]=l=>i.value=l),"max-width":"400"},{default:t(()=>[e(F,null,{default:t(()=>[e(z,{class:"text-h6"},{default:t(()=>[e(j,{left:"",color:"error"},{default:t(()=>o[8]||(o[8]=[d("mdi-alert-circle")])),_:1,__:[8]}),o[9]||(o[9]=d(" Confirmar eliminación "))]),_:1,__:[9]}),e(B,null,{default:t(()=>o[10]||(o[10]=[d(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[10]}),e(g,null,{default:t(()=>[e(f),e(u,{color:"grey",variant:"text",onClick:o[4]||(o[4]=l=>i.value=!1)},{default:t(()=>o[11]||(o[11]=[d(" Cancelar ")])),_:1,__:[11]}),e(u,{color:"error",variant:"flat",onClick:q},{default:t(()=>o[12]||(o[12]=[d(" Confirmar ")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{io as default};
