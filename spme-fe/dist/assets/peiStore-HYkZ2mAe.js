import{x as h,r as n}from"./index-BV9e5Yt5.js";import{p as s,o as w,i as b}from"./peiService-DMb0o3t4.js";const E=h("pei",()=>{const v=n([]),u=n(null),y=n(null),i=n(null),r=n(!1),o=n(null),g=async()=>{r.value=!0,o.value=null;try{v.value=await s.obtenerTodos()}catch(e){o.value=e.message}finally{r.value=!1}},I=async e=>{r.value=!0;try{u.value=await s.obtenerPorId(e)}catch(a){o.value=a.message}finally{r.value=!1}},j=async e=>{r.value=!0;try{y.value=await s.obtenerEstructuraPorId(e)}catch(a){o.value=a.message}finally{r.value=!1}},m=async e=>{r.value=!0;try{i.value=await s.obtenerPeiObjIndPorId(e)}catch(a){o.value=a.message}finally{r.value=!1}},c=e=>{var a,t;(a=i.value)!=null&&a.objetivos&&(i.value.objetivos=i.value.objetivos.filter(l=>l.id!==e)),(t=u.value)!=null&&t.objetivos&&(u.value.objetivos=u.value.objetivos.filter(l=>l.id!==e))},P=async e=>{r.value=!0,o.value=null;try{return await w.eliminar(e),c(e),!0}catch(a){return o.value=a.message,!1}finally{r.value=!1}},d=(e,a,t)=>{var f;if(!((f=i.value)!=null&&f.objetivos))return;const l=i.value.objetivos.findIndex(p=>p.id===e);l!==-1&&(i.value.objetivos[l].indicadores||(i.value.objetivos[l].indicadores=[]),i.value.objetivos[l].indicadores.push({...a,tipo:t}))};return{peis:v,peiActual:u,peiObjIndPorId:i,cargando:r,error:o,obtenerPeis:g,obtenerPeiPorId:I,obtenerPeiObjInd:m,obtenerPeiEstructuraPorId:j,removerObjetivoLocalmente:c,eliminarObjetivo:P,agregarIndicadorCualitativo:async(e,a)=>{r.value=!0,o.value=null;try{const t=await b.crearIndCualitativo(a);return d(e,t,"cualitativo"),t}catch(t){throw o.value=t.message,t}finally{r.value=!1}},agregarIndicadorCuantitativo:async(e,a)=>{r.value=!0,o.value=null;try{const t=await b.crearIndCuantitativo(a);return d(e,t,"cuantitativo"),t}catch(t){throw o.value=t.message,t}finally{r.value=!1}}}});export{E as u};
