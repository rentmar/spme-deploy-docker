import{u as CA}from"./proyectoStore-DvgR2axb.js";import{A as qP,Z as yA,b as Yr,f as on,D as bA,_ as Tb,e as Ne,g as Zr,w as re,i as ue,h as No,t as Tt,l as qe,a2 as Hw,a7 as Ks,x as SA,r as lt,c as Qn,y as RA,n as XP,s as ZP,o as QP,z as JP,d as te,k as Ai,m as vl,q as YR,F as eh,j as GR}from"./index-BV9e5Yt5.js";import{P as EA}from"./PaginaTituloIcono-CW0YRi1P.js";import{_ as _A}from"./ProyectoHeader-D5OgEq0F.js";import{r as eI,a as Nu,b as Mb,c as tI,d as pm,e as wm,f as Bs,g as al,h as nI,i as Pb,j as iI,k as TA,l as MA,m as vm,n as Du,o as yt,p as ll,q as Cm,s as rI,t as Ib,u as ym,v as ku,w as Ri,x as PA,y as to,z as ji,A as xb,B as Ui,C as IA,D as xA,E as OA,F as Ob,G as oI,H as HA,I as AA,J as NA,K as sI,L as DA,M as aI,N as kA,O as LA,P as lI,Q as $A,R as FA,S as VA,T as WA,U as BA,V as bm,W as uI,X as jA,Y as UA,Z as zA,_ as YA,$ as GA}from"./get-substitution-CQFt05Pl.js";import KA from"./purify.es-CQJ0hv7W.js";import{S as qA}from"./selectOptions-B5pGCBUk.js";import{u as XA}from"./useProcedenciaFondos-DCzG2v-v.js";import{u as qs,a as KR}from"./xlsx-CM-TUkP_.js";import"./proyectoService-wNf4fISD.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";var qR={},Aw,XR;function ZA(){if(XR)return Aw;XR=1;var t=eI().f;return Aw=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},Aw}var Nw,ZR;function QA(){if(ZR)return Nw;ZR=1;var t=Nu(),e=Mb(),n=tI();return Nw=function(i,r,o){var s,a;return n&&t(s=r.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(i,a),i},Nw}var Dw,QR;function JA(){if(QR)return Dw;QR=1;var t=pm();return Dw=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},Dw}var kw,JR;function eN(){if(JR)return kw;JR=1;var t=Mb(),e=wm();return kw=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},kw}var Lw,e0;function tN(){if(e0)return Lw;e0=1;var t=Bs(),e=Error,n=t("".replace),i=function(s){return String(new e(s).stack)}("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,o=r.test(i);return Lw=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,r,"");return s},Lw}var $w,t0;function nN(){if(t0)return $w;t0=1;var t=al(),e=nI();return $w=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),$w}var Fw,n0;function iN(){if(n0)return Fw;n0=1;var t=wm(),e=tN(),n=nN(),i=Error.captureStackTrace;return Fw=function(r,o,s,a){n&&(i?i(r,o):t(r,"stack",e(s,a)))},Fw}var Vw,i0;function rN(){if(i0)return Vw;i0=1;var t=Pb(),e=iI(),n=wm(),i=TA(),r=tI(),o=MA(),s=ZA(),a=QA(),l=JA(),u=eN(),c=iN(),h=vm(),d=Du();return Vw=function(f,m,y,C){var E="stackTraceLimit",b=C?2:1,$=f.split("."),W=$[$.length-1],F=t.apply(null,$);if(F){var x=F.prototype;if(!d&&e(x,"cause")&&delete x.cause,!y)return F;var A=t("Error"),Z=m(function(K,z){var le=l(C?z:K,void 0),ne=C?new F(K):new F;return le!==void 0&&n(ne,"message",le),c(ne,Z,ne.stack,2),this&&i(x,this)&&a(ne,this,Z),arguments.length>b&&u(ne,arguments[b]),ne});if(Z.prototype=x,W!=="Error"?r?r(Z,A):o(Z,A,{name:!0}):h&&E in F&&(s(Z,F,E),s(Z,F,"prepareStackTrace")),o(Z,F),!d)try{x.name!==W&&n(x,"name",W),x.constructor=Z}catch{}return Z}},Vw}var r0;function oN(){if(r0)return qR;r0=1;var t=yt(),e=ll(),n=Cm(),i=rN(),r="WebAssembly",o=e[r],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=i(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=i(r+"."+u,c,s),t({target:r,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),qR}oN();var o0={},Ww,s0;function cI(){if(s0)return Ww;s0=1;var t=vm(),e=rI(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Ww=r?function(o,s){if(e(o)&&!i(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Ww}var Bw,a0;function hI(){if(a0)return Bw;a0=1;var t=TypeError,e=9007199254740991;return Bw=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},Bw}var l0;function sN(){if(l0)return o0;l0=1;var t=yt(),e=Ib(),n=ym(),i=cI(),r=hI(),o=al(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;r(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return i(h,d),d}}),o0}sN();var u0={},jw,c0;function dI(){if(c0)return jw;c0=1;var t=vm(),e=eI(),n=nI();return jw=function(i,r,o){t?e.f(i,r,n(0,o)):i[r]=o},jw}var h0;function aN(){if(h0)return u0;h0=1;var t=yt(),e=ku(),n=dI();return t({target:"Object",stat:!0},{fromEntries:function(r){var o={};return e(r,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),u0}aN();var d0={},Uw,f0;function no(){if(f0)return Uw;f0=1;var t=Bs(),e=Set.prototype;return Uw={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Uw}var zw,g0;function ul(){if(g0)return zw;g0=1;var t=no().has;return zw=function(e){return t(e),e},zw}var Yw,m0;function cl(){if(m0)return Yw;m0=1;var t=Ri();return Yw=function(e,n,i){for(var r=i?e:e.iterator,o=e.next,s,a;!(s=t(o,r)).done;)if(a=n(s.value),a!==void 0)return a},Yw}var Gw,p0;function Gh(){if(p0)return Gw;p0=1;var t=Bs(),e=cl(),n=no(),i=n.Set,r=n.proto,o=t(r.forEach),s=t(r.keys),a=s(new i).next;return Gw=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Gw}var Kw,w0;function Hb(){if(w0)return Kw;w0=1;var t=no(),e=Gh(),n=t.Set,i=t.add;return Kw=function(r){var o=new n;return e(r,function(s){i(o,s)}),o},Kw}var qw,v0;function Kh(){if(v0)return qw;v0=1;var t=PA(),e=no();return qw=t(e.proto,"size","get")||function(n){return n.size},qw}var Xw,C0;function io(){return C0||(C0=1,Xw=function(t){return{iterator:t,next:t.next,done:!1}}),Xw}var Zw,y0;function hl(){if(y0)return Zw;y0=1;var t=to(),e=ji(),n=Ri(),i=xb(),r=io(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},Zw=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=i(h);if(d<0)throw new s(o);return new u(c,d)},Zw}var Qw,b0;function lN(){if(b0)return Qw;b0=1;var t=ul(),e=no(),n=Hb(),i=Kh(),r=hl(),o=Gh(),s=cl(),a=e.has,l=e.remove;return Qw=function(c){var h=t(this),d=r(c),f=n(h);return i(h)<=d.size?o(h,function(m){d.includes(m)&&l(f,m)}):s(d.getIterator(),function(m){a(h,m)&&l(f,m)}),f},Qw}var Jw,S0;function dl(){if(S0)return Jw;S0=1;var t=Pb(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return Jw=function(i,r){var o=t("Set");try{new o()[i](e(0));try{return new o()[i](e(-1)),!1}catch{if(!r)return!0;try{return new o()[i](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),r(s[i](n(1/0)))}}}catch{return!1}},Jw}var R0;function uN(){if(R0)return d0;R0=1;var t=yt(),e=lN(),n=dl(),i=!n("difference",function(r){return r.size===0});return t({target:"Set",proto:!0,real:!0,forced:i},{difference:e}),d0}uN();var E0={},ev,_0;function cN(){if(_0)return ev;_0=1;var t=ul(),e=no(),n=Kh(),i=hl(),r=Gh(),o=cl(),s=e.Set,a=e.add,l=e.has;return ev=function(c){var h=t(this),d=i(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(m){l(h,m)&&a(f,m)}):r(h,function(m){d.includes(m)&&a(f,m)}),f},ev}var T0;function hN(){if(T0)return E0;T0=1;var t=yt(),e=al(),n=cN(),i=dl(),r=!i("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),E0}hN();var M0={},tv,P0;function dN(){if(P0)return tv;P0=1;var t=ul(),e=no().has,n=Kh(),i=hl(),r=Gh(),o=cl(),s=Ui();return tv=function(l){var u=t(this),c=i(l);if(n(u)<=c.size)return r(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},tv}var I0;function fN(){if(I0)return M0;I0=1;var t=yt(),e=dN(),n=dl(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),M0}fN();var x0={},nv,O0;function gN(){if(O0)return nv;O0=1;var t=ul(),e=Kh(),n=Gh(),i=hl();return nv=function(o){var s=t(this),a=i(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},nv}var H0;function mN(){if(H0)return x0;H0=1;var t=yt(),e=gN(),n=dl(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),x0}mN();var A0={},iv,N0;function pN(){if(N0)return iv;N0=1;var t=ul(),e=no().has,n=Kh(),i=hl(),r=cl(),o=Ui();return iv=function(a){var l=t(this),u=i(a);if(n(l)<u.size)return!1;var c=u.getIterator();return r(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},iv}var D0;function wN(){if(D0)return A0;D0=1;var t=yt(),e=pN(),n=dl(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),A0}wN();var k0={},rv,L0;function vN(){if(L0)return rv;L0=1;var t=ul(),e=no(),n=Hb(),i=hl(),r=cl(),o=e.add,s=e.has,a=e.remove;return rv=function(u){var c=t(this),h=i(u).getIterator(),d=n(c);return r(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},rv}var $0;function CN(){if($0)return k0;$0=1;var t=yt(),e=vN(),n=dl();return t({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:e}),k0}CN();var F0={},ov,V0;function yN(){if(V0)return ov;V0=1;var t=ul(),e=no().add,n=Hb(),i=hl(),r=cl();return ov=function(s){var a=t(this),l=i(s).getIterator(),u=n(a);return r(l,function(c){e(u,c)}),u},ov}var W0;function bN(){if(W0)return F0;W0=1;var t=yt(),e=yN(),n=dl();return t({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:e}),F0}bN();var B0={},j0={},U0;function SN(){if(U0)return j0;U0=1;var t=yt(),e=ll(),n=IA(),i=ji(),r=Nu(),o=xA(),s=OA(),a=dI(),l=al(),u=iI(),c=Ob(),h=oI().IteratorPrototype,d=vm(),f=Du(),m="constructor",y="Iterator",C=c("toStringTag"),E=TypeError,b=e[y],$=f||!r(b)||b.prototype!==h||!l(function(){b({})}),W=function(){if(n(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},F=function(x,A){d?s(h,x,{configurable:!0,get:function(){return A},set:function(Z){if(i(this),this===h)throw new E("You can't redefine this property");u(this,x)?this[x]=Z:a(this,x,Z)}}):h[x]=A};return u(h,C)||F(C,y),($||!u(h,m)||h[m]===Object)&&F(m,W),W.prototype=h,t({global:!0,constructor:!0,forced:$},{Iterator:W}),j0}var z0;function RN(){return z0||(z0=1,SN()),B0}RN();var Y0={},G0={},sv,K0;function EN(){if(K0)return sv;K0=1;var t=HA();return sv=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},sv}var av,q0;function Ab(){if(q0)return av;q0=1;var t=Ri(),e=AA(),n=wm(),i=EN(),r=Ob(),o=NA(),s=sI(),a=oI().IteratorPrototype,l=DA(),u=Ui(),c=r("toStringTag"),h="IteratorHelper",d="WrapForValidIterator",f=o.set,m=function(E){var b=o.getterFor(E?d:h);return i(e(a),{next:function(){var W=b(this);if(E)return W.nextHandler();if(W.done)return l(void 0,!0);try{var F=W.nextHandler();return W.returnHandlerResult?F:l(F,W.done)}catch(x){throw W.done=!0,x}},return:function(){var $=b(this),W=$.iterator;if($.done=!0,E){var F=s(W,"return");return F?t(F,W):l(void 0,!0)}if($.inner)try{u($.inner.iterator,"normal")}catch(x){return u(W,"throw",x)}return W&&u(W,"normal"),l(void 0,!0)}})},y=m(!0),C=m(!1);return n(C,c,"Iterator Helper"),av=function(E,b,$){var W=function(x,A){A?(A.iterator=x.iterator,A.next=x.next):A=x,A.type=b?d:h,A.returnHandlerResult=!!$,A.nextHandler=E,A.counter=0,A.done=!1,f(this,A)};return W.prototype=b?y:C,W},av}var lv,X0;function fI(){if(X0)return lv;X0=1;var t=ji(),e=Ui();return lv=function(n,i,r,o){try{return o?i(t(r)[0],r[1]):i(r)}catch(s){e(n,"throw",s)}},lv}var uv,Z0;function js(){if(Z0)return uv;Z0=1;var t=ll();return uv=function(e,n){var i=t.Iterator,r=i&&i.prototype,o=r&&r[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},uv}var Q0;function _N(){if(Q0)return G0;Q0=1;var t=yt(),e=Ri(),n=to(),i=ji(),r=io(),o=Ab(),s=fI(),a=Du(),l=Ui(),u=js(),c=!a&&u("filter",TypeError),h=o(function(){for(var d=this.iterator,f=this.predicate,m=this.next,y,C,E;;){if(y=i(e(m,d)),C=this.done=!!y.done,C)return;if(E=y.value,s(d,f,[E,this.counter++],!0))return E}});return t({target:"Iterator",proto:!0,real:!0,forced:a||c},{filter:function(f){i(this);try{n(f)}catch(m){l(this,"throw",m)}return c?e(c,this,f):new h(r(this),{predicate:f})}}),G0}var J0;function TN(){return J0||(J0=1,_N()),Y0}TN();var eE={},tE={},nE;function MN(){if(nE)return tE;nE=1;var t=yt(),e=Ri(),n=ku(),i=to(),r=ji(),o=io(),s=Ui(),a=js(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){r(this);try{i(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),tE}var iE;function PN(){return iE||(iE=1,MN()),eE}PN();var rE={},oE={},sE;function IN(){if(sE)return oE;sE=1;var t=yt(),e=Ri(),n=to(),i=ji(),r=io(),o=Ab(),s=fI(),a=Ui(),l=js(),u=Du(),c=!u&&l("map",TypeError),h=o(function(){var d=this.iterator,f=i(e(this.next,d)),m=this.done=!!f.done;if(!m)return s(d,this.mapper,[f.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:u||c},{map:function(f){i(this);try{n(f)}catch(m){a(this,"throw",m)}return c?e(c,this,f):new h(r(this),{mapper:f})}}),oE}var aE;function xN(){return aE||(aE=1,IN()),rE}xN();var lE={},uE={},cE;function ON(){if(cE)return uE;cE=1;var t=yt(),e=ll(),n=aI().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),uE}var hE={},cv,dE;function HN(){if(dE)return cv;dE=1;var t=ll(),e=Cm(),n=Nu(),i=kA(),r=LA(),o=lI(),s=$A(),a=t.Function,l=/MSIE .\./.test(r)||i==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return cv=function(u,c){var h=c?2:1;return l?function(d,f){var m=s(arguments.length,1)>h,y=n(d)?d:a(d),C=m?o(arguments,h):[],E=m?function(){e(y,this,C)}:y;return c?u(E,f):u(E)}:u},cv}var fE;function AN(){if(fE)return hE;fE=1;var t=yt(),e=ll(),n=aI().set,i=HN(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),hE}var gE;function NN(){return gE||(gE=1,ON(),AN()),lE}NN();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var gI;function Q(){return gI.apply(null,arguments)}function DN(t){gI=t}function gr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ka(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Nb(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(rt(t,e))return!1;return!0}function Jn(t){return t===void 0}function Yo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function qh(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function mI(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Is(t,e){for(var n in e)rt(e,n)&&(t[n]=e[n]);return rt(e,"toString")&&(t.toString=e.toString),rt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function ro(t,e,n,i){return $I(t,e,n,i,!0).utc()}function kN(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Le(t){return t._pf==null&&(t._pf=kN()),t._pf}var Oy;Array.prototype.some?Oy=Array.prototype.some:Oy=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function Db(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Le(t),n=Oy.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Sm(t){var e=ro(NaN);return t!=null?Is(Le(e),t):Le(e).userInvalidated=!0,e}var mE=Q.momentProperties=[],hv=!1;function kb(t,e){var n,i,r,o=mE.length;if(Jn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jn(e._i)||(t._i=e._i),Jn(e._f)||(t._f=e._f),Jn(e._l)||(t._l=e._l),Jn(e._strict)||(t._strict=e._strict),Jn(e._tzm)||(t._tzm=e._tzm),Jn(e._isUTC)||(t._isUTC=e._isUTC),Jn(e._offset)||(t._offset=e._offset),Jn(e._pf)||(t._pf=Le(e)),Jn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=mE[n],r=e[i],Jn(r)||(t[i]=r);return t}function Xh(t){kb(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),hv===!1&&(hv=!0,Q.updateOffset(this),hv=!1)}function mr(t){return t instanceof Xh||t!=null&&t._isAMomentObject!=null}function pI(t){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function zi(t,e){var n=!0;return Is(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,t),n){var i=[],r,o,s,a=arguments.length;for(o=0;o<a;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(s in arguments[0])rt(arguments[0],s)&&(r+=s+": "+arguments[0][s]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}pI(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var pE={};function wI(t,e){Q.deprecationHandler!=null&&Q.deprecationHandler(t,e),pE[t]||(pI(e),pE[t]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function oo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function LN(t){var e,n;for(n in t)rt(t,n)&&(e=t[n],oo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Hy(t,e){var n=Is({},t),i;for(i in e)rt(e,i)&&(Ka(t[i])&&Ka(e[i])?(n[i]={},Is(n[i],t[i]),Is(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)rt(t,i)&&!rt(e,i)&&Ka(t[i])&&(n[i]=Is({},n[i]));return n}function Lb(t){t!=null&&this.set(t)}var Ay;Object.keys?Ay=Object.keys:Ay=function(t){var e,n=[];for(e in t)rt(t,e)&&n.push(e);return n};var $N={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function FN(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return oo(i)?i.call(e,n):i}function Jr(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var $b=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,wd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,dv={},vu={};function Re(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(vu[t]=r),e&&(vu[e[0]]=function(){return Jr(r.apply(this,arguments),e[1],e[2])}),n&&(vu[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function VN(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function WN(t){var e=t.match($b),n,i;for(n=0,i=e.length;n<i;n++)vu[e[n]]?e[n]=vu[e[n]]:e[n]=VN(e[n]);return function(r){var o="",s;for(s=0;s<i;s++)o+=oo(e[s])?e[s].call(r,t):e[s];return o}}function Jf(t,e){return t.isValid()?(e=vI(e,t.localeData()),dv[e]=dv[e]||WN(e),dv[e](t)):t.localeData().invalidDate()}function vI(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(wd.lastIndex=0;n>=0&&wd.test(t);)t=t.replace(wd,i),wd.lastIndex=0,n-=1;return t}var BN={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function jN(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match($b).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var UN="Invalid date";function zN(){return this._invalidDate}var YN="%d",GN=/\d{1,2}/;function KN(t){return this._ordinal.replace("%d",t)}var qN={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function XN(t,e,n,i){var r=this._relativeTime[n];return oo(r)?r(t,e,n,i):r.replace(/%d/i,t)}function ZN(t,e){var n=this._relativeTime[t>0?"future":"past"];return oo(n)?n(e):n.replace(/%s/i,e)}var wE={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Yi(t){return typeof t=="string"?wE[t]||wE[t.toLowerCase()]:void 0}function Fb(t){var e={},n,i;for(i in t)rt(t,i)&&(n=Yi(i),n&&(e[n]=t[i]));return e}var QN={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function JN(t){var e=[],n;for(n in t)rt(t,n)&&e.push({unit:n,priority:QN[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var CI=/\d/,Ei=/\d\d/,yI=/\d{3}/,Vb=/\d{4}/,Rm=/[+-]?\d{6}/,It=/\d\d?/,bI=/\d\d\d\d?/,SI=/\d\d\d\d\d\d?/,Em=/\d{1,3}/,Wb=/\d{1,4}/,_m=/[+-]?\d{1,6}/,Lu=/\d+/,Tm=/[+-]?\d+/,eD=/Z|[+-]\d\d:?\d\d/gi,Mm=/Z|[+-]\d\d(?::?\d\d)?/gi,tD=/[+-]?\d+(\.\d{1,3})?/,Zh=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,$u=/^[1-9]\d?/,Bb=/^([1-9]\d|\d)/,Sg;Sg={};function fe(t,e,n){Sg[t]=oo(e)?e:function(i,r){return i&&n?n:e}}function nD(t,e){return rt(Sg,t)?Sg[t](e._strict,e._locale):new RegExp(iD(t))}function iD(t){return jo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function jo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Fi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ke(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Fi(e)),n}var Ny={};function vt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),Yo(e)&&(i=function(o,s){s[e]=Ke(o)}),r=t.length,n=0;n<r;n++)Ny[t[n]]=i}function Qh(t,e){vt(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function rD(t,e,n){e!=null&&rt(Ny,t)&&Ny[t](e,n._a,n,t)}function Pm(t){return t%4===0&&t%100!==0||t%400===0}var On=0,Do=1,Gr=2,fn=3,hr=4,ko=5,Ba=6,oD=7,sD=8;Re("Y",0,0,function(){var t=this.year();return t<=9999?Jr(t,4):"+"+t});Re(0,["YY",2],0,function(){return this.year()%100});Re(0,["YYYY",4],0,"year");Re(0,["YYYYY",5],0,"year");Re(0,["YYYYYY",6,!0],0,"year");fe("Y",Tm);fe("YY",It,Ei);fe("YYYY",Wb,Vb);fe("YYYYY",_m,Rm);fe("YYYYYY",_m,Rm);vt(["YYYYY","YYYYYY"],On);vt("YYYY",function(t,e){e[On]=t.length===2?Q.parseTwoDigitYear(t):Ke(t)});vt("YY",function(t,e){e[On]=Q.parseTwoDigitYear(t)});vt("Y",function(t,e){e[On]=parseInt(t,10)});function th(t){return Pm(t)?366:365}Q.parseTwoDigitYear=function(t){return Ke(t)+(Ke(t)>68?1900:2e3)};var RI=Fu("FullYear",!0);function aD(){return Pm(this.year())}function Fu(t,e){return function(n){return n!=null?(EI(this,t,n),Q.updateOffset(this,e),this):_h(this,t)}}function _h(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function EI(t,e,n){var i,r,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Pm(o)?28:a,r?i.setUTCFullYear(o,s,a):i.setFullYear(o,s,a)}}function lD(t){return t=Yi(t),oo(this[t])?this[t]():this}function uD(t,e){if(typeof t=="object"){t=Fb(t);var n=JN(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Yi(t),oo(this[t]))return this[t](e);return this}function cD(t,e){return(t%e+e)%e}var Qt;Array.prototype.indexOf?Qt=Array.prototype.indexOf:Qt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function jb(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=cD(e,12);return t+=(e-n)/12,n===1?Pm(t)?29:28:31-n%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1});Re("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Re("MMMM",0,0,function(t){return this.localeData().months(this,t)});fe("M",It,$u);fe("MM",It,Ei);fe("MMM",function(t,e){return e.monthsShortRegex(t)});fe("MMMM",function(t,e){return e.monthsRegex(t)});vt(["M","MM"],function(t,e){e[Do]=Ke(t)-1});vt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Do]=r:Le(n).invalidMonth=t});var hD="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),_I="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),TI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,dD=Zh,fD=Zh;function gD(t,e){return t?gr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||TI).test(e)?"format":"standalone"][t.month()]:gr(this._months)?this._months:this._months.standalone}function mD(t,e){return t?gr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[TI.test(e)?"format":"standalone"][t.month()]:gr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function pD(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=ro([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=Qt.call(this._shortMonthsParse,s),r!==-1?r:null):(r=Qt.call(this._longMonthsParse,s),r!==-1?r:null):e==="MMM"?(r=Qt.call(this._shortMonthsParse,s),r!==-1?r:(r=Qt.call(this._longMonthsParse,s),r!==-1?r:null)):(r=Qt.call(this._longMonthsParse,s),r!==-1?r:(r=Qt.call(this._shortMonthsParse,s),r!==-1?r:null))}function wD(t,e,n){var i,r,o;if(this._monthsParseExact)return pD.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=ro([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function MI(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ke(e);else if(e=t.localeData().monthsParse(e),!Yo(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,jb(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function PI(t){return t!=null?(MI(this,t),Q.updateOffset(this,!0),this):_h(this,"Month")}function vD(){return jb(this.year(),this.month())}function CD(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||II.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(rt(this,"_monthsShortRegex")||(this._monthsShortRegex=dD),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function yD(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||II.call(this),t?this._monthsStrictRegex:this._monthsRegex):(rt(this,"_monthsRegex")||(this._monthsRegex=fD),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function II(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,o,s,a;for(r=0;r<12;r++)o=ro([2e3,r]),s=jo(this.monthsShort(o,"")),a=jo(this.months(o,"")),e.push(s),n.push(a),i.push(a),i.push(s);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function bD(t,e,n,i,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,o,s),a}function Th(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Rg(t,e,n){var i=7+e-n,r=(7+Th(t,0,i).getUTCDay()-e)%7;return-r+i-1}function xI(t,e,n,i,r){var o=(7+n-i)%7,s=Rg(t,i,r),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=th(l)+a):a>th(t)?(l=t+1,u=a-th(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Mh(t,e,n){var i=Rg(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,s;return r<1?(s=t.year()-1,o=r+Uo(s,e,n)):r>Uo(t.year(),e,n)?(o=r-Uo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function Uo(t,e,n){var i=Rg(t,e,n),r=Rg(t+1,e,n);return(th(t)-i+r)/7}Re("w",["ww",2],"wo","week");Re("W",["WW",2],"Wo","isoWeek");fe("w",It,$u);fe("ww",It,Ei);fe("W",It,$u);fe("WW",It,Ei);Qh(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Ke(t)});function SD(t){return Mh(t,this._week.dow,this._week.doy).week}var RD={dow:0,doy:6};function ED(){return this._week.dow}function _D(){return this._week.doy}function TD(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function MD(t){var e=Mh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Re("d",0,"do","day");Re("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Re("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Re("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Re("e",0,0,"weekday");Re("E",0,0,"isoWeekday");fe("d",It);fe("e",It);fe("E",It);fe("dd",function(t,e){return e.weekdaysMinRegex(t)});fe("ddd",function(t,e){return e.weekdaysShortRegex(t)});fe("dddd",function(t,e){return e.weekdaysRegex(t)});Qh(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:Le(n).invalidWeekday=t});Qh(["d","e","E"],function(t,e,n,i){e[i]=Ke(t)});function PD(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function ID(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Ub(t,e){return t.slice(e,7).concat(t.slice(0,e))}var xD="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),OI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),OD="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),HD=Zh,AD=Zh,ND=Zh;function DD(t,e){var n=gr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Ub(n,this._week.dow):t?n[t.day()]:n}function kD(t){return t===!0?Ub(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function LD(t){return t===!0?Ub(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function $D(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=ro([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=Qt.call(this._weekdaysParse,s),r!==-1?r:null):e==="ddd"?(r=Qt.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=Qt.call(this._minWeekdaysParse,s),r!==-1?r:null):e==="dddd"?(r=Qt.call(this._weekdaysParse,s),r!==-1||(r=Qt.call(this._shortWeekdaysParse,s),r!==-1)?r:(r=Qt.call(this._minWeekdaysParse,s),r!==-1?r:null)):e==="ddd"?(r=Qt.call(this._shortWeekdaysParse,s),r!==-1||(r=Qt.call(this._weekdaysParse,s),r!==-1)?r:(r=Qt.call(this._minWeekdaysParse,s),r!==-1?r:null)):(r=Qt.call(this._minWeekdaysParse,s),r!==-1||(r=Qt.call(this._weekdaysParse,s),r!==-1)?r:(r=Qt.call(this._shortWeekdaysParse,s),r!==-1?r:null))}function FD(t,e,n){var i,r,o;if(this._weekdaysParseExact)return $D.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=ro([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function VD(t){if(!this.isValid())return t!=null?this:NaN;var e=_h(this,"Day");return t!=null?(t=PD(t,this.localeData()),this.add(t-e,"d")):e}function WD(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function BD(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=ID(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function jD(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||zb.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(rt(this,"_weekdaysRegex")||(this._weekdaysRegex=HD),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function UD(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||zb.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=AD),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function zD(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||zb.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ND),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function zb(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],o,s,a,l,u;for(o=0;o<7;o++)s=ro([2e3,1]).day(o),a=jo(this.weekdaysMin(s,"")),l=jo(this.weekdaysShort(s,"")),u=jo(this.weekdays(s,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Yb(){return this.hours()%12||12}function YD(){return this.hours()||24}Re("H",["HH",2],0,"hour");Re("h",["hh",2],0,Yb);Re("k",["kk",2],0,YD);Re("hmm",0,0,function(){return""+Yb.apply(this)+Jr(this.minutes(),2)});Re("hmmss",0,0,function(){return""+Yb.apply(this)+Jr(this.minutes(),2)+Jr(this.seconds(),2)});Re("Hmm",0,0,function(){return""+this.hours()+Jr(this.minutes(),2)});Re("Hmmss",0,0,function(){return""+this.hours()+Jr(this.minutes(),2)+Jr(this.seconds(),2)});function HI(t,e){Re(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}HI("a",!0);HI("A",!1);function AI(t,e){return e._meridiemParse}fe("a",AI);fe("A",AI);fe("H",It,Bb);fe("h",It,$u);fe("k",It,$u);fe("HH",It,Ei);fe("hh",It,Ei);fe("kk",It,Ei);fe("hmm",bI);fe("hmmss",SI);fe("Hmm",bI);fe("Hmmss",SI);vt(["H","HH"],fn);vt(["k","kk"],function(t,e,n){var i=Ke(t);e[fn]=i===24?0:i});vt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});vt(["h","hh"],function(t,e,n){e[fn]=Ke(t),Le(n).bigHour=!0});vt("hmm",function(t,e,n){var i=t.length-2;e[fn]=Ke(t.substr(0,i)),e[hr]=Ke(t.substr(i)),Le(n).bigHour=!0});vt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[fn]=Ke(t.substr(0,i)),e[hr]=Ke(t.substr(i,2)),e[ko]=Ke(t.substr(r)),Le(n).bigHour=!0});vt("Hmm",function(t,e,n){var i=t.length-2;e[fn]=Ke(t.substr(0,i)),e[hr]=Ke(t.substr(i))});vt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[fn]=Ke(t.substr(0,i)),e[hr]=Ke(t.substr(i,2)),e[ko]=Ke(t.substr(r))});function GD(t){return(t+"").toLowerCase().charAt(0)==="p"}var KD=/[ap]\.?m?\.?/i,qD=Fu("Hours",!0);function XD(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var NI={calendar:$N,longDateFormat:BN,invalidDate:UN,ordinal:YN,dayOfMonthOrdinalParse:GN,relativeTime:qN,months:hD,monthsShort:_I,week:RD,weekdays:xD,weekdaysMin:OD,weekdaysShort:OI,meridiemParse:KD},Ot={},qu={},Ph;function ZD(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function vE(t){return t&&t.toLowerCase().replace("_","-")}function QD(t){for(var e=0,n,i,r,o;e<t.length;){for(o=vE(t[e]).split("-"),n=o.length,i=vE(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Im(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&ZD(o,i)>=n-1)break;n--}e++}return Ph}function JD(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Im(t){var e=null,n;if(Ot[t]===void 0&&typeof module<"u"&&module&&module.exports&&JD(t))try{e=Ph._abbr,n=require,n("./locale/"+t),ks(e)}catch{Ot[t]=null}return Ot[t]}function ks(t,e){var n;return t&&(Jn(e)?n=Zo(t):n=Gb(t,e),n?Ph=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ph._abbr}function Gb(t,e){if(e!==null){var n,i=NI;if(e.abbr=t,Ot[t]!=null)wI("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ot[t]._config;else if(e.parentLocale!=null)if(Ot[e.parentLocale]!=null)i=Ot[e.parentLocale]._config;else if(n=Im(e.parentLocale),n!=null)i=n._config;else return qu[e.parentLocale]||(qu[e.parentLocale]=[]),qu[e.parentLocale].push({name:t,config:e}),null;return Ot[t]=new Lb(Hy(i,e)),qu[t]&&qu[t].forEach(function(r){Gb(r.name,r.config)}),ks(t),Ot[t]}else return delete Ot[t],null}function ek(t,e){if(e!=null){var n,i,r=NI;Ot[t]!=null&&Ot[t].parentLocale!=null?Ot[t].set(Hy(Ot[t]._config,e)):(i=Im(t),i!=null&&(r=i._config),e=Hy(r,e),i==null&&(e.abbr=t),n=new Lb(e),n.parentLocale=Ot[t],Ot[t]=n),ks(t)}else Ot[t]!=null&&(Ot[t].parentLocale!=null?(Ot[t]=Ot[t].parentLocale,t===ks()&&ks(t)):Ot[t]!=null&&delete Ot[t]);return Ot[t]}function Zo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ph;if(!gr(t)){if(e=Im(t),e)return e;t=[t]}return QD(t)}function tk(){return Ay(Ot)}function Kb(t){var e,n=t._a;return n&&Le(t).overflow===-2&&(e=n[Do]<0||n[Do]>11?Do:n[Gr]<1||n[Gr]>jb(n[On],n[Do])?Gr:n[fn]<0||n[fn]>24||n[fn]===24&&(n[hr]!==0||n[ko]!==0||n[Ba]!==0)?fn:n[hr]<0||n[hr]>59?hr:n[ko]<0||n[ko]>59?ko:n[Ba]<0||n[Ba]>999?Ba:-1,Le(t)._overflowDayOfYear&&(e<On||e>Gr)&&(e=Gr),Le(t)._overflowWeeks&&e===-1&&(e=oD),Le(t)._overflowWeekday&&e===-1&&(e=sD),Le(t).overflow=e),t}var nk=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ik=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rk=/Z|[+-]\d\d(?::?\d\d)?/,vd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fv=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ok=/^\/?Date\((-?\d+)/i,sk=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,ak={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function DI(t){var e,n,i=t._i,r=nk.exec(i)||ik.exec(i),o,s,a,l,u=vd.length,c=fv.length;if(r){for(Le(t).iso=!0,e=0,n=u;e<n;e++)if(vd[e][1].exec(r[1])){s=vd[e][0],o=vd[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(fv[e][1].exec(r[3])){a=(r[2]||" ")+fv[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(r[4])if(rk.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Xb(t)}else t._isValid=!1}function lk(t,e,n,i,r,o){var s=[uk(t),_I.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&s.push(parseInt(o,10)),s}function uk(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function ck(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function hk(t,e,n){if(t){var i=OI.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return Le(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function dk(t,e,n){if(t)return ak[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function kI(t){var e=sk.exec(ck(t._i)),n;if(e){if(n=lk(e[4],e[3],e[2],e[5],e[6],e[7]),!hk(e[1],n,t))return;t._a=n,t._tzm=dk(e[8],e[9],e[10]),t._d=Th.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Le(t).rfc2822=!0}else t._isValid=!1}function fk(t){var e=ok.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(DI(t),t._isValid===!1)delete t._isValid;else return;if(kI(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Q.createFromInputFallback(t)}Q.createFromInputFallback=zi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function iu(t,e,n){return t??e??n}function gk(t){var e=new Date(Q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function qb(t){var e,n,i=[],r,o,s;if(!t._d){for(r=gk(t),t._w&&t._a[Gr]==null&&t._a[Do]==null&&mk(t),t._dayOfYear!=null&&(s=iu(t._a[On],r[On]),(t._dayOfYear>th(s)||t._dayOfYear===0)&&(Le(t)._overflowDayOfYear=!0),n=Th(s,0,t._dayOfYear),t._a[Do]=n.getUTCMonth(),t._a[Gr]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[fn]===24&&t._a[hr]===0&&t._a[ko]===0&&t._a[Ba]===0&&(t._nextDay=!0,t._a[fn]=0),t._d=(t._useUTC?Th:bD).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[fn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Le(t).weekdayMismatch=!0)}}function mk(t){var e,n,i,r,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=iu(e.GG,t._a[On],Mh(Pt(),1,4).year),i=iu(e.W,1),r=iu(e.E,1),(r<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Mh(Pt(),o,s),n=iu(e.gg,t._a[On],u.year),i=iu(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o),i<1||i>Uo(n,o,s)?Le(t)._overflowWeeks=!0:l!=null?Le(t)._overflowWeekday=!0:(a=xI(n,i,r,o,s),t._a[On]=a.year,t._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function Xb(t){if(t._f===Q.ISO_8601){DI(t);return}if(t._f===Q.RFC_2822){kI(t);return}t._a=[],Le(t).empty=!0;var e=""+t._i,n,i,r,o,s,a=e.length,l=0,u,c;for(r=vI(t._f,t._locale).match($b)||[],c=r.length,n=0;n<c;n++)o=r[n],i=(e.match(nD(o,t))||[])[0],i&&(s=e.substr(0,e.indexOf(i)),s.length>0&&Le(t).unusedInput.push(s),e=e.slice(e.indexOf(i)+i.length),l+=i.length),vu[o]?(i?Le(t).empty=!1:Le(t).unusedTokens.push(o),rD(o,i,t)):t._strict&&!i&&Le(t).unusedTokens.push(o);Le(t).charsLeftOver=a-l,e.length>0&&Le(t).unusedInput.push(e),t._a[fn]<=12&&Le(t).bigHour===!0&&t._a[fn]>0&&(Le(t).bigHour=void 0),Le(t).parsedDateParts=t._a.slice(0),Le(t).meridiem=t._meridiem,t._a[fn]=pk(t._locale,t._a[fn],t._meridiem),u=Le(t).era,u!==null&&(t._a[On]=t._locale.erasConvertYear(u,t._a[On])),qb(t),Kb(t)}function pk(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function wk(t){var e,n,i,r,o,s,a=!1,l=t._f.length;if(l===0){Le(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)o=0,s=!1,e=kb({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],Xb(e),Db(e)&&(s=!0),o+=Le(e).charsLeftOver,o+=Le(e).unusedTokens.length*10,Le(e).score=o,a?o<i&&(i=o,n=e):(i==null||o<i||s)&&(i=o,n=e,s&&(a=!0));Is(t,n||e)}function vk(t){if(!t._d){var e=Fb(t._i),n=e.day===void 0?e.date:e.day;t._a=mI([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),qb(t)}}function Ck(t){var e=new Xh(Kb(LI(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function LI(t){var e=t._i,n=t._f;return t._locale=t._locale||Zo(t._l),e===null||n===void 0&&e===""?Sm({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),mr(e)?new Xh(Kb(e)):(qh(e)?t._d=e:gr(n)?wk(t):n?Xb(t):yk(t),Db(t)||(t._d=null),t))}function yk(t){var e=t._i;Jn(e)?t._d=new Date(Q.now()):qh(e)?t._d=new Date(e.valueOf()):typeof e=="string"?fk(t):gr(e)?(t._a=mI(e.slice(0),function(n){return parseInt(n,10)}),qb(t)):Ka(e)?vk(t):Yo(e)?t._d=new Date(e):Q.createFromInputFallback(t)}function $I(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Ka(t)&&Nb(t)||gr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,Ck(o)}function Pt(t,e,n,i){return $I(t,e,n,i,!1)}var bk=zi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Sm()}),Sk=zi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Pt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Sm()});function FI(t,e){var n,i;if(e.length===1&&gr(e[0])&&(e=e[0]),!e.length)return Pt();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function Rk(){var t=[].slice.call(arguments,0);return FI("isBefore",t)}function Ek(){var t=[].slice.call(arguments,0);return FI("isAfter",t)}var _k=function(){return Date.now?Date.now():+new Date},Xu=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Tk(t){var e,n=!1,i,r=Xu.length;for(e in t)if(rt(t,e)&&!(Qt.call(Xu,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Xu[i]]){if(n)return!1;parseFloat(t[Xu[i]])!==Ke(t[Xu[i]])&&(n=!0)}return!0}function Mk(){return this._isValid}function Pk(){return vr(NaN)}function xm(t){var e=Fb(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Tk(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=Zo(),this._bubble()}function eg(t){return t instanceof xm}function Dy(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Ik(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,s;for(s=0;s<i;s++)Ke(t[s])!==Ke(e[s])&&o++;return o+r}function VI(t,e){Re(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+Jr(~~(n/60),2)+e+Jr(~~n%60,2)})}VI("Z",":");VI("ZZ","");fe("Z",Mm);fe("ZZ",Mm);vt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Zb(Mm,t)});var xk=/([\+\-]|\d\d)/gi;function Zb(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(xk)||["-",0,0],o=+(r[1]*60)+Ke(r[2]),o===0?0:r[0]==="+"?o:-o)}function Qb(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(mr(t)||qh(t)?t.valueOf():Pt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Q.updateOffset(n,!1),n):Pt(t).local()}function ky(t){return-Math.round(t._d.getTimezoneOffset())}Q.updateOffset=function(){};function Ok(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Zb(Mm,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=ky(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?jI(this,vr(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:ky(this)}function Hk(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Ak(t){return this.utcOffset(0,t)}function Nk(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ky(this),"m")),this}function Dk(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Zb(eD,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function kk(t){return this.isValid()?(t=t?Pt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Lk(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function $k(){if(!Jn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return kb(t,this),t=LI(t),t._a?(e=t._isUTC?ro(t._a):Pt(t._a),this._isDSTShifted=this.isValid()&&Ik(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Fk(){return this.isValid()?!this._isUTC:!1}function Vk(){return this.isValid()?this._isUTC:!1}function WI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Wk=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Bk=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function vr(t,e){var n=t,i=null,r,o,s;return eg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Yo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=Wk.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Ke(i[Gr])*r,h:Ke(i[fn])*r,m:Ke(i[hr])*r,s:Ke(i[ko])*r,ms:Ke(Dy(i[Ba]*1e3))*r}):(i=Bk.exec(t))?(r=i[1]==="-"?-1:1,n={y:Xs(i[2],r),M:Xs(i[3],r),w:Xs(i[4],r),d:Xs(i[5],r),h:Xs(i[6],r),m:Xs(i[7],r),s:Xs(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=jk(Pt(n.from),Pt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new xm(n),eg(t)&&rt(t,"_locale")&&(o._locale=t._locale),eg(t)&&rt(t,"_isValid")&&(o._isValid=t._isValid),o}vr.fn=xm.prototype;vr.invalid=Pk;function Xs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function CE(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function jk(t,e){var n;return t.isValid()&&e.isValid()?(e=Qb(e,t),t.isBefore(e)?n=CE(t,e):(n=CE(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function BI(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(wI(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=vr(n,i),jI(this,r,t),this}}function jI(t,e,n,i){var r=e._milliseconds,o=Dy(e._days),s=Dy(e._months);t.isValid()&&(i=i??!0,s&&MI(t,_h(t,"Month")+s*n),o&&EI(t,"Date",_h(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&Q.updateOffset(t,o||s))}var Uk=BI(1,"add"),zk=BI(-1,"subtract");function UI(t){return typeof t=="string"||t instanceof String}function Yk(t){return mr(t)||qh(t)||UI(t)||Yo(t)||Kk(t)||Gk(t)||t===null||t===void 0}function Gk(t){var e=Ka(t)&&!Nb(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,s=i.length;for(r=0;r<s;r+=1)o=i[r],n=n||rt(t,o);return e&&n}function Kk(t){var e=gr(t),n=!1;return e&&(n=t.filter(function(i){return!Yo(i)&&UI(t)}).length===0),e&&n}function qk(t){var e=Ka(t)&&!Nb(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||rt(t,o);return e&&n}function Xk(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Zk(t,e){arguments.length===1&&(arguments[0]?Yk(arguments[0])?(t=arguments[0],e=void 0):qk(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Pt(),i=Qb(n,this).startOf("day"),r=Q.calendarFormat(this,i)||"sameElse",o=e&&(oo(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,Pt(n)))}function Qk(){return new Xh(this)}function Jk(t,e){var n=mr(t)?t:Pt(t);return this.isValid()&&n.isValid()?(e=Yi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function eL(t,e){var n=mr(t)?t:Pt(t);return this.isValid()&&n.isValid()?(e=Yi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function tL(t,e,n,i){var r=mr(t)?t:Pt(t),o=mr(e)?e:Pt(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function nL(t,e){var n=mr(t)?t:Pt(t),i;return this.isValid()&&n.isValid()?(e=Yi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function iL(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function rL(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function oL(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=Qb(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Yi(e),e){case"year":o=tg(this,i)/12;break;case"month":o=tg(this,i);break;case"quarter":o=tg(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:Fi(o)}function tg(t,e){if(t.date()<e.date())return-tg(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function sL(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function aL(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Jf(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):oo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Jf(n,"Z")):Jf(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function lL(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function uL(t){t||(t=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=Jf(this,t);return this.localeData().postformat(e)}function cL(t,e){return this.isValid()&&(mr(t)&&t.isValid()||Pt(t).isValid())?vr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function hL(t){return this.from(Pt(),t)}function dL(t,e){return this.isValid()&&(mr(t)&&t.isValid()||Pt(t).isValid())?vr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function fL(t){return this.to(Pt(),t)}function zI(t){var e;return t===void 0?this._locale._abbr:(e=Zo(t),e!=null&&(this._locale=e),this)}var YI=zi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function GI(){return this._locale}var Eg=1e3,Cu=60*Eg,_g=60*Cu,KI=(365*400+97)*24*_g;function yu(t,e){return(t%e+e)%e}function qI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-KI:new Date(t,e,n).valueOf()}function XI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-KI:Date.UTC(t,e,n)}function gL(t){var e,n;if(t=Yi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?XI:qI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=yu(e+(this._isUTC?0:this.utcOffset()*Cu),_g);break;case"minute":e=this._d.valueOf(),e-=yu(e,Cu);break;case"second":e=this._d.valueOf(),e-=yu(e,Eg);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function mL(t){var e,n;if(t=Yi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?XI:qI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=_g-yu(e+(this._isUTC?0:this.utcOffset()*Cu),_g)-1;break;case"minute":e=this._d.valueOf(),e+=Cu-yu(e,Cu)-1;break;case"second":e=this._d.valueOf(),e+=Eg-yu(e,Eg)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function pL(){return this._d.valueOf()-(this._offset||0)*6e4}function wL(){return Math.floor(this.valueOf()/1e3)}function vL(){return new Date(this.valueOf())}function CL(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function yL(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function bL(){return this.isValid()?this.toISOString():null}function SL(){return Db(this)}function RL(){return Is({},Le(this))}function EL(){return Le(this).overflow}function _L(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr");Re("NN",0,0,"eraAbbr");Re("NNN",0,0,"eraAbbr");Re("NNNN",0,0,"eraName");Re("NNNNN",0,0,"eraNarrow");Re("y",["y",1],"yo","eraYear");Re("y",["yy",2],0,"eraYear");Re("y",["yyy",3],0,"eraYear");Re("y",["yyyy",4],0,"eraYear");fe("N",Jb);fe("NN",Jb);fe("NNN",Jb);fe("NNNN",kL);fe("NNNNN",LL);vt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?Le(n).era=r:Le(n).invalidEra=t});fe("y",Lu);fe("yy",Lu);fe("yyy",Lu);fe("yyyy",Lu);fe("yo",$L);vt(["y","yy","yyy","yyyy"],On);vt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[On]=n._locale.eraYearOrdinalParse(t,r):e[On]=parseInt(t,10)});function TL(t,e){var n,i,r,o=this._eras||Zo("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=Q(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=Q(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function ML(t,e,n){var i,r,o=this.eras(),s,a,l;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(s=o[i].name.toUpperCase(),a=o[i].abbr.toUpperCase(),l=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[i];break;case"NNNN":if(s===t)return o[i];break;case"NNNNN":if(l===t)return o[i];break}else if([s,a,l].indexOf(t)>=0)return o[i]}function PL(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Q(t.since).year():Q(t.since).year()+(e-t.offset)*n}function IL(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function xL(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function OL(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function HL(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-Q(r[t].since).year())*n+r[t].offset;return this.year()}function AL(t){return rt(this,"_erasNameRegex")||eS.call(this),t?this._erasNameRegex:this._erasRegex}function NL(t){return rt(this,"_erasAbbrRegex")||eS.call(this),t?this._erasAbbrRegex:this._erasRegex}function DL(t){return rt(this,"_erasNarrowRegex")||eS.call(this),t?this._erasNarrowRegex:this._erasRegex}function Jb(t,e){return e.erasAbbrRegex(t)}function kL(t,e){return e.erasNameRegex(t)}function LL(t,e){return e.erasNarrowRegex(t)}function $L(t,e){return e._eraYearOrdinalRegex||Lu}function eS(){var t=[],e=[],n=[],i=[],r,o,s,a,l,u=this.eras();for(r=0,o=u.length;r<o;++r)s=jo(u[r].name),a=jo(u[r].abbr),l=jo(u[r].narrow),e.push(s),t.push(a),n.push(l),i.push(s),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100});Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Om(t,e){Re(0,[t,t.length],0,e)}Om("gggg","weekYear");Om("ggggg","weekYear");Om("GGGG","isoWeekYear");Om("GGGGG","isoWeekYear");fe("G",Tm);fe("g",Tm);fe("GG",It,Ei);fe("gg",It,Ei);fe("GGGG",Wb,Vb);fe("gggg",Wb,Vb);fe("GGGGG",_m,Rm);fe("ggggg",_m,Rm);Qh(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Ke(t)});Qh(["gg","GG"],function(t,e,n,i){e[i]=Q.parseTwoDigitYear(t)});function FL(t){return ZI.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function VL(t){return ZI.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function WL(){return Uo(this.year(),1,4)}function BL(){return Uo(this.isoWeekYear(),1,4)}function jL(){var t=this.localeData()._week;return Uo(this.year(),t.dow,t.doy)}function UL(){var t=this.localeData()._week;return Uo(this.weekYear(),t.dow,t.doy)}function ZI(t,e,n,i,r){var o;return t==null?Mh(this,i,r).year:(o=Uo(t,i,r),e>o&&(e=o),zL.call(this,t,e,n,i,r))}function zL(t,e,n,i,r){var o=xI(t,e,n,i,r),s=Th(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Re("Q",0,"Qo","quarter");fe("Q",CI);vt("Q",function(t,e){e[Do]=(Ke(t)-1)*3});function YL(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date");fe("D",It,$u);fe("DD",It,Ei);fe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});vt(["D","DD"],Gr);vt("Do",function(t,e){e[Gr]=Ke(t.match(It)[0])});var QI=Fu("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear");fe("DDD",Em);fe("DDDD",yI);vt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ke(t)});function GL(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Re("m",["mm",2],0,"minute");fe("m",It,Bb);fe("mm",It,Ei);vt(["m","mm"],hr);var KL=Fu("Minutes",!1);Re("s",["ss",2],0,"second");fe("s",It,Bb);fe("ss",It,Ei);vt(["s","ss"],ko);var qL=Fu("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)});Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Re(0,["SSS",3],0,"millisecond");Re(0,["SSSS",4],0,function(){return this.millisecond()*10});Re(0,["SSSSS",5],0,function(){return this.millisecond()*100});Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});fe("S",Em,CI);fe("SS",Em,Ei);fe("SSS",Em,yI);var xs,JI;for(xs="SSSS";xs.length<=9;xs+="S")fe(xs,Lu);function XL(t,e){e[Ba]=Ke(("0."+t)*1e3)}for(xs="S";xs.length<=9;xs+="S")vt(xs,XL);JI=Fu("Milliseconds",!1);Re("z",0,0,"zoneAbbr");Re("zz",0,0,"zoneName");function ZL(){return this._isUTC?"UTC":""}function QL(){return this._isUTC?"Coordinated Universal Time":""}var ee=Xh.prototype;ee.add=Uk;ee.calendar=Zk;ee.clone=Qk;ee.diff=oL;ee.endOf=mL;ee.format=uL;ee.from=cL;ee.fromNow=hL;ee.to=dL;ee.toNow=fL;ee.get=lD;ee.invalidAt=EL;ee.isAfter=Jk;ee.isBefore=eL;ee.isBetween=tL;ee.isSame=nL;ee.isSameOrAfter=iL;ee.isSameOrBefore=rL;ee.isValid=SL;ee.lang=YI;ee.locale=zI;ee.localeData=GI;ee.max=Sk;ee.min=bk;ee.parsingFlags=RL;ee.set=uD;ee.startOf=gL;ee.subtract=zk;ee.toArray=CL;ee.toObject=yL;ee.toDate=vL;ee.toISOString=aL;ee.inspect=lL;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=bL;ee.toString=sL;ee.unix=wL;ee.valueOf=pL;ee.creationData=_L;ee.eraName=IL;ee.eraNarrow=xL;ee.eraAbbr=OL;ee.eraYear=HL;ee.year=RI;ee.isLeapYear=aD;ee.weekYear=FL;ee.isoWeekYear=VL;ee.quarter=ee.quarters=YL;ee.month=PI;ee.daysInMonth=vD;ee.week=ee.weeks=TD;ee.isoWeek=ee.isoWeeks=MD;ee.weeksInYear=jL;ee.weeksInWeekYear=UL;ee.isoWeeksInYear=WL;ee.isoWeeksInISOWeekYear=BL;ee.date=QI;ee.day=ee.days=VD;ee.weekday=WD;ee.isoWeekday=BD;ee.dayOfYear=GL;ee.hour=ee.hours=qD;ee.minute=ee.minutes=KL;ee.second=ee.seconds=qL;ee.millisecond=ee.milliseconds=JI;ee.utcOffset=Ok;ee.utc=Ak;ee.local=Nk;ee.parseZone=Dk;ee.hasAlignedHourOffset=kk;ee.isDST=Lk;ee.isLocal=Fk;ee.isUtcOffset=Vk;ee.isUtc=WI;ee.isUTC=WI;ee.zoneAbbr=ZL;ee.zoneName=QL;ee.dates=zi("dates accessor is deprecated. Use date instead.",QI);ee.months=zi("months accessor is deprecated. Use month instead",PI);ee.years=zi("years accessor is deprecated. Use year instead",RI);ee.zone=zi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Hk);ee.isDSTShifted=zi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",$k);function JL(t){return Pt(t*1e3)}function e$(){return Pt.apply(null,arguments).parseZone()}function ex(t){return t}var ot=Lb.prototype;ot.calendar=FN;ot.longDateFormat=jN;ot.invalidDate=zN;ot.ordinal=KN;ot.preparse=ex;ot.postformat=ex;ot.relativeTime=XN;ot.pastFuture=ZN;ot.set=LN;ot.eras=TL;ot.erasParse=ML;ot.erasConvertYear=PL;ot.erasAbbrRegex=NL;ot.erasNameRegex=AL;ot.erasNarrowRegex=DL;ot.months=gD;ot.monthsShort=mD;ot.monthsParse=wD;ot.monthsRegex=yD;ot.monthsShortRegex=CD;ot.week=SD;ot.firstDayOfYear=_D;ot.firstDayOfWeek=ED;ot.weekdays=DD;ot.weekdaysMin=LD;ot.weekdaysShort=kD;ot.weekdaysParse=FD;ot.weekdaysRegex=jD;ot.weekdaysShortRegex=UD;ot.weekdaysMinRegex=zD;ot.isPM=GD;ot.meridiem=XD;function Tg(t,e,n,i){var r=Zo(),o=ro().set(i,e);return r[n](o,t)}function tx(t,e,n){if(Yo(t)&&(e=t,t=void 0),t=t||"",e!=null)return Tg(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Tg(t,i,n,"month");return r}function tS(t,e,n,i){typeof t=="boolean"?(Yo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Yo(e)&&(n=e,e=void 0),e=e||"");var r=Zo(),o=t?r._week.dow:0,s,a=[];if(n!=null)return Tg(e,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=Tg(e,(s+o)%7,i,"day");return a}function t$(t,e){return tx(t,e,"months")}function n$(t,e){return tx(t,e,"monthsShort")}function i$(t,e,n){return tS(t,e,n,"weekdays")}function r$(t,e,n){return tS(t,e,n,"weekdaysShort")}function o$(t,e,n){return tS(t,e,n,"weekdaysMin")}ks("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ke(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Q.lang=zi("moment.lang is deprecated. Use moment.locale instead.",ks);Q.langData=zi("moment.langData is deprecated. Use moment.localeData instead.",Zo);var uo=Math.abs;function s$(){var t=this._data;return this._milliseconds=uo(this._milliseconds),this._days=uo(this._days),this._months=uo(this._months),t.milliseconds=uo(t.milliseconds),t.seconds=uo(t.seconds),t.minutes=uo(t.minutes),t.hours=uo(t.hours),t.months=uo(t.months),t.years=uo(t.years),this}function nx(t,e,n,i){var r=vr(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function a$(t,e){return nx(this,t,e,1)}function l$(t,e){return nx(this,t,e,-1)}function yE(t){return t<0?Math.floor(t):Math.ceil(t)}function u$(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=yE(Ly(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Fi(t/1e3),i.seconds=r%60,o=Fi(r/60),i.minutes=o%60,s=Fi(o/60),i.hours=s%24,e+=Fi(s/24),l=Fi(ix(e)),n+=l,e-=yE(Ly(l)),a=Fi(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function ix(t){return t*4800/146097}function Ly(t){return t*146097/4800}function c$(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Yi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+ix(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Ly(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function Qo(t){return function(){return this.as(t)}}var rx=Qo("ms"),h$=Qo("s"),d$=Qo("m"),f$=Qo("h"),g$=Qo("d"),m$=Qo("w"),p$=Qo("M"),w$=Qo("Q"),v$=Qo("y"),C$=rx;function y$(){return vr(this)}function b$(t){return t=Yi(t),this.isValid()?this[t+"s"]():NaN}function fl(t){return function(){return this.isValid()?this._data[t]:NaN}}var S$=fl("milliseconds"),R$=fl("seconds"),E$=fl("minutes"),_$=fl("hours"),T$=fl("days"),M$=fl("months"),P$=fl("years");function I$(){return Fi(this.days()/7)}var Po=Math.round,du={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function x$(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function O$(t,e,n,i){var r=vr(t).abs(),o=Po(r.as("s")),s=Po(r.as("m")),a=Po(r.as("h")),l=Po(r.as("d")),u=Po(r.as("M")),c=Po(r.as("w")),h=Po(r.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,x$.apply(null,d)}function H$(t){return t===void 0?Po:typeof t=="function"?(Po=t,!0):!1}function A$(t,e){return du[t]===void 0?!1:e===void 0?du[t]:(du[t]=e,t==="s"&&(du.ss=e-1),!0)}function N$(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=du,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},du,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=O$(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var gv=Math.abs;function Cl(t){return(t>0)-(t<0)||+t}function Hm(){if(!this.isValid())return this.localeData().invalidDate();var t=gv(this._milliseconds)/1e3,e=gv(this._days),n=gv(this._months),i,r,o,s,a=this.asSeconds(),l,u,c,h;return a?(i=Fi(t/60),r=Fi(i/60),t%=60,i%=60,o=Fi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Cl(this._months)!==Cl(a)?"-":"",c=Cl(this._days)!==Cl(a)?"-":"",h=Cl(this._milliseconds)!==Cl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+s+"S":"")):"P0D"}var et=xm.prototype;et.isValid=Mk;et.abs=s$;et.add=a$;et.subtract=l$;et.as=c$;et.asMilliseconds=rx;et.asSeconds=h$;et.asMinutes=d$;et.asHours=f$;et.asDays=g$;et.asWeeks=m$;et.asMonths=p$;et.asQuarters=w$;et.asYears=v$;et.valueOf=C$;et._bubble=u$;et.clone=y$;et.get=b$;et.milliseconds=S$;et.seconds=R$;et.minutes=E$;et.hours=_$;et.days=T$;et.weeks=I$;et.months=M$;et.years=P$;et.humanize=N$;et.toISOString=Hm;et.toString=Hm;et.toJSON=Hm;et.locale=zI;et.localeData=GI;et.toIsoString=zi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Hm);et.lang=YI;Re("X",0,0,"unix");Re("x",0,0,"valueOf");fe("x",Tm);fe("X",tD);vt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});vt("x",function(t,e,n){n._d=new Date(Ke(t))});//! moment.js
Q.version="2.30.1";DN(Pt);Q.fn=ee;Q.min=Rk;Q.max=Ek;Q.now=_k;Q.utc=ro;Q.unix=JL;Q.months=t$;Q.isDate=qh;Q.locale=ks;Q.invalid=Sm;Q.duration=vr;Q.isMoment=mr;Q.weekdays=i$;Q.parseZone=e$;Q.localeData=Zo;Q.isDuration=eg;Q.monthsShort=n$;Q.weekdaysMin=o$;Q.defineLocale=Gb;Q.updateLocale=ek;Q.locales=tk;Q.weekdaysShort=r$;Q.normalizeUnits=Yi;Q.relativeTimeRounding=H$;Q.relativeTimeThreshold=A$;Q.calendarFormat=Xk;Q.prototype=ee;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function D$(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function bE(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function ng(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function si(t,e,n,i){let r=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r+=1;r<a;)s=e(s,o[r],r,o),r+=1;return s}function Za(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(s+=1,o[s]=a),n+=1}return o}function Ge(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];s+=1,o[s]=e(a,n,i),n+=1}return o}function M(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function k$(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function SE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return M(r,s=>{o=o.filter(a=>!s.includes(a))}),o}function RE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function ut(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return si(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function At(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function de(t){return typeof t<"u"}function Ht(t){return typeof t>"u"}function qt(t){return t===null||t===""||Ht(t)}function L$(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Gc="length",nh=t=>parseInt(t,16),EE=t=>parseInt(t,10),Mg=(t,e,n)=>t.substr(e,n),ih=t=>t.codePointAt(0)-65,$y=t=>`${t}`.replace(/\-/g,""),$$=t=>nh(Mg($y(t),nh("12"),ih("F")))/(nh(Mg($y(t),ih("B"),~~![][Gc]))||9),F$=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _E=!1;const TE={invalid:()=>ut`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ut`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ut`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},ME={invalid:()=>ut`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ut`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ut`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function V$(t,e){const n=!qt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="15.3.0";let o,s="invalid",a="invalid";t=$y(t||"");const l=W$(t);if(n||i||l)if(l){const u=Q("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=$$(t);o=Q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(F$()&&(s="valid",a="valid"),!_E&&s!=="valid"&&(TE[s]({keyValidityDate:o,hotVersion:r})&&console[s==="non_commercial"?"info":"warn"](TE[s]({keyValidityDate:o,hotVersion:r})),_E=!0),a!=="valid"&&e.parentNode&&ME[a]({keyValidityDate:o,hotVersion:r})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=ME[a]({keyValidityDate:o,hotVersion:r}),e.parentNode.insertBefore(c,e.nextSibling)}}function W$(t){let e=[][Gc],n=e;if(t[Gc]!==ih("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=ih(r.shift());o;o=ih(r.shift()||"A"))--o<""[Gc]?n=n|(EE(`${EE(nh(i)+(nh(Mg(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Mg(t,o,o?r[Gc]===1?9:8:6);return n===e}function pr(t){return t[0].toUpperCase()+t.substr(1)}function ox(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function sx(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function ax(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function PE(t){return nS(`${t}`,{ALLOWED_TAGS:[]})}function nS(t,e){return KA.sanitize(t,e)}const gl=t=>["tabindex",t],B$=()=>["role","treegrid"],Lo=()=>["role","presentation"],j$=()=>["role","gridcell"],U$=()=>["role","rowheader"],lx=()=>["role","rowgroup"],z$=()=>["role","columnheader"],Fy=()=>["role","row"],Y$=()=>["role","menu"],G$=()=>["role","menuitem"],K$=()=>["role","menuitemcheckbox"],q$=()=>["role","combobox"],ux=()=>["role","listbox"],X$=()=>["role","option"],Z$=()=>["role","checkbox"],Q$=()=>["scope","col"],J$=()=>["scope","row"],eF=()=>["type","text"],Ih=t=>["aria-label",t],ml=()=>["aria-hidden","true"],tF=()=>["aria-disabled","true"],nF=()=>["aria-multiselectable","true"],cx=t=>["aria-haspopup",t],hx=t=>["aria-rowcount",t],Am=t=>["aria-colcount",t],dx=t=>["aria-rowindex",t],iS=t=>["aria-colindex",t],Bi=t=>["aria-expanded",t],iF=t=>["aria-sort",t],IE=()=>["aria-readonly","true"],xE=()=>["aria-invalid","true"],fx=t=>["aria-checked",t],rS=()=>["aria-selected","true"],rF=()=>["aria-autocomplete","list"],oF=t=>["aria-controls",t],sF=t=>["aria-activedescendant",t],aF=t=>["aria-live",t],lF=t=>["aria-relevant",t],uF=t=>["aria-setsize",t],cF=t=>["aria-posinset",t];function hF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function ig(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function dF(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Mu(t){return dF(t)&&t.parent}function Qa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===i&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===r?o=l:o=o.parentNode}return null}function Cd(t,e,n){const i=[];let r=t;for(;r&&(r=Qa(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function fF(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function qa(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function gF(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Zs(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function gx(t){return!t||!t.length?[]:t.filter(e=>!!e)}function mx(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),{regexFree:i,regexes:n}}function Se(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=gx(e),e.length>0&&t.classList.add(...e)}function be(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=mx(e,!0);n=gx(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function Ee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function Vu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=mx(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function px(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)px(e[n])}}function Go(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const mF=/(<(.*)>|&(.*);)/;function Wu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;mF.test(e)?t.innerHTML=n?nS(e):e:Ja(t,e)}function Ja(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Go(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Pu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Pu(i.host.impl);if(i.host)return Pu(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function pF(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function xn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,s,a;for(o=r.offsetLeft,s=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,s+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,s+=n.pageYOffset||i.scrollTop),{left:o,top:s}}function wx(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function oS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function sS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?wx(e):t.scrollTop}function vx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?oS(e):t.scrollLeft}function Pg(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:s,overflowY:a}=r.style;if([o,s,a].includes("scroll"))return r;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(r),i.includes(o)||i.includes(s)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(s)||i.includes(o)))return r;r=r.parentNode}return n}function wF(t){return t.scrollHeight-t.clientHeight}function vF(t){return t.scrollWidth-t.clientWidth}function xh(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],s=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return i;i=i.parentNode}return n}function Ig(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function Jt(t){return t.offsetWidth}function an(t){return t.offsetHeight}function rh(t){return t.clientHeight||t.innerHeight}function Cx(t){return t.clientWidth||t.innerWidth}function yx(t){return t.selectionStart?t.selectionStart:0}function CF(t){return t.selectionEnd?t.selectionEnd:0}function OE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Nm(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let mv;function yF(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function vn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return mv===void 0&&(mv=yF(t)),mv}function bx(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Sx(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function aS(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Dm(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function rg(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Rx(t){return rg(t)&&t.hasAttribute("data-hot-input")===!1}function Ex(t){return!t.parentNode}function bF(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function _x(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();Ee(t,"contenteditable",!0),n&&Ee(t,...ml()),e&&q(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function Tx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&be(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function SF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_x(t,n),e(),Tx(t,n)}function zo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function ft(t){return typeof t=="function"}function km(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,s)},e),i}return r}function Mx(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function RF(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Vy(t,e,n,i,r,o,s,a){return de(a)?t.call(e,n,i,r,o,s,a):de(s)?t.call(e,n,i,r,o,s):de(o)?t.call(e,n,i,r,o):de(r)?t.call(e,n,i,r):de(i)?t.call(e,n,i):de(n)?t.call(e,n):t.call(e)}var HE={},pv,AE;function EF(){if(AE)return pv;AE=1;var t=Bs(),e=rI(),n=Nu(),i=FA(),r=pm(),o=t([].push);return pv=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||i(c)==="Number"||i(c)==="String")&&o(l,r(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var y=0;y<h;y++)if(l[y]===f)return m}}},pv}var NE;function _F(){if(NE)return HE;NE=1;var t=yt(),e=Pb(),n=Cm(),i=Ri(),r=Bs(),o=al(),s=Nu(),a=VA(),l=lI(),u=EF(),c=WA(),h=String,d=e("JSON","stringify"),f=r(/./.exec),m=r("".charAt),y=r("".charCodeAt),C=r("".replace),E=r(1 .toString),b=/[\uD800-\uDFFF]/g,$=/^[\uD800-\uDBFF]$/,W=/^[\uDC00-\uDFFF]$/,F=!c||o(function(){var K=e("Symbol")("stringify detection");return d([K])!=="[null]"||d({a:K})!=="{}"||d(Object(K))!=="{}"}),x=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),A=function(K,z){var le=l(arguments),ne=u(z);if(!(!s(ne)&&(K===void 0||a(K))))return le[1]=function(ve,ye){if(s(ne)&&(ye=i(ne,this,h(ve),ye)),!a(ye))return ye},n(d,null,le)},Z=function(K,z,le){var ne=m(le,z-1),ve=m(le,z+1);return f($,K)&&!f(W,ve)||f(W,K)&&!f($,ne)?"\\u"+E(y(K,0),16):K};return d&&t({target:"JSON",stat:!0,arity:3,forced:F||x},{stringify:function(z,le,ne){var ve=l(arguments),ye=n(F?A:d,null,ve);return x&&typeof ye=="string"?C(ye,b,Z):ye}}),HE}_F();function Oh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Be(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Oh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Oh(n[0])]:e[i]=[]:e[i]=null)})),e}function TF(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function ln(t,e,n){const i=Array.isArray(n);return Be(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function Lm(t,e){Be(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Lm(t[i],e[i])):t[i]=e[i]})}function Wn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function eo(t){const e={};return Be(t,(n,i)=>{e[i]=n}),e}function wt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return M(n,r=>{t.MIXINS.push(r.MIXIN_NAME),Be(r,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let y=m;return(Array.isArray(y)||We(y))&&(y=Wn(y)),y};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function lS(t,e){return JSON.stringify(t)===JSON.stringify(e)}function We(t){return Object.prototype.toString.call(t)==="[object Object]"}function Jo(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Be(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function MF(t,e){const n=e.split(".");let i=t;return Be(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function wv(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==i.length-1?(sn(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function uS(t){if(!We(t))return 0;const e=function(n){let i=0;return We(n)?Be(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function bi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function sn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xg(t){return window.requestAnimationFrame(t)}function Og(t){window.cancelAnimationFrame(t)}function Px(){return"ontouchstart"in window}function PF(){return typeof window<"u"}let yl;function IF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yl||(typeof Intl=="object"?yl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?yl=(n,i)=>`${n}`.localeCompare(i):yl=(n,i)=>n===i?0:n>i?-1:1,yl)}const Ni=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},Us={chrome:Ni((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Ni(t=>/CriOS/.test(t)),edge:Ni(t=>/Edge/.test(t)),edgeWebKit:Ni(t=>/EdgiOS/.test(t)),firefox:Ni(t=>/Firefox/.test(t)),firefoxWebKit:Ni(t=>/FxiOS/.test(t)),mobile:Ni(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Ni((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Jh={mac:Ni(t=>/^Mac/.test(t)),win:Ni(t=>/^Win/.test(t)),linux:Ni(t=>/^Linux/.test(t)),ios:Ni(t=>/iPhone|iPad|iPod/i.test(t))};function xF(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(Us,n=>{let{test:i}=n;return void i(t,e)})}function OF(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(Jh,e=>{let{test:n}=e;return void n(t)})}PF()&&(xF(),OF());function Ix(){return Us.chrome.value}function HF(){return Us.chromeWebKit.value}function vv(){return Us.firefox.value}function AF(){return Us.firefoxWebKit.value}function Hg(){return Us.safari.value}function NF(){return Us.edge.value}function $o(){return Us.mobile.value}function xx(){return Jh.ios.value}function Ox(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Jh.mac.value}function DE(){return Jh.win.value}function kE(){return Jh.mac.value}const Ce={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:vv()?182:174,AUDIO_MUTE:vv()?181:173,AUDIO_UP:vv()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},DF=[Ce.ALT,Ce.ARROW_DOWN,Ce.ARROW_LEFT,Ce.ARROW_RIGHT,Ce.ARROW_UP,Ce.AUDIO_DOWN,Ce.AUDIO_MUTE,Ce.AUDIO_UP,Ce.BACKSPACE,Ce.CAPS_LOCK,Ce.DELETE,Ce.END,Ce.ENTER,Ce.ESCAPE,Ce.F1,Ce.F2,Ce.F3,Ce.F4,Ce.F5,Ce.F6,Ce.F7,Ce.F8,Ce.F9,Ce.F10,Ce.F11,Ce.F12,Ce.F13,Ce.F14,Ce.F15,Ce.F16,Ce.F17,Ce.F18,Ce.F19,Ce.HOME,Ce.INSERT,Ce.MEDIA_NEXT,Ce.MEDIA_PLAY_PAUSE,Ce.MEDIA_PREV,Ce.MEDIA_STOP,Ce.NULL,Ce.NUM_LOCK,Ce.PAGE_DOWN,Ce.PAGE_UP,Ce.PAUSE,Ce.SCROLL_LOCK,Ce.SHIFT,Ce.TAB];function kF(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Hx(t){return DF.includes(t)}function LF(t){return[Ce.CONTROL,Ce.COMMAND_LEFT,Ce.COMMAND_RIGHT,Ce.COMMAND_FIREFOX].includes(t)}function ed(t,e){const n=e.split("|");let i=!1;return M(n,r=>{if(t===Ce[r])return i=!0,!1}),i}function Cr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Fa(t){return t.isImmediatePropagationEnabled===!1}function el(t){return t.button===2}function cS(t){return t.button===0}function $F(t){return t instanceof TouchEvent}function FF(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!zo(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function it(){de(console)&&console.warn(...arguments)}function hS(){de(console)&&console.error(...arguments)}const Va=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Cv=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yv=new Map([[]]);var LE={},bv,$E;function VF(){if($E)return bv;$E=1;var t=ym();return bv=function(e,n,i){for(var r=0,o=arguments.length>2?i:t(n),s=new e(o);o>r;)s[r]=n[r++];return s},bv}var Sv,FE;function WF(){if(FE)return Sv;FE=1;var t=ll();return Sv=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},Sv}var VE;function BF(){if(VE)return LE;VE=1;var t=yt(),e=Bs(),n=to(),i=BA(),r=VF(),o=WF(),s=bm(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=i(this),d=r(a,h);return l(d,c)}}),s("toSorted"),LE}BF();var WE={},BE={},jE;function jF(){if(jE)return BE;jE=1;var t=yt(),e=Ri(),n=ku(),i=to(),r=ji(),o=io(),s=Ui(),a=js(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){r(this);try{i(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),BE}var UE;function UF(){return UE||(UE=1,jF()),WE}UF();function zF(t,e){Ax(t,e),e.add(t)}function Rv(t,e,n){Ax(t,e),e.set(t,n)}function Ax(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zE(t,e,n){return t.set(Ag(t,e),n),n}function yn(t,e){return t.get(Ag(t,e))}function Ag(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YF=100;var di=new WeakMap,ru=new WeakMap,Ev=new WeakMap,_v=new WeakSet;class YE{constructor(){zF(this,_v),Rv(this,di,new Map),Rv(this,ru,new Map),Rv(this,Ev,new Set),Va.forEach(e=>Ag(_v,this,GE).call(this,e))}getHooks(e){var n;return(n=yn(di,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};yn(di,this).has(e)||(Ag(_v,this,GE).call(this,e),Va.push(e));const r=yn(di,this).get(e);if(r.find(u=>u.callback===n))return;const o=Number.isInteger(i.orderIndex)?i.orderIndex:0,s=!!i.runOnce,a=!!i.initialHook;let l=!1;if(a){const u=r.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){r.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=yn(Ev,this).has(e);!u&&o!==0&&(u=!0,yn(Ev,this).add(e)),u&&r.length>1&&yn(di,this).set(e,r.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return yn(di,this).has(e)&&yn(di,this).get(e).length>0}remove(e,n){if(!yn(di,this).has(e))return!1;const i=yn(di,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=yn(ru,this).get(e);return r.skip=!0,o+=1,o>YF&&(yn(di,this).set(e,i.filter(s=>!s.skip)),o=0),yn(ru,this).set(e,o),!0}return!1}destroy(){yn(di,this).clear(),yn(ru,this).clear(),zE(di,this,null),zE(ru,this,null)}}function GE(t){yn(di,this).set(t,[]),yn(ru,this).set(t,0)}function GF(t,e,n){return(e=KF(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KF(t){var e=qF(t,"string");return typeof e=="symbol"?e:e+""}function qF(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XF=ut`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class se{constructor(){GF(this,"globalBucket",new YE)}static getSingleton(){return QF()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new YE),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.add(e,o,i)):(Cv.has(e)&&it(ax(XF,{hookName:e,removedInVersion:Cv.get(e)})),yv.has(e)&&it(yv.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?M(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Vy(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Vy(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Va.push(e)}deregister(e){this.isRegistered(e)&&Va.splice(Va.indexOf(e),1)}isDeprecated(e){return yv.has(e)||Cv.has(e)}isRegistered(e){return Va.indexOf(e)>=0}getRegistered(){return Va}}const ZF=new se;function QF(){return ZF}const Tv=new Map;function yr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Tv.has(t)||Tv.set(t,new Map);const e=Tv.get(t);function n(a,l){e.set(a,l)}function i(a){return e.get(a)}function r(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:s}}const Wy=new WeakMap,{register:JF,getItem:Nx,hasItem:Dx,getNames:mie,getValues:pie}=yr("editors");function eV(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},se.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function kx(t,e){let n;if(typeof t=="function")Wy.get(t)||gi(null,t),n=Wy.get(t);else if(typeof t=="string")n=Nx(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function KE(t){if(typeof t=="function")return t;if(!Dx(t))throw Error(`No registered editor found under "${t}" name`);return Nx(t).getConstructor()}function gi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new eV(e);typeof t=="string"&&JF(t,n),Wy.set(e,n)}function tV(t,e,n){return(e=nV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nV(t){var e=iV(t,"string");return typeof e=="symbol"?e:e+""}function iV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tV(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){i.call(this,rV(s))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(i&&i!==s.callback||r&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function rV(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Cr(this)},t}function oV(t,e){sV(t,e),e.add(t)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,n){return(e=aV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aV(t){var e=lV(t,"string");return typeof e=="symbol"?e:e+""}function lV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yd=new WeakSet;class By{constructor(e,n,i){oV(this,yd),Qs(this,"hot",void 0),Qs(this,"tableMeta",void 0),Qs(this,"selection",void 0),Qs(this,"eventManager",void 0),Qs(this,"destroyed",!1),Qs(this,"activeEditor",void 0),Qs(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new wr(e),this.hot.addHook("afterDocumentKeyDown",r=>Mv(yd,this,qE).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>Mv(yd,this,qE).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,o,s)=>Mv(yd,this,uV).call(this,r,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let s=i,a=r;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=kx(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function qE(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Fa(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Hx(n)&&!LF(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function uV(t,e){e.isCell()&&this.openEditor(null,t,!0)}const XE=new WeakMap;By.getInstance=function(t,e,n){let i=XE.get(t);return i||(i=new By(t,e,n),XE.set(t,i)),i};function cV(t,e){Lx(t,e),e.add(t)}function Zu(t,e,n){Lx(t,e),e.set(t,n)}function Lx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(Ho(t,e))}function Qu(t,e,n){return t.set(Ho(t,e),n),n}function Ho(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bu=Object.freeze({CELL:"cell",MIXED:"mixed"});var rn=new WeakMap,bd=new WeakMap,Sd=new WeakMap,Rd=new WeakMap,Ed=new WeakMap,bs=new WeakSet;class hV{constructor(e){var n=this;cV(this,bs),Zu(this,rn,void 0),Zu(this,bd,void 0),Zu(this,Sd,1),Zu(this,Rd,null),Zu(this,Ed,new Map);const i=e.getSettings();Qu(rn,this,e),Qu(bd,this,i.imeFastEdit?bu.MIXED:bu.CELL),bt(rn,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Ho(bs,n,fV).call(n,...o)}),bt(rn,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Ho(bs,n,ZE).call(n,...o)}),bt(rn,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Ho(bs,n,ZE).call(n,...o)}),bt(rn,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Ho(bs,n,dV).call(n,...o)})}getFocusMode(){return bt(bd,this)}setFocusMode(e){Object.values(bu).includes(e)?Qu(bd,this,e):it(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return bt(Sd,this)}setRefocusDelay(e){Qu(Sd,this,e)}setRefocusElementGetter(e){Qu(Rd,this,e)}getRefocusElement(){var e;return typeof bt(Rd,this)=="function"?bt(Rd,this).call(this):(e=bt(rn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const s=(r=bt(rn,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=bt(rn,this).runHooks("modifyFocusedElement",s.row,s.col,i);zo(a)||(a=i),a&&!((o=bt(rn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Ho(bs,this,dS).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bt(Sd,this);if(bt(rn,this).getSettings().imeFastEdit&&!((e=bt(rn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=bt(rn,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),bt(Ed,this).has(n)||bt(Ed,this).set(n,km(()=>{if(!bt(rn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),bt(Ed,this).get(n)()}}}function dS(t){var e;const n=(e=bt(rn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!bt(rn,this).selection.isCellVisible(n)){t(null);return}const i=bt(rn,this).getCell(n.row,n.col,!0);i===null?bt(rn,this).addHookOnce("afterScroll",()=>{t(bt(rn,this).getCell(n.row,n.col,!0))}):t(i)}function ZE(){Ho(bs,this,dS).call(this,t=>{const{activeElement:e}=bt(rn,this).rootDocument;e&&Rx(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function dV(){Ho(bs,this,dS).call(this,t=>{this.getFocusMode()===bu.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function fV(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?bu.MIXED:bu.CELL)}var QE={},JE;function gV(){if(JE)return QE;JE=1;var t=yt(),e=Ri(),n=Bs(),i=uI(),r=Nu(),o=Mb(),s=jA(),a=pm(),l=sI(),u=UA(),c=zA(),h=Ob(),d=Du(),f=h("replace"),m=TypeError,y=n("".indexOf),C=n("".replace),E=n("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(W,F){var x=i(this),A,Z,K,z,le,ne,ve,ye,Ie,Nt,Me=0,je="";if(o(W)){if(A=s(W),A&&(Z=a(i(u(W))),!~y(Z,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(K=l(W,f),K)return e(K,W,x,F);if(d&&A)return C(a(x),W,F)}for(z=a(x),le=a(W),ne=r(F),ne||(F=a(F)),ve=le.length,ye=b(1,ve),Ie=y(z,le);Ie!==-1;)Nt=ne?a(F(le,Ie,z)):c(le,z,Ie,[],void 0,F),je+=E(z,Me,Ie)+Nt,Me=Ie+ve,Ie=Ie+ye>z.length?-1:y(z,le,Ie+ye);return Me<z.length&&(je+=E(z,Me)),je}}),QE}gV();var e_={},t_={},n_;function mV(){if(n_)return t_;n_=1;var t=yt(),e=ku(),n=to(),i=ji(),r=io(),o=Ui(),s=js(),a=Cm(),l=al(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){i(this);try{n(f)}catch(b){o(this,"throw",b)}var m=arguments.length<2,y=m?void 0:arguments[1];if(h)return a(h,this,m?[f]:[f,y]);var C=r(this),E=0;if(e(C,function(b){m?(m=!1,y=b):y=f(y,b,E),E++},{IS_RECORD:!0}),m)throw new u("Reduce of empty iterator with no initial value");return y}}),t_}var i_;function pV(){return i_||(i_=1,mV()),e_}pV();const $x={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},wV=new RegExp(Object.keys($x).map(t=>`(${t})`).join("|"),"gi");function vV(t){return(t&&t.nodeName||"")==="TABLE"}function r_(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,s=o>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let C=0;C<s;C+=1){const E=!f&&n&&C===0;let b="";if(f)b=`<th>${t.getColHeader(C-c)}</th>`;else if(E)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const $=r[d][C],{hidden:W,rowspan:F,colspan:x}=t.getCellMeta(d-h,C-c);if(!W){const A=[];if(F&&A.push(`rowspan="${F}"`),x&&A.push(`colspan="${x}"`),qt($))b=`<td ${A.join(" ")}></td>`;else{const Z=$.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${A.join(" ")}>${Z}</td>`}}}m.push(b)}const y=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function o_(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,s=[];i===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=r[a],u=qt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function CV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const $=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,W=>{const F=W.match(/<td\b[^>]*?>/g)[0],x=/<p.*?>/g,A=W.substring(F.length,W.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(x,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${F}${A}</td>`});r.insertAdjacentHTML("afterbegin",`${$}`),o=r.querySelector("table")}if(!o||!vV(o))return;const s=r.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce(($,W)=>$+W.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const $=Array.from(o.tHead.rows).filter(W=>{const F=W.querySelector("td")!==null;return F&&h.push(W),!F});f=$.length,d=f>0,f>1?n.nestedHeaders=Array.from($).reduce((W,F)=>{const x=Array.from(F.cells).reduce((A,Z,K)=>{if(a&&K===0)return A;const{colSpan:z,innerHTML:le}=Z,ne=z>1?{label:le,colspan:z}:le;return A.push(ne),A},[]);return W.push(x),W},[]):d&&(n.colHeaders=Array.from($[0].children).reduce((W,F,x)=>(a&&x===0||W.push(F.innerHTML),W),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce(($,W)=>($.push(...Array.from(W.rows)),$),[]),...c];m=y.length;const C=new Array(m);for(let $=0;$<m;$++)C[$]=new Array(u);const E=[],b=[];for(let $=0;$<m;$++){const W=y[$],F=Array.from(W.cells),x=F.length;for(let A=0;A<x;A++){const Z=F[A],{nodeName:K,innerHTML:z,rowSpan:le,colSpan:ne}=Z,ve=C[$].findIndex(ye=>ye===void 0);if(K==="TD"){if(le>1||ne>1){for(let Me=$;Me<$+le;Me++)if(Me<m)for(let je=ve;je<ve+ne;je++)C[Me][je]=null;const Ie=Z.getAttribute("style");Ie&&Ie.includes("mso-ignore:colspan")||E.push({col:ve,row:$,rowspan:le,colspan:ne})}let ye="";s&&/excel/gi.test(s.content)?ye=z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ye=z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[$][ve]=ye.replace(wV,Ie=>$x[Ie])}else b.push(z)}}return E.length&&(n.mergeCells=E),b.length&&(n.rowHeaders=b),C.length&&(n.data=C),n}function Vn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function yV(t){return Vn(t,[","])}function pe(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function s_(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function Fx(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Xe(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const jy="asc",bV="desc",a_=new Map([[jy,[-1,1]],[bV,[1,-1]]]),SV=t=>`The priority '${t}' is already declared in a map.`,RV=t=>`The priority '${t}' is not a number.`;function EV(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ft(t)?t:SV,e=ft(e)?e:RV;function i(o,s){if(!Vn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jy;const[s,a]=a_.get(o)||a_.get(jy);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:r}}const _V=t=>`The id '${t}' is already declared in a map.`;function $m(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ft(t)?t:_V;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function i(u){return e.delete(u)}function r(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:r,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:i}}const TV=t=>`'${t}' value is already declared in a unique set.`;function MV(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ft(t)?t:TV;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const fS=t=>`There is already registered "${t}" plugin.`,PV=t=>`There is already registered plugin on priority "${t}".`,IV=t=>`The priority "${t}" is not a number.`,Vx=EV({errorPriorityExists:PV,errorPriorityNaN:IV}),Wx=MV({errorItemExists:fS}),Uy=$m({errorIdExists:fS});function Bx(){return[...Vx.getItems(),...Wx.getItems()]}function gS(t){const e=pr(t);return Uy.getItem(e)}function xV(t){return!!gS(t)}function Ze(t,e,n){[t,e,n]=HV(t,e,n),gS(t)===void 0&&OV(t,e,n)}function OV(t,e,n){const i=pr(t);if(Uy.hasItem(i))throw new Error(fS(i));n===void 0?Wx.addItem(i):Vx.addItem(n,i),Uy.addItem(i,e)}function HV(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:AV,getItem:NV,hasItem:jx,getNames:wie,getValues:vie}=yr("renderers");function l_(t){if(typeof t=="function")return t;if(!jx(t))throw Error(`No registered renderer found under "${t}" name`);return NV(t)}function Oi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),AV(t,e)}const{register:DV,getItem:kV,hasItem:Ux,getNames:Cie,getValues:yie}=yr("validators");function LV(t){if(typeof t=="function")return t;if(!Ux(t))throw Error(`No registered validator found under "${t}" name`);return kV(t)}function ou(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),DV(t,e)}var u_={},c_;function $V(){if(c_)return u_;c_=1;var t=yt(),e=Ib(),n=ym(),i=xb(),r=bm();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=i(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),r("at"),u_}$V();var h_={},d_;function FV(){if(d_)return h_;d_=1;var t=yt(),e=Bs(),n=uI(),i=xb(),r=pm(),o=al(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=r(n(this)),h=c.length,d=i(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),h_}FV();function Ju(t,e,n){return(e=VV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VV(t){var e=WV(t,"string");return typeof e=="symbol"?e:e+""}function WV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BV{constructor(){Ju(this,"count",0),Ju(this,"startColumn",null),Ju(this,"endColumn",null),Ju(this,"startPosition",null),Ju(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:s}=n,a=r>0?o+1:o;i>=r&&i+s<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=r&&(this.startColumn-=1),m>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ec(t,e,n){return(e=jV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jV(t){var e=UV(t,"string");return typeof e=="symbol"?e:e+""}function UV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zV{constructor(){ec(this,"count",0),ec(this,"startRow",null),ec(this,"endRow",null),ec(this,"startPosition",null),ec(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:s}=n;i>=r&&i+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-o&&(this.startRow-=1),d>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function tc(t,e,n){return(e=YV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YV(t){var e=GV(t,"string");return typeof e=="symbol"?e:e+""}function GV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zx{constructor(){tc(this,"count",0),tc(this,"startColumn",null),tc(this,"endColumn",null),tc(this,"startPosition",null),tc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const s=r>0?o+1:o;i>=r&&i<=r+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r;i+r-h<-1*o||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function nc(t,e,n){return(e=KV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KV(t){var e=qV(t,"string");return typeof e=="symbol"?e:e+""}function qV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yx{constructor(){nc(this,"count",0),nc(this,"startRow",null),nc(this,"endRow",null),nc(this,"startPosition",null),nc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ic(t,e,n){return(e=XV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XV(t){var e=ZV(t,"string");return typeof e=="symbol"?e:e+""}function ZV(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QV{constructor(){ic(this,"count",0),ic(this,"startColumn",0),ic(this,"endColumn",0),ic(this,"startPosition",0),ic(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function rc(t,e,n){return(e=JV(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JV(t){var e=eW(t,"string");return typeof e=="symbol"?e:e+""}function eW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tW{constructor(){rc(this,"count",0),rc(this,"startRow",0),rc(this,"endRow",0),rc(this,"startPosition",0),rc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function f_(t,e,n){return(e=nW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nW(t){var e=iW(t,"string");return typeof e=="symbol"?e:e+""}function iW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rW extends zx{constructor(){super(...arguments),f_(this,"columnStartOffset",0),f_(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const s=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function g_(t,e,n){return(e=oW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oW(t){var e=sW(t,"string");return typeof e=="symbol"?e:e+""}function sW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aW extends Yx{constructor(){super(...arguments),g_(this,"rowStartOffset",0),g_(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const s=this.startRow,a=this.endRow;i(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function m_(t,e,n){return(e=lW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lW(t){var e=uW(t,"string");return typeof e=="symbol"?e:e+""}function uW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gx{constructor(e){m_(this,"calculationTypes",[]),m_(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ki(t,e,n){return(e=cW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cW(t){var e=hW(t,"string");return typeof e=="symbol"?e:e+""}function hW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iu=50;class dW extends Gx{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Ki(this,"viewportWidth",0),Ki(this,"scrollOffset",0),Ki(this,"zeroBasedScrollOffset",0),Ki(this,"totalColumns",0),Ki(this,"columnWidthFn",null),Ki(this,"columnWidth",0),Ki(this,"overrideFn",null),Ki(this,"inlineStartOffset",0),Ki(this,"totalCalculatedWidth",0),Ki(this,"startPositions",[]),Ki(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Iu:n}}function Ti(t,e,n){return(e=fW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fW(t){var e=gW(t,"string");return typeof e=="symbol"?e:e+""}function gW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mW extends Gx{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Ti(this,"viewportHeight",0),Ti(this,"scrollOffset",0),Ti(this,"zeroBasedScrollOffset",0),Ti(this,"totalRows",0),Ti(this,"rowHeightFn",null),Ti(this,"rowHeight",0),Ti(this,"overrideFn",null),Ti(this,"horizontalScrollbarHeight",0),Ti(this,"innerViewportHeight",0),Ti(this,"totalCalculatedHeight",0),Ti(this,"startPositions",[]),Ti(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function pW(t,e,n){wW(t,e),e.set(t,n)}function wW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p_(t,e,n){return(e=vW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vW(t){var e=CW(t,"string");return typeof e=="symbol"?e:e+""}function CW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bl(t,e){return t.get(Kx(t,e))}function w_(t,e,n){return t.set(Kx(t,e),n),n}function Kx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var co=new WeakMap;class tl{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;p_(this,"row",null),p_(this,"col",null),pW(this,co,!1),w_(co,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return bl(co,this)}isSouthEastOf(e){return this.row>=e.row&&(bl(co,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(bl(co,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(bl(co,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(bl(co,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof tl&&w_(co,this,e.isRtl()),this}clone(){return new tl(this.row,this.col,bl(co,this))}toObject(){return{row:this.row,col:this.col}}}function yW(t,e,n){bW(t,e),e.set(t,n)}function bW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pv(t,e,n){return(e=SW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SW(t){var e=RW(t,"string");return typeof e=="symbol"?e:e+""}function RW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mi(t,e){return t.get(qx(t,e))}function EW(t,e,n){return t.set(qx(t,e),n),n}function qx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jn=new WeakMap;class td{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Pv(this,"highlight",null),Pv(this,"from",null),Pv(this,"to",null),yW(this,jn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),EW(jn,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Mi(jn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Mi(jn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Mi(jn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Mi(jn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Mi(jn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Mi(jn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Mi(jn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Mi(jn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof tl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(Mi(jn,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(Mi(jn,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new td(this.highlight,this.from,this.to,Mi(jn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new tl(e,n,Mi(jn,this))}}function Sr(t,e,n){_W(t,e),e.set(t,n)}function _W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(t,e){return t.get(Xx(t,e))}function rs(t,e,n){return t.set(Xx(t,e),n),n}function Xx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pi=new WeakMap,Iv=new WeakMap,mn=new WeakMap,Sl=new WeakMap,_d=new WeakMap,qi=new WeakMap,xv=new WeakMap,oc=new WeakMap,Js=new WeakMap,Rr=new WeakMap;let Zx=class{constructor(e,n,i,r,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Sr(this,Pi,void 0),Sr(this,Iv,void 0),Sr(this,mn,void 0),Sr(this,Sl,void 0),Sr(this,_d,void 0),Sr(this,qi,void 0),Sr(this,xv,void 0),Sr(this,oc,void 0),Sr(this,Js,[null,null]),Sr(this,Rr,[null,null]),rs(Pi,this,i),rs(Iv,this,n),rs(mn,this,o),rs(Sl,this,s),rs(_d,this,a),rs(qi,this,r),rs(xv,this,e),this.registerEvents()}registerEvents(){we(qi,this).addEventListener(we(mn,this).holder,"contextmenu",i=>this.onContextMenu(i)),we(qi,this).addEventListener(we(mn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),we(qi,this).addEventListener(we(mn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{we(qi,this).addEventListener(we(mn,this).holder,"touchstart",i=>this.onTouchStart(i)),we(qi,this).addEventListener(we(mn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),we(qi,this).addEventListener(we(mn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||we(Pi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,we(Pi,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{we(qi,this).addEventListener(we(mn,this).holder,"mouseup",i=>this.onMouseUp(i)),we(qi,this).addEventListener(we(mn,this).holder,"mousedown",i=>this.onMouseDown(i))};$o()?e():(Px()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(we(oc,this)&&i){const[r,o]=[i.row,we(oc,this).from.row],[s,a]=[i.col,we(oc,this).from.col];return r===o&&s===a}return!1}parentCell(e){const n={},i=we(mn,this).TABLE,r=Cd(e,["TD","TH"],i);return r?(n.coords=we(mn,this).getCoords(r),n.TD=r):Se(e,"wtBorder")&&Se(e,"current")?(n.coords=we(Sl,this).getFocusSelection().cellRange.highlight,n.TD=we(mn,this).getCell(n.coords)):Se(e,"wtBorder")&&Se(e,"area")&&we(Sl,this).getAreaSelection().cellRange&&(n.coords=we(Sl,this).getAreaSelection().cellRange.to,n.TD=we(mn,this).getCell(n.coords)),n}onMouseDown(e){const n=we(Iv,this).rootDocument.activeElement,i=Mx(hF,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);Se(r,"corner")?we(Pi,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&we(Pi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(we(Rr,this)[0]=o.TD,clearTimeout(we(Js,this)[0]),we(Js,this)[0]=setTimeout(()=>{we(Rr,this)[0]=null},1e3))}onContextMenu(e){if(we(Pi,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!we(Pi,this).has("onCellMouseOver"))return;const n=we(mn,this).TABLE,i=Cd(e.target,["TD","TH"],n),r=we(_d,this)||this;i&&i!==r.lastMouseOver&&qa(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,we(mn,this).getCoords(i),i))}onMouseOut(e){if(!we(Pi,this).has("onCellMouseOut"))return;const n=we(mn,this).TABLE,i=Cd(e.target,["TD","TH"],n),r=Cd(e.relatedTarget,["TD","TH"],n),o=we(_d,this)||this;i&&i!==r&&qa(i,n)&&(this.callListener("onCellMouseOut",e,we(mn,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&we(Pi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===we(Rr,this)[0]&&n.TD===we(Rr,this)[1]?(Se(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),we(Rr,this)[0]=null,we(Rr,this)[1]=null):n.TD===we(Rr,this)[0]&&(we(Rr,this)[1]=n.TD,clearTimeout(we(Js,this)[1]),we(Js,this)[1]=setTimeout(()=>{we(Rr,this)[1]=null},500)))}onTouchStart(e){rs(oc,this,we(Sl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=de(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&we(Pi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];xx()&&(HF()||AF())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=we(Pi,this).getSettingPure(e);o&&o(n,i,r,we(xv,this).call(this))}destroy(){clearTimeout(we(Js,this)[0]),clearTimeout(we(Js,this)[1]),we(qi,this).destroy()}};function Ov(t,e,n){return(e=TW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TW(t){var e=MW(t,"string");return typeof e=="symbol"?e:e+""}function MW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PW{constructor(e,n,i){Ov(this,"offset",void 0),Ov(this,"total",void 0),Ov(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Hv(t,e,n){return(e=IW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IW(t){var e=xW(t,"string");return typeof e=="symbol"?e:e+""}function xW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OW{constructor(e,n,i){Hv(this,"offset",void 0),Hv(this,"total",void 0),Hv(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Td(t,e,n){return(e=HW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HW(t){var e=AW(t,"string");return typeof e=="symbol"?e:e+""}function AW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NW{constructor(){Td(this,"currentSize",0),Td(this,"nextSize",0),Td(this,"currentOffset",0),Td(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const DW=0,v_=1,zy=2;function Av(t,e,n){return(e=kW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kW(t){var e=LW(t,"string");return typeof e=="symbol"?e:e+""}function LW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $W{constructor(){Av(this,"size",new NW),Av(this,"workingSpace",DW),Av(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=v_,e.workingSpace=zy,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=zy,e.workingSpace=v_,this.sharedSize=e.getViewSize()}}var C_={},Nv,y_;function FW(){if(y_)return Nv;y_=1;var t=YA(),e=TypeError;return Nv=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},Nv}var b_;function VW(){if(b_)return C_;b_=1;var t=yt(),e=Ib(),n=ym(),i=cI(),r=FW(),o=hI(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var m=d;m--;){var y=m+f;m in h?h[y]=h[m]:r(h,y)}for(var C=0;C<f;C++)h[C]=arguments[C]}return i(h,d+f)}}),C_}VW();function WW(t,e,n){return(e=BW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BW(t){var e=jW(t,"string");return typeof e=="symbol"?e:e+""}function jW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_{constructor(e,n){WW(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function UW(t,e,n){return(e=zW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zW(t){var e=YW(t,"string");return typeof e=="symbol"?e:e+""}function YW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GW{constructor(e){UW(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new S_(o,n),l=new S_(s,i),u=[];for(let c=0;c<r;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(zy)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Rl(t,e,n){return(e=KW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KW(t){var e=qW(t,"string");return typeof e=="symbol"?e:e+""}function qW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qx{constructor(e,n){Rl(this,"rootNode",void 0),Rl(this,"nodesPool",void 0),Rl(this,"sizeSet",new $W),Rl(this,"collectedNodes",[]),Rl(this,"viewDiffer",new GW(this.sizeSet)),Rl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,s]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class Jx extends Qx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function R_(t,e,n){return(e=XW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XW(t){var e=ZW(t,"string");return typeof e=="symbol"?e:e+""}function ZW(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QW{constructor(e){R_(this,"nodeType",void 0),R_(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function sc(t,e,n){return(e=JW(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JW(t){var e=eB(t,"string");return typeof e=="symbol"?e:e+""}function eB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nd{constructor(e,n){sc(this,"nodesPool",null),sc(this,"nodeType",void 0),sc(this,"rootNode",void 0),sc(this,"table",null),sc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new QW(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function E_(t,e,n){return(e=tB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tB(t){var e=nB(t,"string");return typeof e=="symbol"?e:e+""}function nB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iB extends nd{constructor(){super("TH"),E_(this,"orderViews",new WeakMap),E_(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Jx(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(0).start();for(let h=i-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Vu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(d,[U$(),J$(),iS(h+1),gl(-1)]),n[h](a,d,h)}u.end()}}}class rB extends nd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Go(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ee(this.rootNode,[lx()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ee(s,[Fy(),dx(n+1)]);for(let a=-1*o;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Vu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(u,[iS(a+1+this.table.rowHeadersCount),gl(-1),z$(),...a>=0?[Q$()]:[Fy()]]),i[n](l,u,n)}}}}let __=!1;class oB extends nd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!__&&e>1e3&&(__=!0,it(ut`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&q(i,"rowHeader")}}function sB(t,e,n){return(e=aB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aB(t){var e=lB(t,"string");return typeof e=="symbol"?e:e+""}function lB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const El={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let T_=!1;class uB extends nd{constructor(e){super("TR",e),sB(this,"orderView",void 0),this.orderView=new Qx(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!T_&&e>1e3&&(T_=!0,it(ut`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ee(this.rootNode,[lx()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;Ee(o,[Fy(),dx(s+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Se(o,El.rowEven)||(be(o,El.rowOdd),q(o,El.rowEven)):Se(o,El.rowOdd)||(be(o,El.rowEven),q(o,El.rowOdd))}this.orderView.end()}}function M_(t,e,n){return(e=cB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cB(t){var e=hB(t,"string");return typeof e=="symbol"?e:e+""}function hB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dB extends nd{constructor(){super("TD"),M_(this,"orderViews",new WeakMap),M_(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Jx(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(Se(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Vu(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;Ee(m,[...m.hasAttribute("role")?[]:[j$()],gl(-1),iS(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function tn(t,e,n){return(e=fB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fB(t){var e=gB(t,"string");return typeof e=="symbol"?e:e+""}function gB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mB{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tn(this,"rootNode",void 0),tn(this,"rootDocument",void 0),tn(this,"rowHeaders",null),tn(this,"columnHeaders",null),tn(this,"colGroup",null),tn(this,"rows",null),tn(this,"cells",null),tn(this,"rowFilter",null),tn(this,"columnFilter",null),tn(this,"rowUtils",null),tn(this,"columnUtils",null),tn(this,"rowsToRender",0),tn(this,"columnsToRender",0),tn(this,"rowHeaderFunctions",[]),tn(this,"rowHeadersCount",0),tn(this,"columnHeaderFunctions",[]),tn(this,"columnHeadersCount",0),tn(this,"cellRenderer",void 0),tn(this,"activeOverlayName",void 0),tn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const s=this.renderedRowToSource(i),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-u}px`:r.firstChild.style.height=""}}}}class pB{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new mB(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new iB,columnHeaders:new rB(n),colGroup:new oB(i),rows:new uB(r),cells:new dB}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Dv(t,e,n){return(e=wB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wB(t){var e=vB(t,"string");return typeof e=="symbol"?e:e+""}function vB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CB{constructor(e,n){Dv(this,"dataAccessObject",void 0),Dv(this,"wtSettings",void 0),Dv(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let s=Array.isArray(n)?n[o]:n;s=s??r,this.headerWidths.set(o,s)}}}}function P_(t,e,n){return(e=yB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yB(t){var e=bB(t,"string");return typeof e=="symbol"?e:e+""}function bB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SB{constructor(e,n){P_(this,"dataAccessObject",void 0),P_(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Er(t,e,n){return(e=RB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RB(t){var e=EB(t,"string");return typeof e=="symbol"?e:e+""}function EB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bu{constructor(e,n,i,r,o){Er(this,"wtSettings",null),Er(this,"domBindings",void 0),Er(this,"TBODY",null),Er(this,"THEAD",null),Er(this,"COLGROUP",null),Er(this,"hasTableHeight",!0),Er(this,"hasTableWidth",!0),Er(this,"isTableVisible",!1),Er(this,"tableOffset",0),Er(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,px(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new SB(this.dataAccessObject,this.wtSettings),this.columnUtils=new CB(this.dataAccessObject,this.wtSettings),this.tableRenderer=new pB({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Se(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ee(i,[Lo()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Se(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(i,[Lo()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Se(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",Ee(i,[gl(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ee(i.parentNode,[Lo()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(i,[Lo()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=xn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=xn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new OW(f,o,c),this.columnFilter=new PW(m,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),y=C.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Kr)||this.is(Ls))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Kr))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Kr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(a=rh(s),(!o&&r<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,s=r.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Kr))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[r];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Qa(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let o=gF(i),s=n.cellIndex;Zs(rl,n,this.wtRootElement)||Zs(nl,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):Zs(Ls,n,this.wtRootElement)||Zs(Kr,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Zs(rl,n,this.wtRootElement)||Zs(il,n,this.wtRootElement)||Zs(Ls,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=rh(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),o=r?an:rh,s=r?0:1,a=r?1:0;let l,u,c,h,d;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(r||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Jt(this.TABLE)}getHeight(){return an(this.TABLE)}getTotalWidth(){const e=Jt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=an(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Pu(this.TABLE)}_modifyRowHeaderWidth(e){let n=ft(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const _B="stickyRowsBottom",mS={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Jo(mS,"MIXIN_NAME",_B,{writable:!1,enumerable:!1});const TB="stickyColumnsStart",Fm={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jo(Fm,"MIXIN_NAME",TB,{writable:!1,enumerable:!1});class pS extends Bu{constructor(e,n,i,r){super(e,n,i,r,Ls)}}wt(pS,mS);wt(pS,Fm);const nl="top",Kr="bottom",il="inline_start",rl="top_inline_start_corner",Ls="bottom_inline_start_corner",e1=[nl,Kr,il,rl,Ls],MB=new Map([[nl,`ht_clone_${nl}`],[Kr,`ht_clone_${Kr}`],[il,`ht_clone_${il} ht_clone_left`],[rl,`ht_clone_${rl} ht_clone_top_left_corner`],[Ls,`ht_clone_${Ls} ht_clone_bottom_left_corner`]]);function PB(t,e){IB(t,e),e.add(t)}function IB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xB(t,e,n){return(e=OB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OB(t){var e=HB(t,"string");return typeof e=="symbol"?e:e+""}function HB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Md(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ac=new WeakSet;class AB{constructor(e){PB(this,ac),xB(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=bi(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=bi(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>r-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Md(ac,this,x_).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Md(ac,this,x_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Md(ac,this,I_).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Md(ac,this,I_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function I_(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=xn(i.wtRootElement).left;const u=Math.abs(vx(s,s));if(l>u){const c=Cx(s);let h=r.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function x_(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=xn(n.wtRootElement),a=sS(o,o);if(s.top>a){const l=rh(o);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Ii(t,e,n){return(e=NB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NB(t){var e=DB(t,"string");return typeof e=="symbol"?e:e+""}function DB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wS{get eventManager(){return new wr(this)}constructor(e,n){Ii(this,"wtTable",void 0),Ii(this,"wtScroll",void 0),Ii(this,"wtViewport",void 0),Ii(this,"wtOverlays",void 0),Ii(this,"selectionManager",void 0),Ii(this,"wtEvent",void 0),Ii(this,"guid",`wt_${ox()}`),Ii(this,"drawInterrupted",!1),Ii(this,"drawn",!1),Ii(this,"activeOverlayName","master"),Ii(this,"domBindings",void 0),Ii(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new AB(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Ja(i,e[n])}])}}createCellCoords(e,n){return new tl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new td(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||pF(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function O_(t,e,n){return(e=kB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kB(t){var e=LB(t,"string");return typeof e=="symbol"?e:e+""}function LB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $B extends wS{constructor(e,n,i){super(e,n),O_(this,"cloneSource",void 0),O_(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Zx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function FB(t,e,n){return(e=VB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VB(t){var e=WB(t,"string");return typeof e=="symbol"?e:e+""}function WB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class id{constructor(e,n,i,r,o){FB(this,"wtSettings",null),Jo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=xh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=xh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Pg(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){it(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=r.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+vn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(e1.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${MB.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ee(o,[Lo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===nl||u==="vertical"&&this.type===il?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Pg(e.TABLE),new $B(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BB extends id{constructor(e,n,i,r,o,s){super(e,n,Ls,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new pS(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Dm(n),this.repositionOverlay();let i=an(this.clone.wtTable.TABLE);const r=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=vn(i)),r.style.bottom=`${o}px`}}const jB="calculatedColumns",Vm={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jo(Vm,"MIXIN_NAME",jB,{writable:!1,enumerable:!1});class vS extends Bu{constructor(e,n,i,r){super(e,n,i,r,Kr)}}wt(vS,mS);wt(vS,Vm);function UB(t,e,n){return(e=zB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zB(t){var e=YB(t,"string");return typeof e=="symbol"?e:e+""}function YB(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GB extends id{constructor(e,n,i,r){super(e,n,Kr,i,r),UB(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new vS(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=vn(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(oS(n),top),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,stylesHandler:r}=this.wot,o=r.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=i.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=vn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=an(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=vn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return sS(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=Se(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(be(s,"innerBorderBottom"),o=a)}return o}}const KB="calculatedRows",CS={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jo(CS,"MIXIN_NAME",KB,{writable:!1,enumerable:!1});class yS extends Bu{constructor(e,n,i,r){super(e,n,i,r,il)}}wt(yS,CS);wt(yS,Fm);const qB="localHooks",bn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Vy(this._localHooks[t][l],this,e,n,i,r,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Jo(bn,"MIXIN_NAME",qB,{writable:!1,enumerable:!1});let t1=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};wt(t1,bn);const n1="active-header",bS="header",SS="area",oh="focus",XB="fill",ZB="row",QB="column",JB="custom-selection",RS=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var H_={},A_;function ej(){if(A_)return H_;A_=1;var t=bm();return t("flat"),H_}ej();function tj(t,e){i1(t,e),e.add(t)}function N_(t,e,n){i1(t,e),e.set(t,n)}function i1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(sh(t,e))}function D_(t,e,n){return t.set(sh(t,e),n),n}function sh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tr=new WeakMap,Tn=new WeakMap,Pd=new WeakSet;class nj{constructor(){tj(this,Pd),N_(this,tr,void 0),N_(this,Tn,void 0)}setActiveOverlay(e){return D_(Tn,this,e),this}setActiveSelection(e){return D_(tr,this,e),this}scan(){const e=$t(tr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=$t(tr,this).getCorners(),{wtTable:s}=$t(Tn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>o)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let m=s.getColumnHeader(h,f);const y=$t(Tn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:$t(tr,this).settings.selectionType,columnCursor:u,selectionWidth:o-i+1});y!==null&&(y!==h&&(m=s.getColumnHeader(y,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=$t(tr,this).getCorners(),{wtTable:s}=$t(Tn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const y=$t(Tn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:$t(tr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});y!==null&&(y!==h&&(m=s.getRowHeader(y,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=$t(Tn,this);sh(Pd,this,ij).call(this,(i,r)=>{const o=n.getCell($t(Tn,this).createCellCoords(i,r)),s=$t(Tn,this).getSetting("onAfterDrawSelection",i,r,$t(tr,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,i]=$t(tr,this).getCorners(),{wtTable:r}=$t(Tn,this);sh(Pd,this,k_).call(this,(o,s)=>{if(o>=n&&o<=i){const a=r.getCell($t(Tn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=$t(tr,this).getCorners(),{wtTable:r}=$t(Tn,this);sh(Pd,this,k_).call(this,(o,s)=>{if(s>=n&&s<=i){const a=r.getCell($t(Tn,this).createCellCoords(o,s));e(a)}})}}function ij(t){let[e,n,i,r]=$t(tr,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=$t(Tn,this),s=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const a=o.getCell($t(Tn,this).createCellCoords(e,n));if(!zo(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function k_(t){const{wtTable:e}=$t(Tn,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let s=0;s<i;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class L_{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=RS(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Cr(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,r.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,r.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),$o()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,i=n.getCSSVariableValue("cell-mobile-handle-size"),r=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Be(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${r}px`,background:`${o}`,border:`${s}px solid ${a}`};Be(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),y=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(i-m-1,10)}px`,u[l]=`${parseInt(r-m-1,10)}px`,c.top=`${parseInt(i-y/4*3,10)}px`,c[l]=`${parseInt(r-y/4*3,10)}px`;const b=Math.min(parseInt(r+o,10),C-m-f*2),$=Math.min(parseInt(r+o-y/4,10),C-y-f*2);h[l]=`${b}px`,d[l]=`${$}px`;const W=Math.min(parseInt(i+s,10),E-m-f*2),F=Math.min(parseInt(i+s-y/4,10),E-y-f*2);h.top=`${W}px`,d.top=`${F}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==r||i!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let m;if(u){if(i=Math.max(i,d),o=Math.min(o,f),n=Math.max(n,c),r=Math.min(r,h),o<i||r<n){this.disappear();return}m=s.getCell(this.wot.createCellCoords(n,i))}else if(m=s.getCell(this.wot.createCellCoords(n,i)),!zo(m)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(r,o)):m,C=xn(m),E=u?xn(y):C,b=xn(s.TABLE),$=C.top,W=C.left,F=this.wot.wtSettings.getSetting("rtlMode");let x=0,A=0;if(F){const Me=Jt(s.TABLE),je=Jt(m),Rt=l.innerWidth-b.left-Me;A=W+je-E.left,x=l.innerWidth-W-je-Rt-1}else A=E.left+Jt(y)-W,x=W-b.left-1;if(this.isEntireColumnSelected(n,r)){const Me=n,je=this.getDimensionsFromHeader("columns",i,o,Me,b);let Rt=null;je&&([Rt,x,A]=je),Rt&&(m=Rt)}let Z=$-b.top-1,K=E.top+an(y)-$;if(this.isEntireRowSelected(i,o)){const Me=i,je=this.getDimensionsFromHeader("rows",n,r,Me,b);let Rt=null;je&&([Rt,Z,K]=je),Rt&&(m=Rt)}const z=l.getComputedStyle(m);parseInt(z.borderTopWidth,10)>0&&(Z+=1,K=K>0?K-1:0),parseInt(z[F?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,A=A>0?A-1:0);const le=F?"right":"left";this.topStyle.top=`${Z}px`,this.topStyle[le]=`${x}px`,this.topStyle.width=`${A}px`,this.topStyle.display="block",this.startStyle.top=`${Z}px`,this.startStyle[le]=`${x}px`,this.startStyle.height=`${K}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Z+K-ne}px`,this.bottomStyle[le]=`${x}px`,this.bottomStyle.width=`${A}px`,this.bottomStyle.display="block",this.endStyle.top=`${Z}px`,this.endStyle[le]=`${x+A-ne}px`,this.endStyle.height=`${K+1}px`,this.endStyle.display="block";let ve=this.settings.border.cornerVisible;ve=typeof ve=="function"?ve(this.settings.layerLevel):ve;const ye=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[Ie,Nt]=[r,o];if(ye&&Array.isArray(ye)&&([,,Ie,Nt]=ye),$o()||!ve||this.isPartRange(Ie,Nt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Z+K+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[le]=`${x+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Me=xh(s.TABLE);const je=Me===l;je&&(Me=a.documentElement);const Rt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,gn=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Sn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const g=je?y.getBoundingClientRect().left:y.offsetLeft;let w=!1,p=0;F?(p=g-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=g+Jt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=Cx(Me)),w&&(this.cornerStyle[le]=`${Math.floor(x+A+this.cornerCenterPointOffset-gn-Rt)}px`,this.cornerStyle[F?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const p=(je?y.getBoundingClientRect().top:y.offsetTop)+an(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=rh(Me),H=this.wot.stylesHandler.isClassicTheme();if(p){const k=Math.floor(Z+K+this.cornerCenterPointOffset-Sn-Rt);H?(this.cornerStyle.top=`${k}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${k-1}px`}}this.cornerStyle.display="block"}$o()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,Z,x,A,K)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return an(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Jt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(m=l(n,C-r),y=l(i,C-r),!m||!y)return!1;const E=xn(m),b=xn(y);return m&&y&&(h=E[f]-o[f]-1,d=b[f]+u(y)-E[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?q(this[e],"hidden"):(Se(this[e],"hidden")&&be(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):be(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",$o()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function rj(t,e){r1(t,e),e.add(t)}function _l(t,e,n){r1(t,e),e.set(t,n)}function r1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(t,e){return t.get(ES(t,e))}function $_(t,e,n){return t.set(ES(t,e),n),n}function ES(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,ei=new WeakMap,kv=new WeakMap,Kc=new WeakMap,Lv=new WeakMap,ea=new WeakMap,F_=new WeakSet;class oj{constructor(e){rj(this,F_),_l(this,Mn,void 0),_l(this,ei,void 0),_l(this,kv,new nj),_l(this,Kc,new WeakMap),_l(this,Lv,new WeakSet),_l(this,ea,new Map),$_(ei,this,e)}setActiveOverlay(e){return $_(Mn,this,e),Fe(kv,this).setActiveOverlay(Fe(Mn,this)),Fe(Kc,this).has(Fe(Mn,this))||Fe(Kc,this).set(Fe(Mn,this),new Set),this}getFocusSelection(){return Fe(ei,this)!==null?Fe(ei,this).getFocus():null}getAreaSelection(){return Fe(ei,this)!==null?Fe(ei,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Fe(ea,this).has(e)){const i=Fe(ea,this).get(e);if(i.has(Fe(Mn,this)))return i.get(Fe(Mn,this));const r=new L_(Fe(Mn,this),e.settings);return i.set(Fe(Mn,this),r),r}const n=new L_(Fe(Mn,this),e.settings);return Fe(ea,this).set(e,new Map([[Fe(Mn,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=Fe(ea,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Fe(ea,this).get(e).forEach(n=>n.destroy()),Fe(ea,this).delete(e)}render(e){if(Fe(ei,this)===null)return;e&&ES(F_,this,sj).call(this);const n=Array.from(Fe(ei,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Fe(Lv,this).has(s)||(Fe(Lv,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Fe(kv,this).setActiveSelection(s).scan().forEach(m=>{if(i.has(m)){const y=i.get(m);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else i.set(m,new Map([[a,1]]));l&&(r.has(m)||r.set(m,[]),m.nodeName==="TH"&&r.get(m).push(...l))});const d=s.getCorners();Fe(Mn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Fe(Kc,this).get(Fe(Mn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Fe(ei,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ee(s,Fe(ei,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{Ee(o,[...r.get(o)])})}}function sj(){const t=Fe(Kc,this).get(Fe(Mn,this)),e=Fe(Mn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=Fe(Mn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((i=Fe(ei,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=Fe(ei,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=Fe(ei,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...Fe(ei,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)be(o[a],n),Vu(o[a],s)}),t.clear()}class aj extends id{constructor(e,n,i,r){super(e,n,il,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new yS(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),aS(i,`${o}px`,"0px")):(o=this.getScrollPosition(),Dm(i));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,wx(n)),i=o!==n.scrollX}else if(e!==r.scrollLeft){const o=r.scrollLeft;r.scrollLeft=e,i=o!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=vn(i)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Jt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=RS(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&r.length>0&&!Se(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=vn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,vF(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(vx(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=r-o;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?be(i,"emptyRows"):q(i,"emptyRows");let l=!1;if(!a){if(o&&!r.length)q(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const u=Se(i,"innerBorderInlineStart");e?(q(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(be(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const lj="stickyRowsTop",_S={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jo(_S,"MIXIN_NAME",lj,{writable:!1,enumerable:!1});class TS extends Bu{constructor(e,n,i,r){super(e,n,i,r,rl)}}wt(TS,_S);wt(TS,Fm);function V_(t,e,n){return(e=uj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uj(t){var e=cj(t,"string");return typeof e=="symbol"?e:e+""}function cj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hj extends id{constructor(e,n,i,r,o,s){super(e,n,rl,i,r),V_(this,"topOverlay",void 0),V_(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new TS(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();aS(e,`${r}px`,`${o}px`)}else Dm(e);let n=an(this.clone.wtTable.TABLE);const i=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class MS extends Bu{constructor(e,n,i,r){super(e,n,i,r,nl)}}wt(MS,_S);wt(MS,Vm);function dj(t,e,n){return(e=fj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fj(t){var e=gj(t,"string");return typeof e=="symbol"?e:e+""}function gj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mj extends id{constructor(e,n,i,r){super(e,n,nl,i,r),dj(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new MS(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,r=this.getOverlayOffset(),aS(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Dm(e);const s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(oS(n),e),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wot.stylesHandler.getDefaultRowHeight();let r=e,o=0;for(;r<n;){const s=this.wot.wtTable.getRowHeight(r);o+=s===void 0?i:s,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=vn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=an(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=RS(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!Se(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=vn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,wF(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return sS(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";o?be(r,"emptyColumns"):q(r,"emptyColumns");let a=!1;if(!n&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Se(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(q(r,"innerBorderTop"),a=!h):(be(r,"innerBorderTop"),a=h)}}return a}}function Id(t,e,n){pj(t,e),e.set(t,n)}function pj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ho(t,e,n){return(e=wj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wj(t){var e=vj(t,"string");return typeof e=="symbol"?e:e+""}function vj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ta(t,e,n){return t.set(o1(t,e),n),n}function fo(t,e){return t.get(o1(t,e))}function o1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tl=new WeakMap,xd=new WeakMap,Ml=new WeakMap,Od=new WeakMap;class Cj{constructor(e,n,i,r,o,s){ho(this,"wot",null),Id(this,Tl,[]),ho(this,"topOverlay",null),ho(this,"bottomOverlay",null),ho(this,"inlineStartOverlay",null),ho(this,"topInlineStartCornerOverlay",null),ho(this,"bottomInlineStartCornerOverlay",null),ho(this,"browserLineHeight",void 0),ho(this,"wtSettings",null),Id(this,xd,!1),Id(this,Ml,0),Id(this,Od,null),ho(this,"resizeObserver",new ResizeObserver(c=>{xg(()=>{!Array.isArray(c)||!c.length||(ta(Ml,this,fo(Ml,this)+1),fo(Ml,this)===100&&(it("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),fo(Od,this)!==null&&clearTimeout(fo(Od,this)),ta(Od,this,setTimeout(()=>{ta(Ml,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=vn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Pg(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...fo(Tl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new mj(...e),this.bottomOverlay=new GB(...e),this.inlineStartOverlay=new aj(...e),this.topInlineStartCornerOverlay=new hj(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BB(...e,this.bottomOverlay,this.inlineStartOverlay),ta(Tl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ta(xd,this,fo(Tl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),fo(Tl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),fo(Tl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Ix())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{xg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ta(Ml,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==i&&s!==i&&!s.contains(o),l=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ed(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!fo(xd,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),ta(xd,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Pg(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),y=f()?1:0,C=m()?1:0;d.width=`${c+C}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return M(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function W_(t,e,n){return(e=yj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yj(t){var e=bj(t,"string");return typeof e=="symbol"?e:e+""}function bj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sj{constructor(e){W_(this,"settings",{}),W_(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Ja(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Be(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class PS extends Bu{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=xh(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=Ig(e,"height",n),o=Ig(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Pu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}wt(PS,CS);wt(PS,Vm);class Rj{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new tW:new aW],["fullyVisible",()=>new zV],["partiallyVisible",()=>new Yx]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new QV:new rW],["fullyVisible",()=>new BV],["partiallyVisible",()=>new zx]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=an(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,i=e.clientWidth,r=n.offsetWidth;return i<r?!0:r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return xn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=an(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=Jt(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=vn(this.domBindings.rootDocument),new mW({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=vn(this.domBindings.rootDocument)),new dW({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<l)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}function Ej(t,e){s1(t,e),e.add(t)}function na(t,e,n){s1(t,e),e.set(t,n)}function s1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(ur(t,e))}function lr(t,e,n){return t.set(ur(t,e),n),n}function ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const B_=23;var Lr=new WeakMap,Ao=new WeakMap,IS=new WeakMap,Yy=new WeakMap,Cs=new WeakMap,qc=new WeakMap,Hh=new WeakMap,Vr=new WeakSet;class _j{constructor(e){Ej(this,Vr),na(this,Lr,void 0),na(this,Ao,void 0),na(this,IS,void 0),na(this,Yy,void 0),na(this,Cs,!0),na(this,qc,{}),na(this,Hh,{}),lr(Ao,this,e.rootTable.parentElement.parentElement),lr(Yy,this,e.rootDocument)}isClassicTheme(){return Mt(Cs,this)}getCSSVariableValue(e){var n;if(Mt(Cs,this))return null;if(Mt(qc,this)[`--ht-${e}`])return Mt(qc,this)[`--ht-${e}`];const i=(n=ur(Vr,this,Ij).call(this,`--ht-${e}`))!==null&&n!==void 0?n:ur(Vr,this,a1).call(this,`--ht-${e}`);if(i!==null)return Mt(qc,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Mt(Hh,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Mt(Cs,this))return B_;const e=ur(Vr,this,Tj).call(this);return!e&&Se(Mt(Ao,this),"ht-wrapper")?(it(`The "${Mt(Lr,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),lr(Cs,this,!0),this.useTheme(),B_):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ur(Vr,this,j_).call(this),lr(Cs,this,!0),lr(Lr,this,e||void 0);return}e&&e!==Mt(Lr,this)&&(Mt(Lr,this)&&ur(Vr,this,xj).call(this),lr(Lr,this,e),lr(Cs,this,!1),ur(Vr,this,Mj).call(this),ur(Vr,this,j_).call(this))}getThemeName(){return Mt(Lr,this)}removeClassNames(){Se(Mt(Ao,this),Mt(Lr,this))&&be(Mt(Ao,this),Mt(Lr,this))}}function Tj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Mj(){be(Mt(Ao,this),/ht-theme-.*/g),q(Mt(Ao,this),Mt(Lr,this))}function j_(){this.isClassicTheme()||lr(IS,this,getComputedStyle(Mt(Ao,this)));const t=ur(Vr,this,Pj).call(this,["box-sizing","border-bottom-width"]);Mt(Hh,this).td={...Mt(Hh,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Pj(t){const e=Mt(Yy,this),n=Mt(Ao,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),r.appendChild(o),r.appendChild(s),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(i),u}function Ij(t){const e=Math.ceil(parseFloat(ur(Vr,this,a1).call(this,t)));return Number.isNaN(e)?null:e}function a1(t){const e=Mt(IS,this).getPropertyValue(t);return e===""?null:e}function xj(){lr(Hh,this,{}),lr(qc,this,{}),lr(Cs,this,!0)}class Oj extends wS{constructor(e,n){super(e,new Sj(n)),this.stylesHandler=new _j(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new PS(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new Rj(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new oj(this.wtSettings.getSetting("selections")),this.wtEvent=new Zx(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Cj(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];Be(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),be(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!e1.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class xS{constructor(e){e instanceof wS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new xS(n);return()=>i},this._wot=new Oj(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function U_(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?o.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!s.row?o.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!o.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!s.column?d&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?d&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?d&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Hj(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(o(u-1,n.col)):s&&!r.row?i.setRangeEnd(o(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const Aj=new Map([["mousedown",U_],["mouseover",Hj],["touchstart",U_]]);function z_(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:o}=e;Aj.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:cS(t)||t.type==="touchstart",isRightClick:el(t)})}const l1=new WeakMap,OS=Symbol("rootInstance");function Nj(t){l1.set(t,!0)}function Dj(t){return t===OS}function og(t){return l1.has(t)}function kj(t,e){u1(t,e),e.add(t)}function os(t,e,n){u1(t,e),e.set(t,n)}function u1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,n){return(e=Lj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lj(t){var e=$j(t,"string");return typeof e=="symbol"?e:e+""}function $j(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zt(t,e){return t.get(Su(t,e))}function Un(t,e,n){return t.set(Su(t,e),n),n}function Su(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $v=new WeakMap,Hd=new WeakMap,Ad=new WeakMap,go=new WeakMap,Xi=new WeakMap,Fv=new WeakMap,Vv=new WeakMap,Pl=new WeakMap,Xc=new WeakSet;class Fj{constructor(e){kj(this,Xc),ss(this,"hot",void 0),ss(this,"eventManager",void 0),ss(this,"settings",void 0),ss(this,"THEAD",void 0),ss(this,"TBODY",void 0),ss(this,"_wt",void 0),ss(this,"activeWt",void 0),os(this,$v,0),os(this,Hd,0),ss(this,"postponedAdjustElementsSize",!1),os(this,Ad,!1),os(this,go,void 0),os(this,Xi,void 0),os(this,Fv,0),os(this,Vv,0),os(this,Pl,null),this.hot=e,this.eventManager=new wr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Su(Xc,this,Wj).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),q(e,"handsontable"),Un(Xi,this,n.createElement("TABLE")),q(Zt(Xi,this),"htCore"),this.hot.getSettings().tableClassName&&q(Zt(Xi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ee(Zt(Xi,this),[Lo()]),Ee(e,[B$(),hx(-1),Am(this.hot.countCols()),nF()])),this.THEAD=n.createElement("THEAD"),Zt(Xi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Zt(Xi,this).appendChild(this.TBODY),this.hot.table=Zt(Xi,this),this.hot.container.insertBefore(Zt(Xi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Un(Ad,this,!0),this.isTextSelectionAllowed(a.target)||(OE(r),a.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Un(Ad,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Zt(Ad,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&OE(r),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{i.isInProgress()&&cS(a)&&i.finish(),Un(go,this,!1);const l=Rx(n.activeElement);rg(n.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!el(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{i.isInProgress()&&el(a)&&(i.finish(),Un(go,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),Un(go,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Zt(go,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=vn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Mu(r);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Mu(s);this.eventManager.addEventListener(Zt(Xi,this),"selectstart",a=>{this.settings.fragmentSelection||rg(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&q(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&be(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zt(Xi,this),isDataViewInstance:()=>og(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Un(Hd,this,o.length),this.hot.getSettings().ariaTags&&Su(Xc,this,c1).call(this)===this.hot.countCols()&&Su(Xc,this,Vj).call(this,Zt(Hd,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Un($v,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,y,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,y,f),this.hot.runHooks("afterRenderer",a,l,u,m,y,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Pu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Un(go,this,!0),Un(Pl,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Fa(o)&&(z_(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Un(go,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Fa(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Fa(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Fa(o)&&(Zt(go,this)&&(!Zt(Pl,this)||Zt(Pl,this).x!==o.clientX||Zt(Pl,this).y!==o.clientY)&&z_(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Un(Pl,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Fa(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,y,C,E]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new xS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(rg(e))return!0;const n=qa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Zt(go,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!Se(i,"relative")){Go(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Se(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,r),s.className="",q(s,["relative",...o()])):(Go(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ee(a,...Lo()),Ee(l,...Lo())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Se(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Se(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Wu(e,i(n,r)):(Ja(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){Un(Fv,this,e),Un(Vv,this,n)}getLastSize(){return{width:Zt(Fv,this),height:Zt(Vv,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zt($v,this)}getRowHeadersCount(){return Zt(Hd,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function c1(){return parseInt(this.hot.rootElement.getAttribute(Am()[0]),10)}function Vj(t){const e=Su(Xc,this,c1).call(this)+t;Ee(this.hot.rootElement,...Am(e))}function Wj(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):be(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):be(t,"htHasScrollX")}var Y_={},G_={},K_;function Bj(){if(K_)return G_;K_=1;var t=yt(),e=Ri(),n=ku(),i=to(),r=ji(),o=io(),s=Ui(),a=js(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){r(this);try{i(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,m){if(!c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),G_}var q_;function jj(){return q_||(q_=1,Bj()),Y_}jj();const Uj="ABCDEFGHIJKLMNOPQRSTUVWXYZ",X_=Uj.length;function zj(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%X_,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/X_,10);return n}function h1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((s,a)=>{i.push([o+e,a,s])}):Object.keys(r).forEach(s=>{i.push([o+e,s,r[s]])})}),i}function d1(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&We(t[0])&&(e=uS(t[0]))),e}function Yj(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Gj(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function lc(t,e,n){return(e=Kj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kj(t){var e=qj(t,"string");return typeof e=="symbol"?e:e+""}function qj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xj{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];lc(this,"hot",void 0),lc(this,"data",void 0),lc(this,"dataType","array"),lc(this,"colToProp",()=>{}),lc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):pe(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(We(a)||ft(a))if(r?l=[]:l={},!o||r){const c=this.countFirstRowKeys()-1;pe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):s?wv(l,d,f):l[d]=f}})}else Be(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?wv(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=bi(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:wv(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?MF(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=bi(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,s=null,a=null,l=null;e===null||n===null?(r=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return pe(o,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return d1(this.data)}destroy(){this.data=null,this.hot=null}}var Z_={},Q_={},J_;function Zj(){if(J_)return Q_;J_=1;var t=yt(),e=Ri(),n=ku(),i=to(),r=ji(),o=io(),s=Ui(),a=js(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){r(this);try{i(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Q_}var eT;function Qj(){return eT||(eT=1,Zj()),Z_}Qj();function tT(t,e,n){return(e=Jj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jj(t){var e=eU(t,"string");return typeof e=="symbol"?e:e+""}function eU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tT(this,"indexedValues",[]),tT(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ft(this.initValueOrFn)?pe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}wt(pl,bn);function HS(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,s)=>ft(i)?i(o,s):i),...r===void 0?[]:t.slice(r)]}function AS(t,e){return Za(t,(n,i)=>e.includes(i)===!1)}class zs extends pl{insert(e,n){this.indexedValues=HS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=AS(this.indexedValues,e),super.remove(e)}}class Wm extends zs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return si(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function NS(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Ah(t,e){return Za(t,n=>e.includes(n)===!1)}function DS(t,e){return Ge(t,n=>n-e.filter(i=>i<n).length)}function kS(t,e){const n=e[0],i=e.length;return Ge(t,r=>r>=n?r+i:r)}function tU(t,e,n){return(e=nU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nU(t){var e=iU(t,"string");return typeof e=="symbol"?e:e+""}function iU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bm extends pl{constructor(){super(...arguments),tU(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ah(this.orderOfIndexes,[e]),ft(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=HS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=kS(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=AS(this.indexedValues,e),this.orderOfIndexes=Ah(this.orderOfIndexes,e),this.orderOfIndexes=DS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class rd extends zs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return si(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const nT=new Map([["indexesSequence",{getListWithInsertedItems:NS,getListWithRemovedItems:Ah}],["physicallyIndexed",{getListWithInsertedItems:HS,getListWithRemovedItems:AS}]]),f1=t=>{if(nT.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return nT.get(t)};class g1 extends pl{constructor(){super(e=>e)}insert(e,n){const i=kS(this.indexedValues,n);this.indexedValues=NS(i,e,n),super.insert(e,n)}remove(e){const n=Ah(this.indexedValues,e);this.indexedValues=DS(n,e),super.remove(e)}}const iT=new Map([["hiding",Wm],["index",pl],["linkedPhysicalIndexToValue",Bm],["physicalIndexToValue",zs],["trimming",rd]]);function rU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!iT.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(iT.get(t))(e)}function oU(t,e,n){return(e=sU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sU(t){var e=aU(t,"string");return typeof e=="symbol"?e:e+""}function aU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LS{constructor(){oU(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);de(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ht(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}wt(LS,bn);function Wv(t,e,n){return(e=lU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lU(t){var e=uU(t,"string");return typeof e=="symbol"?e:e+""}function uU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rT extends LS{constructor(e,n){super(),Wv(this,"mergedValuesCache",[]),Wv(this,"aggregationFunction",void 0),Wv(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ge(this.get(),o=>o.getValues()),i=[],r=de(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);i.push(s)}return Ge(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return de(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function cU(t,e,n){hU(t,e),e.set(t,n)}function hU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dU(t,e,n){return t.set(m1(t,e),n),n}function fU(t,e){return t.get(m1(t,e))}function m1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bv=new WeakMap;class p1{constructor(){cU(this,Bv,[])}subscribe(e){return this.addLocalHook("change",e),this._write(fU(Bv,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){dU(Bv,this,e)}}wt(p1,bn);function oT(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function uc(t,e,n){gU(t,e),e.set(t,n)}function gU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e){return t.get(w1(t,e))}function Nd(t,e,n){return t.set(w1(t,e),n),n}function w1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dd=new WeakMap,cc=new WeakMap,kd=new WeakMap,Ld=new WeakMap,$d=new WeakMap;class mU{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};uc(this,Dd,new Set),uc(this,cc,[]),uc(this,kd,[]),uc(this,Ld,!1),uc(this,$d,!1),Nd($d,this,e??!1)}createObserver(){const e=new p1;return xi(Dd,this).add(e),e.addLocalHook("unsubscribe",()=>{xi(Dd,this).delete(e)}),e._writeInitialChanges(oT(xi(cc,this),xi(kd,this))),e}emit(e){let n=xi(kd,this);(!xi(Ld,this)||xi(cc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(xi($d,this)):Nd(cc,this,new Array(e.length).fill(xi($d,this))),xi(Ld,this)||(Nd(Ld,this,!0),n=xi(cc,this)));const i=oT(n,e);xi(Dd,this).forEach(r=>r._write(i)),Nd(kd,this,e)}}function Hn(t,e,n){return(e=pU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pU(t){var e=wU(t,"string");return typeof e=="symbol"?e:e+""}function wU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gy{constructor(){Hn(this,"indexesSequence",new g1),Hn(this,"trimmingMapsCollection",new rT(e=>e.some(n=>n===!0),!1)),Hn(this,"hidingMapsCollection",new rT(e=>e.some(n=>n===!0),!1)),Hn(this,"variousMapsCollection",new LS),Hn(this,"hidingChangesObservable",new mU({initialIndexValue:!1})),Hn(this,"notTrimmedIndexesCache",[]),Hn(this,"notHiddenIndexesCache",[]),Hn(this,"isBatched",!1),Hn(this,"indexesSequenceChanged",!1),Hn(this,"indexesChangeSource",void 0),Hn(this,"trimmedIndexesChanged",!1),Hn(this,"hiddenIndexesChanged",!1),Hn(this,"renderablePhysicalIndexesCache",[]),Hn(this,"fromPhysicalToVisualIndexesCache",new Map),Hn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,rU(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof rd?this.trimmingMapsCollection.register(e,n):n instanceof Wm?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return de(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return de(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return de(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return de(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Ge(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),o=e.length,s=Ah(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<r){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(NS(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=de(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Ge(new Array(n).fill(r),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}wt(Gy,bn);function vU(t,e){return Be(e,(n,i)=>{Ht(t[i])&&(t[i]=n)}),t}function v1(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function C1(t){de(t)&&hS(ut`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function CU(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:yU,getValues:bU}=yr("phraseFormatters");function SU(t,e){yU(t,e)}function RU(){return bU()}SU("pluralize",CU);const y1="ContextMenu:items",He=y1,$S=`${He}.noItems`,jm=`${He}.insertRowAbove`,Um=`${He}.insertRowBelow`,zm=`${He}.insertColumnOnTheLeft`,Ym=`${He}.insertColumnOnTheRight`,Gm=`${He}.removeRow`,Km=`${He}.removeColumn`,qm=`${He}.undo`,Xm=`${He}.redo`,Nh=`${He}.readOnly`,Zm=`${He}.clearColumn`,Qm=`${He}.copy`,Jm=`${He}.copyWithHeaders`,ep=`${He}.copyWithGroupHeaders`,tp=`${He}.copyHeadersOnly`,np=`${He}.cut`,ip=`${He}.freezeColumn`,rp=`${He}.unfreezeColumn`,op=`${He}.mergeCells`,sp=`${He}.unmergeCells`,ap=`${He}.addComment`,lp=`${He}.editComment`,up=`${He}.removeComment`,cp=`${He}.readOnlyComment`,hp=`${He}.align`,dp=`${He}.align.left`,fp=`${He}.align.center`,gp=`${He}.align.right`,mp=`${He}.align.justify`,pp=`${He}.align.top`,wp=`${He}.align.middle`,vp=`${He}.align.bottom`,Cp=`${He}.borders`,yp=`${He}.borders.top`,bp=`${He}.borders.right`,Sp=`${He}.borders.bottom`,Rp=`${He}.borders.left`,Ep=`${He}.borders.remove`,_p=`${He}.nestedHeaders.insertChildRow`,Tp=`${He}.nestedHeaders.detachFromParent`,Mp=`${He}.hideColumn`,Pp=`${He}.showColumn`,Ip=`${He}.hideRow`,xp=`${He}.showRow`,Bn="Filters:",Bt=`${Bn}conditions`,od=`${Bt}.none`,Op=`${Bt}.isEmpty`,Hp=`${Bt}.isNotEmpty`,Ap=`${Bt}.isEqualTo`,Np=`${Bt}.isNotEqualTo`,Dp=`${Bt}.beginsWith`,kp=`${Bt}.endsWith`,Lp=`${Bt}.contains`,$p=`${Bt}.doesNotContain`,EU=`${Bt}.byValue`,Fp=`${Bt}.greaterThan`,Vp=`${Bt}.greaterThanOrEqualTo`,Wp=`${Bt}.lessThan`,Bp=`${Bt}.lessThanOrEqualTo`,jp=`${Bt}.isBetween`,Up=`${Bt}.isNotBetween`,zp=`${Bt}.after`,Yp=`${Bt}.before`,Gp=`${Bt}.today`,Kp=`${Bt}.tomorrow`,qp=`${Bt}.yesterday`,Xp=`${Bn}labels.filterByCondition`,Zp=`${Bn}labels.filterByValue`,Qp=`${Bn}labels.conjunction`,sd=`${Bn}labels.disjunction`,Dh=`${Bn}values.blankCells`,Jp=`${Bn}buttons.selectAll`,ew=`${Bn}buttons.clear`,tw=`${Bn}buttons.ok`,nw=`${Bn}buttons.cancel`,iw=`${Bn}buttons.placeholder.search`,rw=`${Bn}buttons.placeholder.value`,ow=`${Bn}buttons.placeholder.secondValue`,FS="CheckboxRenderer:",VS=`${FS}checked`,WS=`${FS}unchecked`,_U=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:VS,CHECKBOX_RENDERER_NAMESPACE:FS,CHECKBOX_UNCHECKED:WS,CONTEXTMENU_ITEMS_ADD_COMMENT:ap,CONTEXTMENU_ITEMS_ALIGNMENT:hp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:vp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:fp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:mp,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:dp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:wp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:gp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:pp,CONTEXTMENU_ITEMS_BORDERS:Cp,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Sp,CONTEXTMENU_ITEMS_BORDERS_LEFT:Rp,CONTEXTMENU_ITEMS_BORDERS_RIGHT:bp,CONTEXTMENU_ITEMS_BORDERS_TOP:yp,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Zm,CONTEXTMENU_ITEMS_COPY:Qm,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:tp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:ep,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Jm,CONTEXTMENU_ITEMS_CUT:np,CONTEXTMENU_ITEMS_EDIT_COMMENT:lp,CONTEXTMENU_ITEMS_FREEZE_COLUMN:ip,CONTEXTMENU_ITEMS_HIDE_COLUMN:Mp,CONTEXTMENU_ITEMS_HIDE_ROW:Ip,CONTEXTMENU_ITEMS_INSERT_LEFT:zm,CONTEXTMENU_ITEMS_INSERT_RIGHT:Ym,CONTEXTMENU_ITEMS_MERGE_CELLS:op,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Tp,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:_p,CONTEXTMENU_ITEMS_NO_ITEMS:$S,CONTEXTMENU_ITEMS_READ_ONLY:Nh,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:cp,CONTEXTMENU_ITEMS_REDO:Xm,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Ep,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Km,CONTEXTMENU_ITEMS_REMOVE_COMMENT:up,CONTEXTMENU_ITEMS_REMOVE_ROW:Gm,CONTEXTMENU_ITEMS_ROW_ABOVE:jm,CONTEXTMENU_ITEMS_ROW_BELOW:Um,CONTEXTMENU_ITEMS_SHOW_COLUMN:Pp,CONTEXTMENU_ITEMS_SHOW_ROW:xp,CONTEXTMENU_ITEMS_UNDO:qm,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:rp,CONTEXTMENU_ITEMS_UNMERGE_CELLS:sp,CONTEXT_MENU_ITEMS_NAMESPACE:y1,FILTERS_BUTTONS_CANCEL:nw,FILTERS_BUTTONS_CLEAR:ew,FILTERS_BUTTONS_OK:tw,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:iw,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:ow,FILTERS_BUTTONS_PLACEHOLDER_VALUE:rw,FILTERS_BUTTONS_SELECT_ALL:Jp,FILTERS_CONDITIONS_AFTER:zp,FILTERS_CONDITIONS_BEFORE:Yp,FILTERS_CONDITIONS_BEGINS_WITH:Dp,FILTERS_CONDITIONS_BETWEEN:jp,FILTERS_CONDITIONS_BY_VALUE:EU,FILTERS_CONDITIONS_CONTAINS:Lp,FILTERS_CONDITIONS_EMPTY:Op,FILTERS_CONDITIONS_ENDS_WITH:kp,FILTERS_CONDITIONS_EQUAL:Ap,FILTERS_CONDITIONS_GREATER_THAN:Fp,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Vp,FILTERS_CONDITIONS_LESS_THAN:Wp,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Bp,FILTERS_CONDITIONS_NAMESPACE:Bt,FILTERS_CONDITIONS_NONE:od,FILTERS_CONDITIONS_NOT_BETWEEN:Up,FILTERS_CONDITIONS_NOT_CONTAIN:$p,FILTERS_CONDITIONS_NOT_EMPTY:Hp,FILTERS_CONDITIONS_NOT_EQUAL:Np,FILTERS_CONDITIONS_TODAY:Gp,FILTERS_CONDITIONS_TOMORROW:Kp,FILTERS_CONDITIONS_YESTERDAY:qp,FILTERS_DIVS_FILTER_BY_CONDITION:Xp,FILTERS_DIVS_FILTER_BY_VALUE:Zp,FILTERS_LABELS_CONJUNCTION:Qp,FILTERS_LABELS_DISJUNCTION:sd,FILTERS_NAMESPACE:Bn,FILTERS_VALUES_BLANK_CELLS:Dh},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const b1={languageCode:"en-US",[$S]:"No available options",[jm]:"Insert row above",[Um]:"Insert row below",[zm]:"Insert column left",[Ym]:"Insert column right",[Gm]:["Remove row","Remove rows"],[Km]:["Remove column","Remove columns"],[qm]:"Undo",[Xm]:"Redo",[Nh]:"Read only",[Zm]:"Clear column",[hp]:"Alignment",[dp]:"Left",[fp]:"Center",[gp]:"Right",[mp]:"Justify",[pp]:"Top",[wp]:"Middle",[vp]:"Bottom",[ip]:"Freeze column",[rp]:"Unfreeze column",[Cp]:"Borders",[yp]:"Top",[bp]:"Right",[Sp]:"Bottom",[Rp]:"Left",[Ep]:"Remove border(s)",[ap]:"Add comment",[lp]:"Edit comment",[up]:"Delete comment",[cp]:"Read-only comment",[op]:"Merge cells",[sp]:"Unmerge cells",[Qm]:"Copy",[Jm]:["Copy with header","Copy with headers"],[ep]:["Copy with group header","Copy with group headers"],[tp]:["Copy header only","Copy headers only"],[np]:"Cut",[_p]:"Insert child row",[Tp]:"Detach from parent",[Mp]:["Hide column","Hide columns"],[Pp]:["Show column","Show columns"],[Ip]:["Hide row","Hide rows"],[xp]:["Show row","Show rows"],[od]:"None",[Op]:"Is empty",[Hp]:"Is not empty",[Ap]:"Is equal to",[Np]:"Is not equal to",[Dp]:"Begins with",[kp]:"Ends with",[Lp]:"Contains",[$p]:"Does not contain",[Fp]:"Greater than",[Vp]:"Greater than or equal to",[Wp]:"Less than",[Bp]:"Less than or equal to",[jp]:"Is between",[Up]:"Is not between",[zp]:"After",[Yp]:"Before",[Gp]:"Today",[Kp]:"Tomorrow",[qp]:"Yesterday",[Dh]:"Blank cells",[Xp]:"Filter by condition",[Zp]:"Filter by value",[Qp]:"And",[sd]:"Or",[Jp]:"Select all",[ew]:"Clear",[tw]:"OK",[nw]:"Cancel",[iw]:"Search",[rw]:"Value",[ow]:"Second value",[VS]:"Checked",[WS]:"Unchecked"},TU=_U,Ky=b1.languageCode,{register:MU,getItem:S1,hasItem:PU,getValues:IU}=yr("languagesDictionaries");BS(b1);function BS(t,e){let n=t,i=e;return We(t)&&(i=t,n=i.languageCode),xU(n,i),MU(n,Wn(i)),Wn(i)}function xU(t,e){t!==Ky&&vU(e,S1(Ky))}function R1(t){return jS(t)?Wn(S1(t)):null}function jS(t){return PU(t)}function OU(){return IU()}function E1(t,e,n){const i=R1(t);if(i===null)return null;const r=i[e];if(Ht(r))return null;const o=HU(r,n);return Array.isArray(o)?o[0]:o}function HU(t,e){let n=t;return M(RU(),i=>{n=i(t,e)}),n}function AU(t){let e=v1(t);return jS(e)||(e=Ky,C1(t)),e}function NU(t,e,n){return(e=DU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DU(t){var e=kU(t,"string");return typeof e=="symbol"?e:e+""}function kU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class es extends t1{constructor(e,n){super(e,null),NU(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,i,r)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function jv(t){let{activeHeaderClassName:e,...n}=t;return new es({className:e,...n,selectionType:n1})}function LU(t){let{areaCornerVisible:e,...n}=t;return new es({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:SS})}function $U(t){let{...e}=t;return new es({className:"highlight",...e,selectionType:SS})}function FU(t){let{columnClassName:e,...n}=t;return new es({className:e,...n,selectionType:QB})}function VU(t){let{cellCornerVisible:e,...n}=t;return new es({className:"current",headerAttributes:[rS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:oh})}function WU(t){let{border:e,visualCellRange:n,...i}=t;return new es({...e,...i,selectionType:JB},n)}function BU(t){let{...e}=t;return new es({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:XB})}function sT(t){let{headerClassName:e,...n}=t;return new es({className:e,...n,selectionType:bS})}function jU(t){let{rowClassName:e,...n}=t;return new es({className:e,...n,selectionType:ZB})}function UU(t,e){zU(t,e),e.add(t)}function zU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e,n){return(e=YU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YU(t){var e=GU(t,"string");return typeof e=="symbol"?e:e+""}function GU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _r=new WeakSet;class KU{constructor(e){UU(this,_r),zn(this,"options",void 0),zn(this,"layerLevel",0),zn(this,"focus",void 0),zn(this,"fill",void 0),zn(this,"layeredAreas",new Map),zn(this,"areas",new Map),zn(this,"rowHeaders",new Map),zn(this,"columnHeaders",new Map),zn(this,"activeRowHeaders",new Map),zn(this,"activeColumnHeaders",new Map),zn(this,"activeCornerHeaders",new Map),zn(this,"rowHighlights",new Map),zn(this,"columnHighlights",new Map),zn(this,"customSelections",[]),this.options=e,this.focus=VU(e),this.fill=BU(e)}isEnabledFor(e,n){let i=e;e===oh&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return mo(_r,this,po).call(this,this.layeredAreas,LU)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return mo(_r,this,po).call(this,this.areas,$U)}getAreas(){return[...this.areas.values()]}createRowHeader(){return mo(_r,this,po).call(this,this.rowHeaders,sT)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return mo(_r,this,po).call(this,this.columnHeaders,sT)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return mo(_r,this,po).call(this,this.activeRowHeaders,jv)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return mo(_r,this,po).call(this,this.activeColumnHeaders,jv)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return mo(_r,this,po).call(this,this.activeCornerHeaders,jv)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return mo(_r,this,po).call(this,this.rowHighlights,jU)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return mo(_r,this,po).call(this,this.columnHighlights,FU)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(WU({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function po(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function aT(t,e,n){return(e=qU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qU(t){var e=XU(t,"string");return typeof e=="symbol"?e:e+""}function XU(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZU{constructor(e){aT(this,"ranges",[]),aT(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function QU(t,e){_1(t,e),e.add(t)}function Uv(t,e,n){_1(t,e),e.set(t,n)}function _1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(nn(t,e))}function Fd(t,e,n){return t.set(nn(t,e),n),n}function nn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vd=new WeakMap,St=new WeakMap,dr=new WeakMap,hn=new WeakSet;class qy{constructor(e,n){QU(this,hn),Uv(this,Vd,void 0),Uv(this,St,void 0),Uv(this,dr,{x:0,y:0}),Fd(Vd,this,e),Fd(St,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=Je(St,this).createCellCoords(e,n);let o=Je(Vd,this).current().highlight;const s=Je(St,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){const{width:u,height:c}=nn(hn,this,T1).call(this),{row:h,col:d}=nn(hn,this,uT).call(this,o),f=Je(St,this).fixedRowsBottom(),m=Je(St,this).minSpareRows(),y=Je(St,this).minSpareCols(),C=Je(St,this).autoWrapRow(),E=Je(St,this).autoWrapCol(),b=Je(St,this).createCellCoords(h+r.row,d+r.col);if(b.row>=c){const F=bi(i&&m>0&&f===0),x=b.col+1,A=Je(St,this).createCellCoords(b.row-c,x>=u?x-u:x);this.runLocalHooks("beforeColumnWrap",F,nn(hn,this,Il).call(this,A),x>=u),F.value?this.runLocalHooks("insertRowRequire",Je(St,this).countRenderableRows()):E&&b.assign(A)}else if(b.row<0){const F=bi(E),x=b.col-1,A=Je(St,this).createCellCoords(c+b.row,x<0?u+x:x);this.runLocalHooks("beforeColumnWrap",F,nn(hn,this,Il).call(this,A),x<0),E&&b.assign(A)}if(b.col>=u){const F=bi(i&&y>0),x=b.row+1,A=Je(St,this).createCellCoords(x>=c?x-c:x,b.col-u);this.runLocalHooks("beforeRowWrap",F,nn(hn,this,Il).call(this,A),x>=c),F.value?this.runLocalHooks("insertColRequire",Je(St,this).countRenderableColumns()):C&&b.assign(A)}else if(b.col<0){const F=bi(C),x=b.row-1,A=Je(St,this).createCellCoords(x<0?c+x:x,u+b.col);this.runLocalHooks("beforeRowWrap",F,nn(hn,this,Il).call(this,A),x<0),C&&b.assign(A)}const{rowDir:$,colDir:W}=nn(hn,this,lT).call(this,b);a=$,l=W,o=nn(hn,this,Il).call(this,b)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const i=Je(St,this).createCellCoords(e,n),r=Je(Vd,this).current(),o=Je(St,this).visualToRenderableCoords(r.highlight),s=nn(hn,this,zv).call(this,r.to.row,r.from.row),a=nn(hn,this,Yv).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=nn(hn,this,uT).call(this,r.highlight),f=Je(St,this).createCellCoords(s+i.row,a+i.col),m=r.getTopStartCorner(),y=r.getTopEndCorner(),C=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const W=f.col-d;f.col=nn(hn,this,Yv).call(this,m.col,y.col)+W}else if(i.col>0&&a<=d&&f.col>d){const W=nn(hn,this,Yv).call(this,y.col,m.col),F=Math.max(f.col-W,1);f.col=W+F}if(i.row<0&&s>=h&&f.row<h){const W=f.row-h;f.row=nn(hn,this,zv).call(this,m.row,C.row)+W}else if(i.row>0&&s<=h&&f.row>h){const W=nn(hn,this,zv).call(this,C.row,m.row),F=Math.max(f.row-W,1);f.row=W+F}const{rowDir:E,colDir:b}=nn(hn,this,lT).call(this,f);u=E,c=b;const $=nn(hn,this,Il).call(this,f);i.row===0&&i.col!==0?l.col=$.col:i.row!==0&&i.col===0?l.row=$.row:(l.row=$.row,l.col=$.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:i}=e;Fd(dr,this,{x:n,y:i})}resetOffsetSize(){Fd(dr,this,{x:0,y:0})}}function lT(t){const{width:e,height:n}=nn(hn,this,T1).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function T1(){return{width:Je(dr,this).x+Je(St,this).countRenderableColumns(),height:Je(dr,this).y+Je(St,this).countRenderableRows()}}function zv(t,e){const n=Je(St,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Je(dr,this).y+n}function Yv(t,e){const n=Je(St,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Je(dr,this).x+n}function uT(t){const{row:e,col:n}=Je(St,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Je(St,this).createCellCoords(Je(dr,this).y+e,Je(dr,this).x+n)}function Il(t){const e=t.clone();return e.col=t.col-Je(dr,this).x,e.row=t.row-Je(dr,this).y,Je(St,this).renderableToVisualCoords(e)}wt(qy,bn);const sw=0,aw=1,M1=2,US=3,JU=[US,M1],ez=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Gv=Symbol("root"),cT=Symbol("child");function xu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gv;if(e!==Gv&&e!==cT)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===Gv;let r=sw;if(n){const o=t[0];t.length===0?r=aw:i&&o instanceof td?r=US:i&&Array.isArray(o)?r=xu(o,cT):t.length>=2&&t.length<=4&&!t.some((a,l)=>!ez[l].includes(typeof a))&&(r=M1)}return r}function kh(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!JU.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===US;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),Ht(u)&&(u=a),Ht(c)&&(c=l),!i){const f=a,m=l,y=u,C=c;a=Math.min(f,y),l=Math.min(m,C),u=Math.max(f,y),c=Math.max(m,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function tz(t){const e=xu(t.getSelected());if(e===sw||e===aw)return[];const n=kh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return si(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function nz(t){const e=xu(t.getSelected());if(e===sw||e===aw)return[];const n=kh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return si(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function xl(t,e,n){iz(t,e),e.set(t,n)}function iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ia(t,e,n){return(e=rz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rz(t){var e=oz(t,"string");return typeof e=="symbol"?e:e+""}function oz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Et(t,e){return t.get(P1(t,e))}function Tr(t,e,n){return t.set(P1(t,e),n),n}function P1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rn=new WeakMap,ra=new WeakMap,Wd=new WeakMap,hc=new WeakMap,Bd=new WeakMap,dc=new WeakMap;class I1{constructor(e,n){var i=this;ia(this,"settings",void 0),ia(this,"tableProps",void 0),ia(this,"inProgress",!1),ia(this,"selectedRange",new ZU((r,o,s)=>this.tableProps.createCellRange(r,o,s))),ia(this,"highlight",void 0),xl(this,Rn,void 0),xl(this,ra,void 0),ia(this,"selectedByRowHeader",new Set),ia(this,"selectedByColumnHeader",new Set),xl(this,Wd,!1),xl(this,hc,!1),xl(this,Bd,"unknown"),xl(this,dc,-1),this.settings=e,this.tableProps=n,this.highlight=new KU({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[rS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,s)=>this.tableProps.createCellRange(r,o,s)}),Tr(Rn,this,new qy(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Tr(ra,this,new qy(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Et(Rn,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...o)}),Et(Rn,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...o)}),Et(Rn,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),Et(Rn,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...o)}),Et(Rn,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...o)}),Et(Rn,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertColRequire",...o)}),Et(Rn,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...o)}),Et(Rn,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...o)}),Et(ra,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),Et(ra,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Tr(Bd,this,e)}markEndSource(){Tr(Bd,this,"unknown")}getSelectionSource(){return Et(Bd,this)}setExpectedLayers(e){Tr(dc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Tr(dc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ht(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Tr(Wd,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!o||o&&!s&&Ht(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!o||r===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Et(dc,this)===-1||this.selectedRange.size()===Et(dc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),m=>void m.clear()),M(this.highlight.getLayeredAreas(),m=>void m.clear()),M(this.highlight.getRowHeaders(),m=>void m.clear()),M(this.highlight.getColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveRowHeaders(),m=>void m.clear()),M(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),M(this.highlight.getRowHighlights(),m=>void m.clear()),M(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(SS,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(bS,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),$=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(b).commit(),d.add(C).commit(),f.add(b).commit()):(a.add(C).add(E).commit(),l.add(b).add($).commit(),d.add(C).add(E).commit(),f.add(b).add($).commit())}const m=!Et(hc,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),y=!Et(hc,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(oh,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(Tr(Wd,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Et(Rn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Et(Rn,this).resetOffsetSize(),this.setRangeStart(Et(Rn,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?Et(Rn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Et(Rn,this).resetOffsetSize(),this.setRangeEnd(Et(Rn,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?Et(ra,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:r<0?Math.abs(r):-a}):Et(ra,this).setOffsetSize({x:o<0?0:-s,y:r<0?0:-a});const l=Et(ra,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Xe(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(Xe(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Xe(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,Xe(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Xe(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Xe(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=bi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Et(Wd,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;Tr(hc,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Xe(d.row,u,o-1),Xe(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),Tr(hc,this,!1)}selectCells(e){var n=this;const i=xu(e);if(i===aw)return!1;if(i===sw)throw new Error(ut`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=kh(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(f=Xe(i.row,u,s-1),m=Xe(i.col,Math.min(r,o),Math.max(r,o))):(f=Xe(i,u,s-1),m=r);const y=this.tableProps.createCellCoords(f,m),C=l===0?0:Xe(y.row,u,-1),E=s-1,b=this.tableProps.createCellCoords(C,r),$=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",b,$,y),b.row=C,$.row=E,this.setRangeStartOnly(b,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd($),this.runLocalHooks("afterSelectColumns",b,$,y),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=Xe(i.row,Math.min(e,n),Math.max(e,n)),d=Xe(i.col,a,o-1)):(h=e,d=Xe(i,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:Xe(f.col,a,-1),y=o-1,C=this.tableProps.createCellCoords(e,m),E=this.tableProps.createCellCoords(n,y);this.runLocalHooks("beforeSelectRows",C,E,f),C.col=m,E.col=y,this.setRangeStartOnly(C,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",C,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:o,highlight:s}=i;this.clear(),s.assign({row:Xe(s.row,-1/0,e-1),col:Xe(s.col,-1/0,n-1)}),r.assign({row:Xe(r.row,-1/0,e-1),col:Xe(r.col,-1/0,n-1)}),o.assign({row:Xe(o.row,0,e-1),col:Xe(o.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.isEnabledFor(oh,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(oh,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}wt(I1,bn);const hT=/^(\r\n|\n\r|\r|\n)/,sz=/^[^\t\r\n]+/,dT=/^\t/;function az(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(dT))t=t.replace(dT,""),n+=1,e[i][n]="";else if(t.match(hT))t=t.replace(hT,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(sz);o=s?s[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function ah(t){let e,n,i,r,o="",s;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),s=t[e][i],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function oa(t,e,n){return(e=lz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lz(t){var e=uz(t,"string");return typeof e=="symbol"?e:e+""}function uz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){oa(this,"hot",void 0),oa(this,"metaManager",void 0),oa(this,"tableMeta",void 0),oa(this,"dataSource",void 0),oa(this,"duckSchema",void 0),oa(this,"colToPropCache",void 0),oa(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,s=!1;if(typeof n=="function"){const a=uS(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=s?n(i):n[i];if(We(a)){if(typeof a.data<"u"){const l=s?o:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return d1(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,s;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&de(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(de(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Oh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Wn(this.getSchema()):(m=[],pe(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Lm(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,i)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;r==="end"&&(m=Math.min(m+1,a));const y=m;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(y,n));const C=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",C,f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:y}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const l=o.length;if(this.filterData(r,l,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=de(this.tableMeta.columns)||de(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,o,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bE(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return D$(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bE(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&sn(r,n))a=r[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=r;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=bi(a);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=bi(o);this.hot.runHooks("modifyData",r,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&sn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,s=n,a;for(;o<i&&s;)a=this.hot.toPhysicalRow(o),r.push(a),s-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,s=n;for(;o<i&&s;){const a=this.hot.toPhysicalColumn(o);r.push(a),s-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,fu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===fu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&r.push(a)}return r}getText(e,n){return ah(this.getRange(e,n,fu.DESTINATION_RENDERER))}getCopyableText(e,n){return ah(this.getRange(e,n,fu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:cz,getItem:hz,hasItem:x1,getNames:Rie,getValues:Eie}=yr("cellTypes");function dz(t){if(!x1(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return hz(t)}function nr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&gi(t,n),i&&Oi(t,i),r&&ou(t,r),cz(t,e)}function fz(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!sn(e,t)}function lw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?dz(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Be(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!We(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};Be(i,(o,s)=>{if(fz(s,n)){var a;r[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),ln(t,r)}function gz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}TF(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function sg(t){return Number.isInteger(t)&&t>=0}function ag(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function jd(t){return t==null}const O1=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),qt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),qt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),lS(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function fT(t,e,n){return(e=mz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mz(t){var e=pz(t,"string");return typeof e=="symbol"?e:e+""}function pz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wz(){return class{}}class vz{constructor(e){fT(this,"metaCtor",wz()),fT(this,"meta",void 0),this.meta=this.metaCtor.prototype,ln(this.meta,O1()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;ln(this.meta,e),lw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Cz(t,e,n){return(e=yz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yz(t){var e=bz(t,"string");return typeof e=="symbol"?e:e+""}function bz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sz{constructor(e){Cz(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){ln(this.meta,e),lw(this.meta,e,e)}}function Ud(t,e,n){return(e=Rz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:e+""}function Ez(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ng{constructor(e){Ud(this,"valueFactory",void 0),Ud(this,"data",[]),Ud(this,"index",[]),Ud(this,"holes",new Set),this.valueFactory=e}obtain(e){ag(()=>sg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ag(()=>sg(e)||jd(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let s=0;s<n;s++)i.push(r+s),this.data.push(void 0);const o=jd(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ag(()=>sg(e)||jd(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(jd(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function gT(t,e,n){return(e=_z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _z(t){var e=Tz(t,"string");return typeof e=="symbol"?e:e+""}function Tz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mz=["data","width"];class Pz{constructor(e){gT(this,"globalMeta",void 0),gT(this,"metas",new Ng(()=>this._createMeta())),this.globalMeta=e,this.metas=new Ng(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);ln(i,n),lw(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return gz(this.globalMeta.getMetaConstructor(),Mz).prototype}}function mT(t,e,n){return(e=Iz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oz{constructor(e){mT(this,"columnMeta",void 0),mT(this,"metas",new Ng(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);ln(r,i),lw(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)de(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){ag(()=>sg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ng(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class H1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new vz(e),this.tableMeta=new Sz(this.globalMeta),this.columnMeta=new Pz(this.globalMeta),this.cellMeta=new Oz(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}wt(H1,bn);function pT(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=pr(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":ft(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new fu(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let y,C=0,E=0;for(C=0,E=d.startRows;C<E;C++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)y=Wn(m),t.push(y);else if(r.dataType==="array")y=Wn(m[0]),t.push(y);else{y=[];for(let b=0,$=d.startCols;b<$;b++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=r.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&Ee(r.rootElement,[hx(-1),Am(r.countCols()+(r.view?r.countRowHeaders():0))])}function wT(t,e,n){return(e=Hz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hz(t){var e=Az(t,"string");return typeof e=="symbol"?e:e+""}function Az(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nz{constructor(e){var n=this;wT(this,"metaManager",void 0),wT(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),se.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=sn(e,"type")?e.type:null;let c=ft(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function Dz(t,e,n){kz(t,e),e.set(t,n)}function kz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kv(t,e,n){return(e=Lz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lz(t){var e=$z(t,"string");return typeof e=="symbol"?e:e+""}function $z(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fz(t,e){return t.get(Vz(t,e))}function Vz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vT=new WeakMap;class Wz{constructor(e){Kv(this,"metaManager",void 0),Kv(this,"usageTracker",new Set),Kv(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Dz(this,vT,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,s=typeof r=="string",a=s?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(r,l,o)):i&&(this.installPropWatcher(n,l,Fz(vT,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const A1="gridDefault",Ys="editorManager.handlingEditor",Bz={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},jz="hooksRefRegisterer",N1={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Be(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Jo(N1,"MIXIN_NAME",jz,{writable:!1,enumerable:!1});function Zi(t,e,n){return(e=Uz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uz(t){var e=zz(t,"string");return typeof e=="symbol"?e:e+""}function zz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yz="base",Gt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class ju{static get EDITOR_TYPE(){return Yz}constructor(e){Zi(this,"hot",void 0),Zi(this,"state",Gt.VIRGIN),Zi(this,"_opened",!1),Zi(this,"_fullEditMode",!1),Zi(this,"_closeCallback",null),Zi(this,"TD",null),Zi(this,"row",null),Zi(this,"col",null),Zi(this,"prop",null),Zi(this,"originalValue",null),Zi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,s){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Gt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,s;if(n){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[i,r,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Gt.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Gt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:At(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Gt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Gt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Gt.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Gt.FINISHED,this.discardEditor(s)}):(this.state=Gt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Gt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Gt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Gt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Gt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Gt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=xn(n),a=Jt(n),l=xn(this.hot.rootElement),u=Jt(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:y}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=y.name,E=["master","inline_start"].includes(C)?d:0,b=["master","top","bottom"].includes(C)?f:0,$=s.top===l.top?0:1;let W=s.top-l.top-$-E,F=0;this.hot.isRtl()?F=o.innerWidth-s.left-a-m-1+b:F=s.left-l.left-1-b,["top","top_inline_start_corner"].includes(C)&&(W+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(F+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&A<=0||A===z)&&(W+=1),Z<=0&&(F+=1);const le=r.rowsRenderCalculator.startPosition,ne=r.columnsRenderCalculator.startPosition,ve=Math.abs(i.inlineStartOverlay.getScrollPosition()),ye=i.topOverlay.getScrollPosition(),Ie=vn(this.hot.rootDocument);let Nt=n.offsetTop;if(["inline_start","master"].includes(C)&&(Nt+=le-ye),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:G,wtTable:X}=i.bottomOverlay.clone;Nt+=G.getWorkspaceHeight()-X.getHeight()-Ie}let Me=n.offsetLeft;this.hot.isRtl()?(Me>=0?Me=y.getWidth()-n.offsetLeft:Me=Math.abs(Me),Me+=ne-ve-a):["top","master","bottom"].includes(C)&&(Me+=ne-ve);const je=o.getComputedStyle(this.TD),Rt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",gn=parseInt(je[Rt],10)>0?0:1,Sn=parseInt(je.borderTopWidth,10)>0?0:1,g=Jt(n)+gn,w=an(n)+Sn,p=bx(c)?Ie:0,H=Sx(h)?Ie:0,k=this.hot.view.maximumVisibleElementWidth(Me)-p+gn,B=Math.max(this.hot.view.maximumVisibleElementHeight(Nt)-H+Sn,this.hot.view.getDefaultRowHeight());return{top:W,start:F,height:w,maxHeight:B,width:g,maxWidth:k}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}wt(ju,N1);const Gz={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Gt.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Kz={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},qz={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Xz={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Zz={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:o}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Cr(e))}};function Qz(){return[Bz,Gz,Kz,qz,Xz,Zz]}const Jz={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},eY={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(r,-1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},tY={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},nY={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},iY={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},rY={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},oY={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},sY={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},aY={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},lY={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},uY={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},cY={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},hY={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},dY={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.max(i.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(r,1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function fY(){return[Jz,eY,tY,nY,iY,rY,oY,sY,aY,lY,uY,cY,hY,dY]}const gY={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},mY={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+i;o=o===0?1:o,r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},pY={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},wY={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},vY={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},CY={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},yY={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},bY={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},SY={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},RY={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,o)),e.markEndSource()}},EY={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},_Y={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},TY={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},MY={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},PY={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},IY={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+i;o=o===0?-1:-o,r===-i?o=-1:r+o<i&&(o=-(r+i)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function xY(){return[gY,mY,pY,wY,vY,CY,yY,bY,SY,RY,EY,_Y,TY,MY,PY,IY]}const OY={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},HY={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),a=t._createCellCoords(r,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},AY={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},NY={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},DY={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(o.values()))}},kY=[...Qz(),...fY(),...xY(),OY,HY,AY,NY,DY];function D1(t){const e={};return kY.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r(t,...s)}}),e}function LY(t){const e=t.getShortcutManager().addContext("editor"),n=D1(t),i={group:Ys};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function $Y(t){const e=t.getShortcutManager().addContext("grid"),n=D1(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return de(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:A1};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorOpen(r,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ys,runOnlyIf:()=>de(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,o;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function FY(t){[$Y,LY].forEach(e=>e(t))}function VY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=CT(t),r=CT(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function CT(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ee(n,[Ih("Focus catcher")]),n}function WY(t){const e=BY(t);let n;const{activate:i,deactivate:r}=VY(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Xy(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Zy(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(h,d,f,m,y)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,y.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:A1,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?Xy(t):Zy(t)),u(),!1;h.preventDefault()},position:"after"}])}function Xy(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function Zy(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let s=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function BY(t){return e=>{if(!e)return null;const n=Xy(t),i=Zy(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function Uu(t){zo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function uw(t){const{selection:e,view:n}=t,i=t.getSelectedRangeLast(),r=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,m=i.getBottomEndCorner().row,y=f<=h,C=m>=d;return{getComputedColumnTarget(E){return r==="mouse"||r==="keyboard"?E.col:u&&c?i.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return r==="mouse"||r==="keyboard"?E.row:y&&C?i.highlight.row:y?f:C?m:E.row}}}function jY(t){return e=>{const n=uw(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;Uu(t.getCell(i?-1:0,n,!0))})}}function UY(){return()=>{}}function zY(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:i}=t.getSelectedRangeLast().highlight;Uu(t.getCell(n,i,!0))})}}function YY(t){return e=>{const n=uw(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Uu(t.getCell(r,o,!0))})}}function GY(t){return e=>{const n=uw(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Uu(t.getCell(r,o,!0))})}}function KY(t){return e=>{const n=uw(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;Uu(t.getCell(n,i?-1:0,!0))})}}function qY(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,o=()=>{Uu(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},o);else if(r<0&&i>=0)t.scrollViewportTo({row:i},o);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},o)}}}function XY(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let s;e.isFocusSelectionChanged()?s=zY(t):e.isSelectedByCorner()?s=UY():e.isSelectedByRowHeader()?s=KY(t):e.isSelectedByColumnHeader()?s=jY(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=YY(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=qY(t):e.getSelectedRange().size()>1&&(s=GY(t)),(o=s)===null||o===void 0||o(r)}}}const yT=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),zd=t=>t.map(e=>{const n=e.toLowerCase();return yT.has(n)?yT.get(n):n}).sort().join("+"),ZY=t=>t.split("+"),bT=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),qv=t=>{let{which:e,key:n}=t;if(bT.has(e))return bT.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},k1=Symbol("shortcut-context");function L1(t){return We(t)&&t.__kindOf===k1}const QY=t=>{const e=$m({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:y,position:C,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ht(c))throw new Error("You need to define the shortcut's group.");if(ft(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ut`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const b={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};de(y)&&(b.relativeToGroup=y,b.position=C),L1(E)&&(b.forwardToContext=E),l.forEach($=>{const W=zd($);if(e.hasItem(W)){const x=e.getItem(W);let A=x.findIndex(Z=>Z.group===y);A!==-1?C==="before"?A-=1:A+=1:A=x.length,x.splice(A,0,b)}else e.addItem(W,[b])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Be(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},r=l=>{const u=zd(l);e.removeItem(u)};return{__kindOf:k1,addShortcut:n,addShortcuts:i,getShortcuts:l=>{const u=zd(l),c=e.getItem(u);return de(c)?c.slice():[]},hasShortcut:l=>{const u=zd(l);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?r(ZY(h)):(d.length=0,d.push(...f))})}}};function JY(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const e2=["meta","alt","shift","control"],fc=JY(),gc=[];let Yd=0;function t2(t,e,n,i,r){const o=f=>e2.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return f.altKey&&y.push("alt"),m&&(f.ctrlKey||f.metaKey)?y.push("control/meta"):(f.ctrlKey&&y.push("control"),f.metaKey&&y.push("meta")),f.shiftKey&&y.push("shift"),y},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Fa(f))return;const y=qv(f);let C=[];o(y)||(C=s(f));const E=[y].concat(C);!r(f,E)&&(kE()&&C.includes("meta")||!kE()&&C.includes("control"))&&r(f,[y].concat(s(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const m=qv(f);o(m)&&fc.press(m)}},u=f=>{if(typeof f.key=="string"){const m=qv(f);o(m)&&fc.release(m)}},c=()=>{fc.releaseAll()};return{mount:()=>{let f=t;for(Yd+=1;f;)Yd===1&&(f.document.documentElement.addEventListener("keydown",l),gc.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),gc.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Mu(f)},unmount:()=>{let f=t;for(Yd-=1;f;){if(Yd===0){for(let m=0;m<gc.length;m++){const{event:y,listener:C}=gc[m];f.document.documentElement.removeEventListener(y,C)}gc.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Mu(f)}},isPressed:f=>fc.isPressed(f),releasePressedKeys:()=>fc.releaseAll()}}const n2=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=$m({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const y=QY(m);return o.addItem(m,y),y},l=()=>s,u=m=>o.getItem(m),c=m=>{if(!o.hasItem(m))throw new Error(ut`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,y){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=L1(C)?C:u(C);let b=!1;if(!E.hasShortcut(y))return b;const $=E.getShortcuts(y);for(let W=0;W<$.length;W++){const{callback:F,runOnlyIf:x,preventDefault:A,stopPropagation:Z,captureCtrl:K,forwardToContext:z}=$[W];if(x(m)===!0){if(h=K,b=F(m,y)===!1,h=!1,A&&m.preventDefault(),Z&&(Cr(m),m.stopPropagation()),b)break;z&&d(m,y,z)}}return b},f=t2(e,n,i,r,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function ST(t){const{classNames:e}=fF(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Xv=null;const Zv=new Map;function $1(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new wr(o);let a,l,u,c,h,d,f=!0;Dj(r)&&Nj(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",y=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=AU(e.language);const C=Object.fromEntries(Object.entries(e).filter(g=>{let[w]=g;return!(se.getSingleton().isRegistered(w)||se.getSingleton().isDeprecated(w))})),E=new H1(o,C,[Nz,Wz]),b=E.getTableMeta(),$=E.getGlobalMeta(),W=$m();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),og(this)&&(V$(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${ox()}`,Zv.set(this.guid,this),this.columnIndexMapper=new Gy,this.rowIndexMapper=new Gy,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterRowSequenceChange",g)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{o.runHooks("beforeCompositionStart",g)}),l=new Xj(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const F=g=>{const{row:w,col:p}=g;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},x=g=>{const{row:w,col:p}=g;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},A=(g,w)=>{const p=w>g?1:-1,H=Math.min(g,w),k=Math.max(g,w),B=o.rowIndexMapper.getNearestNotHiddenIndex(g,p);return B===null||p===1&&B>k||p===-1&&B<H?null:B>=0?o.rowIndexMapper.getRenderableFromVisualIndex(B):B},Z=(g,w)=>{const p=w>g?1:-1,H=Math.min(g,w),k=Math.max(g,w),B=o.columnIndexMapper.getNearestNotHiddenIndex(g,p);return B===null||p===1&&B>k||p===-1&&B<H?null:B>=0?o.columnIndexMapper.getRenderableFromVisualIndex(B):B};let K=new I1(b,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(g,w)=>o._createCellCoords(g,w),createCellRange:(g,w,p)=>o._createCellRange(g,w,p),visualToRenderableCoords:F,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:A,findFirstNonHiddenRenderableColumn:Z,isDisabledCellSelection:(g,w)=>g<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(g,w).disableVisualSelection});this.selection=K;const z=g=>{let{hiddenIndexesChanged:w}=g;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const p=bi(!1),H=this.selection.getSelectedRange(),{from:k,to:B}=H.current(),G=H.size()-1;this.runHooks("afterSelection",k.row,k.col,B.row,B.col,p,G),this.runHooks("afterSelectionByProp",k.row,o.colToProp(k.col),B.row,o.colToProp(B.col),p,G),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(g);const X=K.isSelectedByRowHeader(),v=K.isSelectedByColumnHeader();X&&v?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):X?(be(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):v?(be(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):be(this.rootElement,["ht__selection--rows","ht__selection--columns"]),K.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=bi(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(g),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:p,to:H}=g[w];this.runHooks("afterSelectionEnd",p.row,p.col,H.row,H.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),H.row,o.colToProp(H.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),be(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),p=0;p<g;p++)w[p]=arguments[p];return i.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0;const B=G=>{if(G.length===0)return[];const X=[...G];return X.sort((R,S)=>{let[O]=R,[P]=S;return O===P?0:O>P?1:-1}),si(X,(R,S)=>{let[O,P]=S;const N=R[R.length-1],[j,T]=N,I=j+T;if(O<=I){const V=Math.max(P-(I-O),0);N[1]+=V}else R.push([O,P]);return R},[X[0]])};switch(g){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(b.maxRows===G)return;const X=g==="insert_row_below"?"below":"above";w=w??(X==="below"?G:0);const{delta:v,startPhysicalIndex:R}=a.createRow(w,p,{source:H,mode:X});K.shiftRows(o.toVisualRow(R),v);break;case"insert_col_start":case"insert_col_end":const S=g==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:O,startPhysicalIndex:P}=a.createCol(w,p,{source:H,mode:S});if(O){if(Array.isArray(b.colHeaders)){const T=[o.toVisualColumn(P),0];T.length+=O,Array.prototype.splice.apply(b.colHeaders,T)}K.shiftColumns(o.toVisualColumn(P),O)}break;case"remove_row":const N=T=>{let I=0;M(T,V=>{let[D,U]=V;const he=qt(D)?o.countRows()-1:Math.max(D-I,0);if(Number.isInteger(D)&&(D=Math.max(D-I,0)),!a.removeRow(D,U,H))return;if(K.isSelected()){const{row:Te}=o.getSelectedRangeLast().highlight;Te>=D&&Te<=D+U-1&&c.closeEditor(!0)}const Pe=o.countRows(),ze=b.fixedRowsTop;ze>=he+1&&(b.fixedRowsTop-=Math.min(U,ze-he));const st=b.fixedRowsBottom;st&&he>=Pe-st&&(b.fixedRowsBottom-=Math.min(U,st)),Pe===0?K.deselect():H==="ContextMenu.removeRow"?K.refresh():K.shiftRows(D,-U),I+=U})};Array.isArray(w)?N(B(w)):N([[w,p]]);break;case"remove_col":const j=T=>{let I=0;M(T,V=>{let[D,U]=V;const he=qt(D)?o.countCols()-1:Math.max(D-I,0);let ce=o.toPhysicalColumn(he);if(Number.isInteger(D)&&(D=Math.max(D-I,0)),!a.removeCol(D,U,H))return;if(K.isSelected()){const{col:Te}=o.getSelectedRangeLast().highlight;Te>=D&&Te<=D+U-1&&c.closeEditor(!0)}o.countCols()===0?K.deselect():H==="ContextMenu.removeColumn"?K.refresh():K.shiftColumns(D,-U);const st=b.fixedColumnsStart;st>=he+1&&(b.fixedColumnsStart-=Math.min(U,st-he)),Array.isArray(b.colHeaders)&&(typeof ce>"u"&&(ce=-1),b.colHeaders.splice(ce,U)),I+=U})};Array.isArray(w)?j(B(w)):j([[w,p]]);break;default:throw new Error(`There is no such action "${g}"`)}k||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const g=b.minRows,w=b.minSpareRows,p=b.minCols,H=b.minSpareCols;if(g){const k=o.countRows();k<g&&a.createRow(k,g-k,{source:"auto"})}if(w){const k=o.countEmptyRows(!0);if(k<w){const B=w-k,G=Math.min(B,b.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let k;(p||H)&&(k=o.countEmptyCols(!0));let B=o.countCols();if(p&&!b.columns&&B<p){const G=p-B;k+=G,a.createCol(B,G,{source:"auto"})}if(H&&!b.columns&&o.dataType==="array"&&k<H){B=o.countCols();const G=H-k,X=Math.min(G,b.maxCols-B);a.createCol(B,X,{source:"auto"})}}},populateFromArray(g,w,p,H,k){let B,G,X,v;const R=[],S={},O=[],P=g.row,N=g.col;if(G=w.length,G===0)return!1;let j=0,T=0;switch(We(p)&&(j=p.col-N+1,T=p.row-P+1),k){case"shift_down":const I=ng(w),V=I.length,D=Math.max(V,j),U=o.getData().slice(P),he=ng(U).slice(N,N+D);for(X=0;X<D;X+=1)if(X<V){for(B=0,G=I[X].length;B<T-G;B+=1)I[X].push(I[X][B%G]);X<he.length?O.push(I[X].concat(he[X])):O.push(I[X].concat(new Array(U.length).fill(null)))}else O.push(I[X%V].concat(he[X]));o.populateFromArray(P,N,ng(O));break;case"shift_right":const ce=w.length,Pe=Math.max(ce,T),ze=o.getData().slice(P).map(jt=>jt.slice(N));for(B=0;B<Pe;B+=1)if(B<ce){for(X=0,v=w[B].length;X<j-v;X+=1)w[B].push(w[B][X%v]);if(B<ze.length)for(let jt=0;jt<ze[B].length;jt+=1)w[B].push(ze[B][jt]);else w[B].push(...new Array(ze[0].length).fill(null))}else w.push(w[B%G].slice(0,Pe).concat(ze[B]));o.populateFromArray(P,N,w);break;case"overwrite":default:S.row=g.row,S.col=g.col;let st=0,Te=0,Ye=!0,xt;const ao=function(_i){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _=w[_i%w.length];return Y!==null?_[Y%_.length]:_},ns=w.length,lo=p?p.row-g.row+1:0;for(p?G=lo:G=Math.max(ns,lo),B=0;B<G&&!(p&&S.row>p.row&&lo>ns||!b.allowInsertRow&&S.row>o.countRows()-1||S.row>=b.maxRows);B++){const jt=B-st,_i=ao(jt).length,Y=p?p.col-g.col+1:0;if(p?v=Y:v=Math.max(_i,Y),S.col=g.col,xt=o.getCellMeta(S.row,S.col),(H==="CopyPaste.paste"||H==="Autofill.fill")&&xt.skipRowOnPaste){st+=1,S.row+=1,G+=1;continue}for(Te=0,X=0;X<v&&!(p&&S.col>p.col&&Y>_i||!b.allowInsertColumn&&S.col>o.countCols()-1||S.col>=b.maxCols);X++){if(xt=o.getCellMeta(S.row,S.col),(H==="CopyPaste.paste"||H==="Autofill.fill")&&xt.skipColumnOnPaste){Te+=1,S.col+=1,v+=1;continue}if(xt.readOnly&&H!=="UndoRedo.undo"){S.col+=1;continue}const _=X-Te;let L=ao(jt,_),J=o.getDataAtCell(S.row,S.col);if(L!==null&&typeof L=="object")if(Array.isArray(L)&&J===null&&(J=[]),J===null||typeof J!="object")Ye=!1;else{const _e=Oh(Array.isArray(J)?J:J[0]||J),ie=Oh(Array.isArray(L)?L:L[0]||L);lS(_e,ie)||Array.isArray(_e)&&Array.isArray(ie)?L=Wn(L):Ye=!1}else J!==null&&typeof J=="object"&&(Ye=!1);Ye&&R.push([S.row,S.col,L]),Ye=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,H||"populateFromArray");break}}};function le(g){const w=v1(g);jS(w)?(o.runHooks("beforeLanguageChange",w),$.language=w,o.runHooks("afterLanguageChange",w)):C1(g)}function ne(g,w){const p=g==="className"?o.rootElement:o.table;if(f)q(p,w);else{let H=[],k=[];$[g]&&(H=Array.isArray($[g])?$[g]:RE($[g])),w&&(k=Array.isArray(w)?w:RE(w));const B=SE(H,k),G=SE(k,H);B.length&&be(p,B),G.length&&q(p,G)}$[g]=w}this.init=function(){l.setData(b.data),o.runHooks("beforeInit"),($o()||Ox())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Fj(this);const g=b.themeName||ST(o.rootElement);o.useTheme(g),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=By.getInstance(o,b,K),d=XY(o),h=new hV(o),og(this)&&WY(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&bF(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ve(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ye(g){const w=g.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):g}function Ie(g,w,p){if(!g.length){p();return}const H=o.getActiveEditor(),k=new ve;let B=!0;k.onQueueEmpty=()=>{H&&B&&H.cancelChanges(),p()};for(let G=g.length-1;G>=0;G--){const[X,v]=g[G],R=a.propToCol(v);let S;Number.isInteger(R)?S=o.getCellMeta(X,R):S={...Object.getPrototypeOf(b),...b},o.getCellValidator(S)&&(k.addValidatorToQueue(),o.validateCell(g[G][3],S,function(O,P){return function(N){if(typeof N!="boolean")throw new Error("Validation error: result is not boolean");N===!1&&P.allowInvalid===!1&&(B=!1,g.splice(O,1),P.valid=!0),k.removeValidatorFormQueue()}}(G,S),w))}k.checkIfQueueIsEmpty()}function Nt(g,w){for(let H=g.length-1;H>=0;H--){let k=!1;if(g[H]===null){g.splice(H,1);continue}if(!((g[H][2]===null||g[H][2]===void 0)&&(g[H][3]===null||g[H][3]===void 0))){if(b.allowInsertRow)for(;g[H][0]>o.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:"auto"});if(B===0){k=!0;break}}if(o.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;a.propToCol(g[H][1])>o.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:"auto"});if(B===0){k=!0;break}}k||a.set(g[H][0],g[H][1],g[H][3])}}if(g.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",g,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",g,w||"edit");const H=o.getActiveEditor();H&&de(H.refreshValue)&&H.refreshValue()}else o.render()}this._createCellCoords=function(g,w){return o.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,p){return o.view._wt.createCellRange(g,w,p)},this.validateCell=function(g,w,p,H){let k=o.getCellValidator(w);function B(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(G);return}const v=w.visualCol,R=w.visualRow,S=o.getCell(R,v,!0);if(S&&S.nodeName!=="TH"){const O=o.rowIndexMapper.getRenderableFromVisualIndex(R),P=o.columnIndexMapper.getRenderableFromVisualIndex(v);o.view._wt.getSetting("cellRenderer",O,P,S)}p(G)}L$(k)&&(k=function(G){return function(X,v){v(G.test(X))}}(k)),ft(k)?(g=o.runHooks("beforeValidate",g,w.visualRow,w.prop,H),o._registerImmediate(()=>{k.call(w,g,G=>{o&&(G=o.runHooks("afterValidate",G,g,w.visualRow,w.prop,H),w.valid=G,B(G),o.runHooks("postAfterValidate",G,g,w.visualRow,w.prop,H))})})):o._registerImmediate(()=>{w.valid=!0,B(w.valid,!1)})};function Me(g,w,p){return Array.isArray(g)?g:[[g,w,p]]}function je(g,w){const p=o.runHooks("beforeChange",g,w||"edit"),H=g.filter(B=>B!==null);if(p===!1||H.length===0){var k;return(k=o.getActiveEditor())===null||k===void 0||k.cancelChanges(),[]}for(let B=H.length-1;B>=0;B--){const[G,X,,v]=H[B],R=a.propToCol(X);let S;Number.isInteger(R)?S=o.getCellMeta(G,R):S={...Object.getPrototypeOf(b),...b};const{type:O,checkedTemplate:P,uncheckedTemplate:N}=S;if(O==="numeric"&&typeof v=="string"&&yV(v)&&(H[B][3]=ye(v)),O==="checkbox"){const j=At(v),T=j===At(P),I=j===At(N);(T||I)&&(H[B][3]=T?P:N)}}return H}this.setDataAtCell=function(g,w,p,H){const k=Me(g,w,p),B=[];let G=H,X,v,R;for(X=0,v=k.length;X<v;X++){if(typeof k[X]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[X][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[X][1]>=this.countCols()?R=k[X][1]:R=a.colToProp(k[X][1]),B.push([k[X][0],R,l.getAtCell(this.toPhysicalRow(k[X][0]),k[X][1]),k[X][2]])}!G&&typeof g=="object"&&(G=w);const S=je(B,G);o.runHooks("afterSetDataAtCell",S,G),Ie(S,G,()=>{Nt(S,G)})},this.setDataAtRowProp=function(g,w,p,H){const k=Me(g,w,p),B=[];let G=H,X,v;for(X=0,v=k.length;X<v;X++)B.push([k[X][0],k[X][1],l.getAtCell(this.toPhysicalRow(k[X][0]),k[X][1]),k[X][2]]);!G&&typeof g=="object"&&(G=w);const R=je(B,H);o.runHooks("afterSetDataAtRowProp",R,G),Ie(R,G,()=>{Nt(R,G)})},this.listen=function(){o&&!o.isListening()&&(Zv.forEach(g=>{o!==g&&g.unlisten()}),Xv=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Xv=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Xv===o.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),o.view.render(),w&&K.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,w,p,H,k,B,G){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const X=typeof H=="number"?o._createCellCoords(H,k):null;return u.populateFromArray(o._createCellCoords(g,w),p,X,B,G)},this.spliceCol=function(g,w,p){for(var H=arguments.length,k=new Array(H>3?H-3:0),B=3;B<H;B++)k[B-3]=arguments[B];return a.spliceCol(g,w,p,...k)},this.spliceRow=function(g,w,p){for(var H=arguments.length,k=new Array(H>3?H-3:0),B=3;B<H;B++)k[B-3]=arguments[B];return a.spliceRow(g,w,p,...k)},this.getSelected=function(){if(K.isSelected())return Ge(K.getSelectedRange(),g=>{let{from:w,to:p}=g;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRange=function(){if(K.isSelected())return Array.from(K.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.emptySelectedCells=function(g){if(!K.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];M(K.getSelectedRange(),p=>{if(p.isSingleHeader())return;const H=p.getTopStartCorner(),k=p.getBottomEndCorner();pe(H.row,k.row,B=>{pe(H.col,k.col,G=>{this.getCellMeta(B,G).readOnly||w.push([B,G,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=g();return this.resumeExecution(w),p},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const g=o.view,{width:w,height:p}=g.getLastSize(),{width:H,height:k}=o.rootElement.getBoundingClientRect(),B=H!==w||k!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:H,height:k},B)!==!1&&((B||g._wt.wtOverlays.scrollableElement===o.rootWindow)&&(g.setLastSize(H,k),o.render(),g.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:H,height:k},B))},this.updateData=function(g,w){pT(g,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),K.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(g,w){pT(g,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),K.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const g=b.columns;let w=0;if(Array.isArray(g))w=g.length;else if(ft(g))if(o.dataType==="array"){const p=this.countSourceCols();for(let H=0;H<p;H+=1)g(H)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(de(b.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:uS(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,p,H){return Ht(g)?a.getAll():a.getRange(o._createCellCoords(g,w),o._createCellCoords(p,H),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,p,H){return a.getCopyableText(o._createCellCoords(g,w),o._createCellCoords(p,H))},this.getCopyableData=function(g,w){return a.getCopyable(g,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let H=!1,k,B;if(de(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(de(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(de(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');g.language&&le(g.language);for(k in g)if(!(k==="data"||k==="language"))if(k==="className")ne("className",g.className);else if(k==="tableClassName"&&o.table)ne("tableClassName",g.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(se.getSingleton().isRegistered(k)||se.getSingleton().isDeprecated(k)){const S=g[k];ft(S)?(se.getSingleton().addAsFixed(k,S,o),b[k]=S):Array.isArray(S)&&(se.getSingleton().add(k,S,o),b[k]=S)}else!w&&sn(g,k)&&($[k]=g[k]);g.data===void 0&&b.data===void 0?p(null,"updateSettings"):g.data!==void 0?p(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),X=b.columns;if(X&&ft(X)&&(H=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&E.clearCache(),G>0)for(k=0,B=0;k<G;k++){if(X){const S=H?X(k):X[B];S&&E.updateColumnMeta(B,S)}B+=1}de(g.cell)&&Be(g.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let v=o.rootElement.style.height;v!==""&&(v=parseInt(o.rootElement.style.height,10));let R=g.height;if(ft(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let S=g.width;ft(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),O=sn(g,"themeName");S&&O&&S!==g.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const P=O&&g.themeName||ST(o.rootElement);o.useTheme(P),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(v===""||R===""||R===void 0)&&v!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=o.getSelectedLast();if(b.getValue){if(ft(b.getValue))return b.getValue.call(o);if(g)return o.getData()[g[0][0]][b.getValue]}else if(g)return o.getDataAtCell(g[0],g[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,p,H,k){u.alter(g,w,p,H,k)},this.getCell=function(g,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,H=w,k=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;H=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return k===null||H===null||k===void 0||H===void 0?null:o.view.getCellAtCoords(o._createCellCoords(k,H),p)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:p,col:H}=w;let k=p,B=H;return p>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(p)),H>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(H)),o._createCellCoords(k,B)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return a.get(g,a.colToProp(w))},this.getDataAtRowProp=function(g,w){return a.get(g,w)},this.getDataAtCol=function(g){const w=[],p=a.getRange(o._createCellCoords(0,g),o._createCellCoords(b.data.length-1,g),a.DESTINATION_RENDERER);for(let H=0;H<p.length;H+=1)for(let k=0;k<p[H].length;k+=1)w.push(p[H][k]);return w},this.getDataAtProp=function(g){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(g)),o._createCellCoords(b.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let H=0;H<p.length;H+=1)for(let k=0;k<p[H].length;k+=1)w.push(p[H][k]);return w},this.getSourceData=function(g,w,p,H){let k;return g===void 0?k=l.getData():k=l.getByRange(o._createCellCoords(g,w),o._createCellCoords(p,H)),k},this.getSourceDataArray=function(g,w,p,H){let k;return g===void 0?k=l.getData(!0):k=l.getByRange(o._createCellCoords(g,w),o._createCellCoords(p,H),!0),k},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,p,H){const k=Me(g,w,p),B=this.hasHook("afterSetSourceDataAtCell"),G=[];B&&M(k,v=>{let[R,S,O]=v;G.push([R,S,l.getAtCell(R,S),O])}),M(k,v=>{let[R,S,O]=v;l.setAtCell(R,S,O)}),B&&this.runHooks("afterSetSourceDataAtCell",G,H),this.render();const X=o.getActiveEditor();X&&de(X.refreshValue)&&X.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return l.getAtCell(g,w)},this.getDataAtRow=function(g){return a.getRange(o._createCellCoords(g,0),o._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,p,H){const k=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,p,H],[B,G]=k;let[,,X,v]=k,R=null,S=null;X===void 0&&(X=B),v===void 0&&(v=G);let O="mixed";return pe(Math.max(Math.min(B,X),0),Math.max(B,X),P=>{let N=!0;return pe(Math.max(Math.min(G,v),0),Math.max(G,v),j=>(S=this.getCellMeta(P,j).type,R?N=R===S:R=S,N)),O=N?S:"mixed",N}),O},this.removeCellMeta=function(g,w,p){const[H,k]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let B=E.getCellMetaKeyValue(H,k,p);o.runHooks("beforeRemoveCellMeta",g,w,p,B)!==!1&&(E.removeCellMeta(H,k,p),o.runHooks("afterRemoveCellMeta",g,w,p,B)),B=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,H=new Array(p>2?p-2:0),k=2;k<p;k++)H[k-2]=arguments[k];if(H.length>0&&!Array.isArray(H[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(g),w),H.length>0&&M(H.reverse(),B=>{E.createRow(this.toPhysicalRow(g)),M(B,(G,X)=>this.setCellMetaObject(g,X,G))}),o.render()},this.setCellMetaObject=function(g,w,p){typeof p=="object"&&Be(p,(H,k)=>{this.setCellMeta(g,w,k,H)})},this.setCellMeta=function(g,w,p,H){if(o.runHooks("beforeSetCellMeta",g,w,p,H)===!1)return;let B=g,G=w;g<this.countRows()&&(B=this.toPhysicalRow(g)),w<this.countCols()&&(G=this.toPhysicalColumn(w)),E.setCellMeta(B,G,p,H),o.runHooks("afterSetCellMeta",g,w,p,H)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(g,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},H=this.toPhysicalRow(g),k=this.toPhysicalColumn(w);return H===null&&(H=g),k===null&&(k=w),E.getCellMeta(H,k,{visualRow:g,visualColumn:w,...p})},this.getColumnMeta=function(g){return E.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return E.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||b.columns)},this.getCellRenderer=function(g,w){const p=typeof g=="number"?o.getCellMeta(g,w).renderer:g.renderer;return typeof p=="string"?l_(p):Ht(p)?l_("text"):p},this.getCellEditor=function(g,w){const p=typeof g=="number"?o.getCellMeta(g,w).editor:g.editor;return typeof p=="string"?KE(p):Ht(p)?KE("text"):p},this.getCellValidator=function(g,w){const p=typeof g=="number"?o.getCellMeta(g,w).validator:g.validator;return typeof p=="string"?LV(p):p},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,p){const H=new ve;g&&(H.onQueueEmpty=g);let k=o.countRows()-1;for(;k>=0;){if(w!==void 0&&w.indexOf(k)===-1){k-=1;continue}let B=o.countCols()-1;for(;B>=0;){if(p!==void 0&&p.indexOf(B)===-1){B-=1;continue}H.addValidatorToQueue(),o.validateCell(o.getDataAtCell(k,B),o.getCellMeta(k,B),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(H.valid=!1),H.removeValidatorFormQueue()},"validateCells"),B-=1}k-=1}H.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=b.rowHeaders,p=g;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],pe(o.countRows()-1,H=>{w.push(o.getRowHeader(H))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:ft(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let g=0,w=o.countCols();g<w;g++)if(o.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",g);if(p===void 0){const X=[],v=o.countCols();for(let R=0;R<v;R++)X.push(o.getColHeader(R));return X}let H=b.colHeaders;const k=function(X){const v=[],R=o.countCols();let S=0;for(;S<R;S++)ft(b.columns)&&b.columns(S)&&v.push(S);return v[X]},B=o.toPhysicalColumn(p),G=k(B);return b.colHeaders===!1?H=null:b.columns&&ft(b.columns)&&b.columns(G)&&b.columns(G).title?H=b.columns(G).title:b.columns&&b.columns[B]&&b.columns[B].title?H=b.columns[B].title:Array.isArray(b.colHeaders)&&b.colHeaders[B]!==void 0?H=b.colHeaders[B]:ft(b.colHeaders)?H=b.colHeaders(B):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(H=zj(p)),H=o.runHooks("modifyColumnHeaderValue",H,g,w),H},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=o.getCellMeta(0,g).width),(w===void 0||w===b.width)&&(w=b.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(g,w){let p=o._getColWidthFromSettings(g);return p=o.runHooks("modifyColWidth",p,g,w),p===void 0&&(p=Iu),p},this._getRowHeightFromSettings=function(g){const w=this.view.getDefaultRowHeight();let p=b.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(g,w){let p=o._getRowHeightFromSettings(g);return p=o.runHooks("modifyRowHeight",p,g,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=b.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return s_(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return s_(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return b.isEmptyRow.call(o,g)},this.isEmptyCol=function(g){return b.isEmptyCol.call(o,g)},this.selectCell=function(g,w,p,H){let k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ht(g)||Ht(w)?!1:this.selectCells([[g,w,p,H]],k,B)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const H=K.selectCells(g);return H&&p&&o.listen(),d.resume(),H},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,p=arguments.length>2?arguments[2]:void 0;return K.selectColumns(g,w,p)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,p=arguments.length>2?arguments[2]:void 0;return K.selectRows(g,w,p)},this.deselectCell=function(){K.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),K.selectAll(g,w,p)};const Rt=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g,w){if(typeof g=="number"){var p;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:H,col:k,considerHiddenIndexes:B}=g??{};let G=H,X=k;if(ft(w)&&this.addHookOnce("afterScroll",w),B===void 0||B){const O=Number.isInteger(H)&&H>=0,P=Number.isInteger(k)&&k>=0,N=O?Rt(this.rowIndexMapper,H):void 0,j=P?Rt(this.columnIndexMapper,k):void 0;if(N===null||j===null)return!1;G=O?o.rowIndexMapper.getRenderableFromVisualIndex(N):H,X=P?o.columnIndexMapper.getRenderableFromVisualIndex(j):k}const v=Number.isInteger(G),R=Number.isInteger(X);let S=!1;return v&&G>=0&&R&&X>=0?S=o.view.scrollViewport(o._createCellCoords(G,X),g.horizontalSnap,g.verticalSnap):v&&G>=0&&(R&&X<0||!R)?S=o.view.scrollViewportVertically(G,g.verticalSnap):R&&X>=0&&(v&&G<0||!v)&&(S=o.view.scrollViewportHorizontally(X,g.horizontalSnap)),ft(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;ft(g)&&this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():ft(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),Zv.delete(this.guid),og(o)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Go(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),W.getItems().forEach(g=>{let[,w]=g;w.destroy()}),W.clear(),o.runHooks("afterDestroy")},!0),se.getSingleton().destroy(o),Be(o,(g,w,p)=>{ft(g)?p[w]=gn(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,K=null,c=null,o=null};function gn(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return W.getItem(pr(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:W.getId(g)},this.getInstance=function(){return o},this.addHook=function(g,w,p){se.getSingleton().add(g,w,o,p)},this.hasHook=function(g){return se.getSingleton().has(g,o)||se.getSingleton().has(g)},this.addHookOnce=function(g,w,p){se.getSingleton().once(g,w,o,p)},this.removeHook=function(g,w){se.getSingleton().remove(g,w,o)},this.runHooks=function(g,w,p,H,k,B,G){return se.getSingleton().run(o,g,w,p,H,k,B,G)},this.getTranslatedPhrase=function(g,w){return E1(b.language,g,w)},this.toHTML=()=>r_(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",r_(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{this.view.getStylesHandler().useTheme(g),this.runHooks("afterSetTheme",g,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=g;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){M(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){M(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return c};const Sn=n2({handleEvent(){return o.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&Sn.releasePressedKeys()}),this.getShortcutManager=function(){return Sn},this.getFocusManager=function(){return h},Bx().forEach(g=>{const w=gS(g);W.addItem(g,new w(this))}),FY(o),Sn.setActiveContextName("grid"),se.getSingleton().run(o,"construct")}function RT(t,e,n){t.addEventListener(e,n,!1)}function ET(t,e,n){t.removeEventListener(e,n,!1)}function Gd(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function F1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},i=t.body,r=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;r.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Gd(s).fontSize,o.style.fontFamily=Gd(s).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const f=parseInt(((h=Gd(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=Gd(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=o.clientWidth+f+m+1;i.removeChild(o);const C=s.style;C.height=`${n.minHeight}px`,n.minWidth>y?C.width=`${n.minWidth}px`:y>n.maxWidth?C.width=`${n.maxWidth}px`:C.width=`${y}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?C.height=`${n.minHeight}px`:n.maxHeight<E?(C.height=`${n.maxHeight}px`,C.overflowY="visible"):C.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(RT(s,"input",a),RT(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){ET(s,"input",a),ET(s,"keydown",l)}}}function _T(t,e){const n=yx(e),i=e.value.split(`
`);let r=n,o=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(o+=i[s-1].length+1);const l=o+a.length;if(t==="home"?r=o:t==="end"&&(r=l),n<=l)break}Nm(e,r)}function sa(t,e,n){return(e=i2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i2(t){var e=r2(t,"string");return typeof e=="symbol"?e:e+""}function r2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o2="ht_editor_visible",Kd="ht_editor_hidden",TT="textEditor",s2="text";class wl extends ju{static get EDITOR_TYPE(){return s2}constructor(e){super(e),sa(this,"eventManager",new wr(this)),sa(this,"autoResize",F1(this.hot.rootDocument)),sa(this,"TEXTAREA",void 0),sa(this,"textareaStyle",void 0),sa(this,"TEXTAREA_PARENT",void 0),sa(this,"textareaParentStyle",void 0),sa(this,"layerClass",void 0),this.eventManager=new wr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),ig(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,s){const a=this.state;if(super.prepare(e,n,i,r,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Gt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Gt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Nm(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ee(this.TEXTAREA,[["data-hot-input",""],gl(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),Se(this.TEXTAREA_PARENT,this.layerClass)&&be(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Kd),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){NF()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",be(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Kd)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;pe(e.length-1,i=>{const r=e[i];if(Se(r,"handsontableEditor"))return n=!0,!1}),Se(this.TEXTAREA_PARENT,Kd)&&be(this.TEXTAREA_PARENT,Kd),n?(this.layerClass=o2,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Gt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){xx()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Gt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Gt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>de(this.hot.getSelected()),group:TT},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;_T(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;_T(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TT)}}const a2="base";function ad(t,e,n,i,r,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(IE())):a&&c.push(IE()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(xE())):(u.push(s.invalidCellClassName),a&&c.push(xE()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),be(e,u),q(e,l),Vu(e,c),Ee(e,h)}ad.RENDERER_TYPE=a2;const l2="text";function ts(t,e,n,i,r,o,s){ad.apply(this,[t,e,n,i,r,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=At(a),s.trimWhitespace&&(a=a.trim()),Ja(e,a)}ts.RENDERER_TYPE=l2;const u2="text",V1={CELL_TYPE:u2,editor:wl,renderer:ts};nr(V1);Si.editors={BaseEditor:ju};function Si(t,e){const n=new $1(t,e||{},OS);return n.init(),n}Si.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new $1(t,e,OS)};Si.DefaultSettings=O1();Si.hooks=se.getSingleton();Si.CellCoords=tl;Si.CellRange=td;Si.packageName="handsontable";Si.buildDate="24/04/2025 10:59:00";Si.version="15.3.0";Si.languages={dictionaryKeys:TU,getLanguageDictionary:R1,getLanguagesDictionaries:OU,registerLanguageDictionary:BS,getTranslatedPhrase:E1};function c2(t,e,n){return(e=f2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function h2(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MT(Object(n),!0).forEach(function(i){c2(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MT(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function d2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f2(t){var e=d2(t,"string");return typeof e=="symbol"?e:e+""}function lh(t){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lh(t)}var Ru=Symbol("unassigned"),g2="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Dg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function W1(t){var e=Si.hooks.getRegistered(),n={};Object.assign(n,Si.DefaultSettings);for(var i in n)n[i]={default:Ru};for(var r=0;r<e.length;r++)n[e[r]]={default:Ru};return n.settings={default:Ru},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function B1(t){var e={},n=t.settings;if(n!==Ru)for(var i in n)Dg(n,i)&&n[i]!==Ru&&(e[i]=n[i]);for(var r in t)Dg(t,r)&&r!=="settings"&&t[r]!==Ru&&(e[r]=t[r]);return e}function PT(t,e){var n=B1(t),i=t.settings?t.settings:n,r=t.settings?n:null,o={};for(var s in i)Dg(i,s)&&i[s]!==void 0&&(!(e&&s!=="data")||!IT(e[s],i[s]))&&(o[s]=i[s]);for(var a in r)Dg(r,a)&&a!=="id"&&a!=="settings"&&r[a]!==void 0&&(!(e&&a!=="data")||!IT(e[a],r[a]))&&(o[a]=r[a]);return o}function IT(t,e){var n=function(r){var o=function(){var s=new WeakSet;return function(a,l){if(lh(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(r,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():lh(t)!==lh(e)?!1:n(t)===n(e)}var m2="15.3.0",zS=qP({name:"HotTable",props:W1("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=PT(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(g2),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=PT(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=yA(new Si.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),i=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)i.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)r.push(c)}this.hotInstance.batch(function(){i.length>0?e.hotInstance.rowIndexMapper.removeIndexes(i):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:m2}),p2=["id"];function w2(t,e,n,i,r,o){return on(),Yr("div",{id:t.id},[bA(t.$slots,"default")],8,p2)}zS.render=w2;zS.__file="src/HotTable.vue";var v2=qP({name:"HotColumn",props:W1("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=B1(this.$props),n=h2({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});v2.__file="src/HotColumn.vue";const xT="handsontableEditor",C2="handsontable";class YS extends wl{static get EDITOR_TYPE(){return C2}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Nm(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ln(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var i;(i=this.htEditor)===null||i===void 0||i.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:xT,relativeToGroup:Ys,position:"before"},r=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Cr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),r(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return r(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xT)}}function y2(t,e){j1(t,e),e.add(t)}function OT(t,e,n){j1(t,e),e.set(t,n)}function j1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qd(t,e,n){return(e=b2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b2(t){var e=S2(t,"string");return typeof e=="symbol"?e:e+""}function S2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qv(t,e){return t.get(Qy(t,e))}function Qy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const R2="autocomplete";var Jv=new WeakMap,HT=new WeakMap,eC=new WeakSet;class GS extends YS{constructor(){super(...arguments),y2(this,eC),qd(this,"query",null),qd(this,"strippedChoices",[]),qd(this,"rawChoices",[]),OT(this,Jv,this.hot.guid.slice(0,9)),OT(this,HT,km(()=>{this.focus()},100)),qd(this,"sortByRelevance",function(e,n,i){const r=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=PE(At(n[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,r.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(r.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=r.length;c<a;c++)o.push(r[c].baseIndex);return o})}static get EDITOR_TYPE(){return R2}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return de(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[eF(),q$(),cx("listbox"),rF()])}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Bi("false"),oF(`${Qv(Jv,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",Qv(HT,this)),this.htEditor.updateSettings({colWidths:e?[Jt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ts(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:y,locale:C}=this.cellProperties,E=this.query;let b=At(d),$,W;b&&!y&&($=m===!0?b.indexOf(E):b.toLocaleLowerCase(C).indexOf(E.toLocaleLowerCase(C)),$!==-1&&(W=b.substr($,E.length),b=b.replace(W,`<strong>${W}</strong>`))),n&&Ee(l,[X$(),...i?[uF(r)]:[],...i?[cF(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=b},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ee(h,[rS()]),Ee(this.TEXTAREA,...sF(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ee(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Lo()),Ee(this.htEditor.rootElement,[ux(),aF("polite"),lF("text"),["id",`${Qv(Jv,this)}-listbox-${o}-${s}`]]),Ee(this.TEXTAREA,...Bi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Bi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=yx(this.TEXTAREA),i=CF(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;r&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(r&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(ng([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Nm(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let i=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-i-n,s=r>o&&i>o+n;return s?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(s?i:o,r),s}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,o=0,s=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),i+=o,r+=1;while(i<e);s=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),Qy(eC,this,AT).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Qy(eC,this,AT).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=Ge(e,o=>At(o));return Ge(i,o=>n?o:PE(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===Ce.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===Ce.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(kF(e.keyCode)||e.keyCode===Ce.BACKSPACE||e.keyCode===Ce.DELETE||e.keyCode===Ce.INSERT){let n=10;if(e.keyCode===Ce.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function AT(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+vn(this.hot.rootDocument)})}const E2="checkbox";class U1 extends ju{static get EDITOR_TYPE(){return E2}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Se(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Os=()=>window,$i=()=>window.document,Jy=(t,e)=>window.setTimeout(t,e),$r=function(t,e,n,i){t.addEventListener(e,n,!!i)},wo=function(t,e,n,i){t.removeEventListener(e,n,!!i)},_2=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},fi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},tC=function(t,e){fi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},nC=function(t,e){t.className=_2((" "+t.className+" ").replace(" "+e+" "," "))},KS=function(t){return/Array/.test(Object.prototype.toString.call(t))},wi=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},T2=function(t){let e=t.getDay();return e===0||e===6},M2=function(t){return t%4===0&&t%100!==0||t%400===0},NT=function(t,e){return[31,M2(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Xd=function(t){wi(t)&&t.setHours(0,0,0,0)},Zd=function(t,e){return t.getTime()===e.getTime()},kg=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?wi(e[i])?n&&(t[i]=new Date(e[i].getTime())):KS(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=kg({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},DT=function(t,e,n){let i=$i().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=kg(i,n),t.dispatchEvent(i)},kT=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Mr={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},LT=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},P2=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},I2=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},x2=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():I2(o,r))+"</td>"},O2=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},H2=function(t){return"<tbody>"+t.join("")+"</tbody>"},A2=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+LT(t,e)+'">'+LT(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},N2=function(t,e,n,i,r,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,y=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===r?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",KS(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(i===0||u.minMonth>=i)&&(y=!1),h&&(i===11||u.maxMonth<=i)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(y?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},D2=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+A2(t)+H2(e)+"</table>"};function eb(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||Os().event;let o=r.target||r.srcElement;if(o)if(fi(o,"is-disabled")||(fi(o,"pika-button")&&!fi(o,"is-empty")&&!fi(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&Jy(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):fi(o,"pika-prev")?e.prevMonth():fi(o,"pika-next")&&e.nextMonth()),fi(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||Os().event;let o=r.target||r.srcElement;o&&(fi(o,"pika-select-month")?e.gotoMonth(o.value):fi(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||Os().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),wi(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=$i().activeElement;do if(fi(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=Jy(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||Os().event;let o=r.target||r.srcElement,s=o;if(o){!hasEventListeners&&fi(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),$r(o,"change",e._onChange)));do if(fi(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=$i().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),$r(e.el,"mousedown",e._onMouseDown,!0),$r(e.el,"touchend",e._onMouseDown,!0),$r(e.el,"change",e._onChange),n.keyboardInput&&$r($i(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?$i().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),$r(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;wi(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",$r(n.trigger,"click",e._onInputClick),$r(n.trigger,"focus",e._onInputFocus),$r(n.trigger,"blur",e._onInputBlur)):this.show()}eb.prototype={config:function(t){this._o||(this._o=kg({},Mr,!0));let e=kg(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,wi(e.minDate)||(e.minDate=!1),wi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),KS(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Mr.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,wi(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return wi(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",DT(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!wi(t))return;let n=this._o.minDate,i=this._o.maxDate;wi(n)&&t<n?t=n:wi(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),Xd(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),DT(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(wi(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=kT(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=kT({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Xd(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Mr.minDate,this._o.minYear=Mr.minYear,this._o.minMonth=Mr.minMonth,this._o.startRange=Mr.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Xd(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Mr.maxDate,this._o.maxYear=Mr.maxYear,this._o.maxMonth=Mr.maxMonth,this._o.endRange=Mr.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+N2(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&Jy(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=Os().innerWidth||$i().documentElement.clientWidth,r=Os().innerHeight||$i().documentElement.clientHeight,o=$i().body.scrollTop||$i().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Os().pageXOffset,a=l.bottom+Os().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",tC(this.el,u?"left-aligned":"right-aligned"),tC(this.el,c?"bottom-aligned":"top-aligned"),nC(this.el,u?"right-aligned":"left-aligned"),nC(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=NT(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Xd(r),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=NT(h,u),m=o+s,y=m;for(;y>7;)y-=7;m+=7-y;let C=!1;for(let E=0,b=0;E<m;E++){let $=new Date(t,e,1+(E-s)),W=wi(this._d)?Zd($,this._d):!1,F=Zd($,r),x=i.events.indexOf($.toDateString())!==-1,A=E<s||E>=o+s,Z=1+(E-s),K=e,z=t,le=i.startRange&&Zd(i.startRange,$),ne=i.endRange&&Zd(i.endRange,$),ve=i.startRange&&i.endRange&&i.startRange<$&&$<i.endRange,ye=i.minDate&&$<i.minDate||i.maxDate&&$>i.maxDate||i.disableWeekends&&T2($)||i.disableDayFn&&i.disableDayFn($);A&&(E<s?(Z=f+Z,K=u,z=h):(Z=Z-o,K=c,z=d));let Ie={day:Z,month:K,year:z,hasEvent:x,isSelected:W,isToday:F,isDisabled:ye,isEmpty:A,isStartRange:le,isEndRange:ne,isInRange:ve,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&W&&(C=!0),l.push(P2(Ie)),++b===7&&(i.showWeekNumber&&l.unshift(x2(this,E-s,e,t,i.firstWeekOfYearMinDays)),a.push(O2(l,i.isRTL,i.pickWholeWeek,C)),l=[],b=0,C=!1)}return D2(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),nC(this.el,"is-hidden"),this._o.bound&&($r($i(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&wo($i(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),tC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),wo(this.el,"mousedown",this._onMouseDown,!0),wo(this.el,"touchend",this._onMouseDown,!0),wo(this.el,"change",this._onChange),t.keyboardInput&&wo($i(),"keydown",this._onKeyChange),t.field&&(wo(t.field,"change",this._onInputChange),t.bound&&(wo(t.trigger,"click",this._onInputClick),wo(t.trigger,"focus",this._onInputFocus),wo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function k2(t,e){L2(t,e),e.add(t)}function L2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $T(t,e,n){return(e=$2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $2(t){var e=F2(t,"string");return typeof e=="symbol"?e:e+""}function F2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const z1="date",FT="dateEditor",V2="DD/MM/YYYY";var Qd=new WeakSet;class Y1 extends wl{constructor(){super(...arguments),k2(this,Qd),$T(this,"parentDestroyed",!1),$T(this,"$datePicker",null)}static get EDITOR_TYPE(){return z1}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof eb!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(be(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();be(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{Se(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:FT})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FT),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=iC(Qd,this,rC).call(this),i=this.hot.view.isMouseDown(),r=e?Hx(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new eb(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Q(o,n,!0).isValid()&&this.$datePicker.setMoment(Q(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Lm(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:iC(Qd,this,rC).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=Q(a).format(iC(Qd,this,rC).call(this))),this.setValue(a),r&&r(),$o()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Gt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+an(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Jt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function rC(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:V2}const W2="dropdown";class G1 extends GS{static get EDITOR_TYPE(){return W2}prepare(e,n,i,r,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,i,r,o,s)}}const B2="numeric";class K1 extends wl{static get EDITOR_TYPE(){return B2}}function j2(t,e,n){return(e=U2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U2(t){var e=z2(t,"string");return typeof e=="symbol"?e:e+""}function z2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y2="password";class q1 extends wl{constructor(){super(...arguments),j2(this,"autoResize",F1(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Y2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Go(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const oC="ht_editor_visible",VT="selectEditor",G2="select";class X1 extends ju{static get EDITOR_TYPE(){return G2}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...ml()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Se(this.selectWrapper,oC)&&be(this.selectWrapper,oC),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Go(this.select),Be(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Wu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Gt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,oC)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:VT};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VT)}}const K2="time";class Z1 extends wl{static get EDITOR_TYPE(){return K2}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.TEXTAREA.dir="ltr"}}function q2(){gi(ju),gi(GS),gi(U1),gi(Y1),gi(G1),gi(YS),gi(K1),gi(q1),gi(X1),gi(wl),gi(Z1)}const X2="html";function qS(t,e,n,i,r,o,s){ad.apply(this,[t,e,n,i,r,o,s]),Wu(e,o??"",!1)}qS.RENDERER_TYPE=X2;const Z2="autocomplete";function zu(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=s.allowHtml?qS:ts,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...ml()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,i,r,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new wr(t);t.acArrowListener=function(d){Se(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}zu.RENDERER_TYPE=Z2;const Q2="dropdown";function XS(t,e,n,i,r,o,s){zu.apply(this,[t,e,n,i,r,o,s])}XS.RENDERER_TYPE=Q2;const WT=new WeakMap,BT=new WeakMap,J2="htBadValue",Ou="data-row",Hu="data-col",eG="checkboxRenderer",Q1="checkbox";se.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:s,prop:a}=e;if(r===Q1){if(i){const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function ZS(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;ad.apply(this,[t,e,n,i,r,o,s]),tG(t);let u=nG(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Go(e),o===s.checkedTemplate||At(o).toLocaleLowerCase(s.locale)===At(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||At(o).toLocaleLowerCase(s.locale)===At(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:qt(o)?q(u,"noValue"):(u.style.display="none",q(u,J2),h=!0),Ee(u,[[Ou,n],[Hu,i]]),l&&Ee(u,[Ih(u.checked?t.getTranslatedPhrase(VS):t.getTranslatedPhrase(WS)),fx(u.checked),Z$()]),!h&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,n,i,r,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);y=E!==null?E:""}const C=iG(a,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),WT.has(t)||(WT.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),E={group:eG,relativeToGroup:Ys,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const b=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(b==null?void 0:b.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight.isCell()}}],E)}function f(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),E=[],b=new Map;let $=[],W=0;if(C){for(let F=0;F<C.length;F++){const{row:x,col:A}=C[F].getTopStartCorner(),{row:Z,col:K}=C[F].getBottomEndCorner();for(let z=x;z<=Z;z+=1)for(let le=A;le<=K;le+=1){const ne=t.getCellMeta(z,le);if(ne.hidden)continue;const ve={checkedTemplate:ne.checkedTemplate,uncheckedTemplate:ne.uncheckedTemplate};if(ne.type!=="checkbox"){y===!0&&!ne.readOnly&&(b.has(E.length)?b.set(E.length,[...b.get(E.length),[z,le,null]]):b.set(E.length,[[z,le,null]]));continue}if(ne.readOnly===!0)continue;typeof ne.checkedTemplate>"u"&&(ne.checkedTemplate=!0),typeof ne.uncheckedTemplate>"u"&&(ne.uncheckedTemplate=!1);const ye=t.getDataAtCell(z,le);y===!1?[ne.checkedTemplate,ne.checkedTemplate.toString()].includes(ye)?$.push([z,le,ne.uncheckedTemplate,ve]):[ne.uncheckedTemplate,ne.uncheckedTemplate.toString(),null,void 0].includes(ye)&&$.push([z,le,ne.checkedTemplate,ve]):$.push([z,le,ne.uncheckedTemplate,ve]),W+=1}E.push(W),W=0}$.every(F=>{let[,,x]=F;return x===$[0][2]})?$=$.map(F=>{let[x,A,Z]=F;return[x,A,Z]}):$=$.map(F=>{let[x,A,,Z]=F;return[x,A,Z.checkedTemplate]}),$.length>0&&E.forEach((F,x)=>{let A=$.splice(0,F);b.size&&b.has(x)&&(A=[...A,...b.get(x)]),t.setDataAtCell(A)})}}function m(){const y=t.getSelectedRange();if(y){for(let C=0;C<y.length;C++){const E=y[C].getTopStartCorner(),b=y[C].getBottomEndCorner();for(let $=E.row;$<=b.row;$++)for(let W=E.col;W<=b.col;W++){if(t.getCellMeta($,W).readOnly)continue;const x=t.getCell($,W);if(zo(x)&&x.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}ZS.RENDERER_TYPE=Q1;function tG(t){let e=BT.get(t);if(!e){const{rootElement:n}=t;e=new wr(t),e.addEventListener(n,"click",i=>oG(i,t)),e.addEventListener(n,"mouseup",i=>rG(i,t)),e.addEventListener(n,"change",i=>sG(i,t)),BT.set(t,e)}return e}function nG(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function iG(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function rG(t,e){const{target:n}=t;QS(n)&&(!n.hasAttribute(Ou)||!n.hasAttribute(Hu)||setTimeout(e.listen,10))}function oG(t,e){const{target:n}=t;if(!QS(n)||!n.hasAttribute(Ou)||!n.hasAttribute(Hu))return;const i=parseInt(n.getAttribute(Ou),10),r=parseInt(n.getAttribute(Hu),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function sG(t,e){const{target:n}=t;if(!QS(n)||!n.hasAttribute(Ou)||!n.hasAttribute(Hu))return;const i=parseInt(n.getAttribute(Ou),10),r=parseInt(n.getAttribute(Hu),10),o=e.getCellMeta(i,r);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,s)}}function QS(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const aG="handsontable";function JS(t,e,n,i,r,o,s){zu.apply(this,[t,e,n,i,r,o,s])}JS.RENDERER_TYPE=aG;var lG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uG(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var sC,jT;function cG(){return jT||(jT=1,sC={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),sC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var aC,UT;function J1(){if(UT)return aC;UT=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let y="",C=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(C!==l)return-1*n(C,u,c,h,d,f);for(let x=0;x<t.length;x++){let A=t[x];if(y=l.replace(RegExp(`([0-9 ])(${A.key})$`),"$1"),y!==l)return n(y,u,c,h,d,f)*A.factor}if(y=l.replace("%",""),y!==l)return n(y,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let b=h(E);if(b&&b!=="."&&(y=l.replace(new RegExp(`${e(b)}$`),""),y!==l))return n(y,u,c,h,d,f);let $={};Object.keys(f).forEach(x=>{$[f[x]]=x});let W=Object.keys($).sort().reverse(),F=W.length;for(let x=0;x<F;x++){let A=W[x],Z=$[A];if(y=l.replace(A,""),y!==l){let K;switch(Z){case"thousand":K=Math.pow(10,3);break;case"million":K=Math.pow(10,6);break;case"billion":K=Math.pow(10,9);break;case"trillion":K=Math.pow(10,12);break}return n(y,u,c,h,d,f)*K}}}function i(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function r(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let y=i(l,u,c);return n(y,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=nR();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),y=c.currentAbbreviations(),C;if(typeof l=="string")o(l,h)?C=s(l):C=r(l,h,d,f,m,y);else if(typeof l=="number")C=l;else return;if(C!==void 0)return C}return aC={unformat:a},aC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var lC,zT;function eR(){if(zT)return lC;zT=1;let t=J1();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(C,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:C=>C.output==="byte"},characteristic:{type:"number",restriction:C=>C>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(C,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:C=>C>=0,message:"value must be positive"},{restriction:(C,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:C=>C>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(C,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:C=>C.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(C,E){let b=d(C),$=m(E);return b&&$}function d(C){return t.unformat(C)!==void 0}function f(C,E,b,$=!1){let W=Object.keys(C).map(F=>{if(!E[F])return console.error(`${b} Invalid key: ${F}`),!1;let x=C[F],A=E[F];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!f(x,u,`[Validate ${F}]`,!0))return!1}else if(typeof x!==A.type)return console.error(`${b} ${F} type mismatched: "${A.type}" expected, "${typeof x}" provided`),!1;if(A.restrictions&&A.restrictions.length){let Z=A.restrictions.length;for(let K=0;K<Z;K++){let{restriction:z,message:le}=A.restrictions[K];if(!z(x,C))return console.error(`${b} ${F} invalid value: ${le}`),!1}}return A.restriction&&!A.restriction(x,C)?(console.error(`${b} ${F} invalid value: ${A.message}`),!1):A.validValues&&A.validValues.indexOf(x)===-1?(console.error(`${b} ${F} invalid value: must be among ${JSON.stringify(A.validValues)}, "${x}" provided`),!1):!(A.children&&!f(x,A.children,`[Validate ${F}]`))});return $||W.push(...Object.keys(E).map(F=>{let x=E[F];if(typeof x=="string"&&(x={type:x}),x.mandatory){let A=x.mandatory;if(typeof A=="function"&&(A=A(C)),A&&C[F]===void 0)return console.error(`${b} Missing mandatory key "${F}"`),!1}return!0})),W.reduce((F,x)=>F&&x,!0)}function m(C){return f(C,u,"[Validate format]")}function y(C){return f(C,c,"[Validate language]")}return lC={validate:h,validateFormat:m,validateInput:d,validateLanguage:y},lC}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function hG(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function dG(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function fG(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function gG(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function mG(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function pG(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function wG(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function vG(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function CG(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function yG(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function bG(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function SG(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function RG(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function EG(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function _G(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function TG(t,e={}){return typeof t!="string"?t:(t=hG(t,e),t=dG(t,e),fG(t,e),pG(t,e),wG(t,e),RG(t,e),yG(t,e),bG(t,e),vG(t,e),SG(t,e),CG(t,e),gG(t,e),mG(t,e),EG(t,e),_G(t,e),e)}var tR={parseFormat:TG};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var uC,YT;function nR(){if(YT)return uC;YT=1;const t=cG(),e=eR(),n=tR;let i={},r,o={},s=null,a={};function l(c){r=c}function u(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>u().bytes||{},i.currentCurrency=()=>u().currency,i.currentAbbreviations=()=>u().abbreviations,i.currentDelimiters=()=>u().delimiters,i.currentOrdinal=()=>u().ordinal,i.currentDefaults=()=>Object.assign({},u().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().timeFormat),i.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},i.getZeroFormat=()=>s,i.setZeroFormat=c=>s=typeof c=="string"?c:null,i.hasZeroFormat=()=>s!==null,i.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},i.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},i.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},i.registerLanguage(t),r=t.languageTag,uC=i,uC}function MG(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function PG(t,e){t.forEach(n=>{let i;try{i=MG(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var IG=t=>({loadLanguagesInNode:e=>PG(e,t)}),eO={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(x){var A,Z,K,z=p.prototype={constructor:p,toString:null,valueOf:null},le=new p(1),ne=20,ve=4,ye=-7,Ie=21,Nt=-1e7,Me=1e7,je=!1,Rt=1,gn=0,Sn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},g="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(v,R){var S,O,P,N,j,T,I,V,D=this;if(!(D instanceof p))return new p(v,R);if(R==null){if(v&&v._isBigNumber===!0){D.s=v.s,!v.c||v.e>Me?D.c=D.e=null:v.e<Nt?D.c=[D.e=0]:(D.e=v.e,D.c=v.c.slice());return}if((T=typeof v=="number")&&v*0==0){if(D.s=1/v<0?(v=-v,-1):1,v===~~v){for(N=0,j=v;j>=10;j/=10,N++);N>Me?D.c=D.e=null:(D.e=N,D.c=[v]);return}V=String(v)}else{if(!i.test(V=String(v)))return K(D,V,T);D.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(N=V.indexOf("."))>-1&&(V=V.replace(".","")),(j=V.search(/e/i))>0?(N<0&&(N=j),N+=+V.slice(j+1),V=V.substring(0,j)):N<0&&(N=V.length)}else{if(b(R,2,g.length,"Base"),R==10&&w)return D=new p(v),G(D,ne+D.e+1,ve);if(V=String(v),T=typeof v=="number"){if(v*0!=0)return K(D,V,T,R);if(D.s=1/v<0?(V=V.slice(1),-1):1,p.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+v)}else D.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(S=g.slice(0,R),N=j=0,I=V.length;j<I;j++)if(S.indexOf(O=V.charAt(j))<0){if(O=="."){if(j>N){N=I;continue}}else if(!P&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){P=!0,j=-1,N=0;continue}return K(D,String(v),T,R)}T=!1,V=Z(V,R,10,D.s),(N=V.indexOf("."))>-1?V=V.replace(".",""):N=V.length}for(j=0;V.charCodeAt(j)===48;j++);for(I=V.length;V.charCodeAt(--I)===48;);if(V=V.slice(j,++I)){if(I-=j,T&&p.DEBUG&&I>15&&(v>c||v!==o(v)))throw Error(a+D.s*v);if((N=N-j-1)>Me)D.c=D.e=null;else if(N<Nt)D.c=[D.e=0];else{if(D.e=N,D.c=[],j=(N+1)%u,N<0&&(j+=u),j<I){for(j&&D.c.push(+V.slice(0,j)),I-=u;j<I;)D.c.push(+V.slice(j,j+=u));j=u-(V=V.slice(j)).length}else j-=I;for(;j--;V+="0");D.c.push(+V)}}else D.c=[D.e=0]}p.clone=m,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(v){var R,S;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(R="DECIMAL_PLACES")&&(S=v[R],b(S,0,f,R),ne=S),v.hasOwnProperty(R="ROUNDING_MODE")&&(S=v[R],b(S,0,8,R),ve=S),v.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=v[R],S&&S.pop?(b(S[0],-1e9,0,R),b(S[1],0,f,R),ye=S[0],Ie=S[1]):(b(S,-1e9,f,R),ye=-(Ie=S<0?-S:S))),v.hasOwnProperty(R="RANGE"))if(S=v[R],S&&S.pop)b(S[0],-1e9,-1,R),b(S[1],1,f,R),Nt=S[0],Me=S[1];else if(b(S,-1e9,f,R),S)Nt=-(Me=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(v.hasOwnProperty(R="CRYPTO"))if(S=v[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))je=S;else throw je=!S,Error(s+"crypto unavailable");else je=S;else throw Error(s+R+" not true or false: "+S);if(v.hasOwnProperty(R="MODULO_MODE")&&(S=v[R],b(S,0,9,R),Rt=S),v.hasOwnProperty(R="POW_PRECISION")&&(S=v[R],b(S,0,f,R),gn=S),v.hasOwnProperty(R="FORMAT"))if(S=v[R],typeof S=="object")Sn=S;else throw Error(s+R+" not an object: "+S);if(v.hasOwnProperty(R="ALPHABET"))if(S=v[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",g=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+v);return{DECIMAL_PLACES:ne,ROUNDING_MODE:ve,EXPONENTIAL_AT:[ye,Ie],RANGE:[Nt,Me],CRYPTO:je,MODULO_MODE:Rt,POW_PRECISION:gn,FORMAT:Sn,ALPHABET:g}},p.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,O=v.c,P=v.e,N=v.s;e:if({}.toString.call(O)=="[object Array]"){if((N===1||N===-1)&&P>=-1e9&&P<=f&&P===o(P)){if(O[0]===0){if(P===0&&O.length===1)return!0;break e}if(R=(P+1)%u,R<1&&(R+=u),String(O[0]).length==R){for(R=0;R<O.length;R++)if(S=O[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(O===null&&P===null&&(N===null||N===1||N===-1))return!0;throw Error(s+"Invalid BigNumber: "+v)},p.maximum=p.max=function(){return k(arguments,-1)},p.minimum=p.min=function(){return k(arguments,1)},p.random=function(){var v=9007199254740992,R=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var O,P,N,j,T,I=0,V=[],D=new p(le);if(S==null?S=ne:b(S,0,f),j=r(S/u),je)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(j*=2));I<j;)T=O[I]*131072+(O[I+1]>>>11),T>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),O[I]=P[0],O[I+1]=P[1]):(V.push(T%1e14),I+=2);I=j/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(j*=7);I<j;)T=(O[I]&31)*281474976710656+O[I+1]*1099511627776+O[I+2]*4294967296+O[I+3]*16777216+(O[I+4]<<16)+(O[I+5]<<8)+O[I+6],T>=9e15?crypto.randomBytes(7).copy(O,I):(V.push(T%1e14),I+=7);I=j/7}else throw je=!1,Error(s+"crypto unavailable");if(!je)for(;I<j;)T=R(),T<9e15&&(V[I++]=T%1e14);for(j=V[--I],S%=u,j&&S&&(T=h[u-S],V[I]=o(j/T)*T);V[I]===0;V.pop(),I--);if(I<0)V=[N=0];else{for(N=-1;V[0]===0;V.splice(0,1),N-=u);for(I=1,T=V[0];T>=10;T/=10,I++);I<u&&(N-=u-I)}return D.e=N,D.c=V,D}}(),p.sum=function(){for(var v=1,R=arguments,S=new p(R[0]);v<R.length;)S=S.plus(R[v++]);return S},Z=function(){var v="0123456789";function R(S,O,P,N){for(var j,T=[0],I,V=0,D=S.length;V<D;){for(I=T.length;I--;T[I]*=O);for(T[0]+=N.indexOf(S.charAt(V++)),j=0;j<T.length;j++)T[j]>P-1&&(T[j+1]==null&&(T[j+1]=0),T[j+1]+=T[j]/P|0,T[j]%=P)}return T.reverse()}return function(S,O,P,N,j){var T,I,V,D,U,he,ce,Pe,ze=S.indexOf("."),st=ne,Te=ve;for(ze>=0&&(D=gn,gn=0,S=S.replace(".",""),Pe=new p(O),he=Pe.pow(S.length-ze),gn=D,Pe.c=R(F(C(he.c),he.e,"0"),10,P,v),Pe.e=Pe.c.length),ce=R(S,O,P,j?(T=g,v):(T=v,g)),V=D=ce.length;ce[--D]==0;ce.pop());if(!ce[0])return T.charAt(0);if(ze<0?--V:(he.c=ce,he.e=V,he.s=N,he=A(he,Pe,st,Te,P),ce=he.c,U=he.r,V=he.e),I=V+st+1,ze=ce[I],D=P/2,U=U||I<0||ce[I+1]!=null,U=Te<4?(ze!=null||U)&&(Te==0||Te==(he.s<0?3:2)):ze>D||ze==D&&(Te==4||U||Te==6&&ce[I-1]&1||Te==(he.s<0?8:7)),I<1||!ce[0])S=U?F(T.charAt(1),-st,T.charAt(0)):T.charAt(0);else{if(ce.length=I,U)for(--P;++ce[--I]>P;)ce[I]=0,I||(++V,ce=[1].concat(ce));for(D=ce.length;!ce[--D];);for(ze=0,S="";ze<=D;S+=T.charAt(ce[ze++]));S=F(S,V,T.charAt(0))}return S}}(),A=function(){function v(O,P,N){var j,T,I,V,D=0,U=O.length,he=P%d,ce=P/d|0;for(O=O.slice();U--;)I=O[U]%d,V=O[U]/d|0,j=ce*I+V*he,T=he*I+j%d*d+D,D=(T/N|0)+(j/d|0)+ce*V,O[U]=T%N;return D&&(O=[D].concat(O)),O}function R(O,P,N,j){var T,I;if(N!=j)I=N>j?1:-1;else for(T=I=0;T<N;T++)if(O[T]!=P[T]){I=O[T]>P[T]?1:-1;break}return I}function S(O,P,N,j){for(var T=0;N--;)O[N]-=T,T=O[N]<P[N]?1:0,O[N]=T*j+O[N]-P[N];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,P,N,j,T){var I,V,D,U,he,ce,Pe,ze,st,Te,Ye,xt,ao,ns,lo,jt,_i,Y=O.s==P.s?1:-1,_=O.c,L=P.c;if(!_||!_[0]||!L||!L[0])return new p(!O.s||!P.s||(_?L&&_[0]==L[0]:!L)?NaN:_&&_[0]==0||!L?Y*0:Y/0);for(ze=new p(Y),st=ze.c=[],V=O.e-P.e,Y=N+V+1,T||(T=l,V=y(O.e/u)-y(P.e/u),Y=Y/u|0),D=0;L[D]==(_[D]||0);D++);if(L[D]>(_[D]||0)&&V--,Y<0)st.push(1),U=!0;else{for(ns=_.length,jt=L.length,D=0,Y+=2,he=o(T/(L[0]+1)),he>1&&(L=v(L,he,T),_=v(_,he,T),jt=L.length,ns=_.length),ao=jt,Te=_.slice(0,jt),Ye=Te.length;Ye<jt;Te[Ye++]=0);_i=L.slice(),_i=[0].concat(_i),lo=L[0],L[1]>=T/2&&lo++;do{if(he=0,I=R(L,Te,jt,Ye),I<0){if(xt=Te[0],jt!=Ye&&(xt=xt*T+(Te[1]||0)),he=o(xt/lo),he>1)for(he>=T&&(he=T-1),ce=v(L,he,T),Pe=ce.length,Ye=Te.length;R(ce,Te,Pe,Ye)==1;)he--,S(ce,jt<Pe?_i:L,Pe,T),Pe=ce.length,I=1;else he==0&&(I=he=1),ce=L.slice(),Pe=ce.length;if(Pe<Ye&&(ce=[0].concat(ce)),S(Te,ce,Ye,T),Ye=Te.length,I==-1)for(;R(L,Te,jt,Ye)<1;)he++,S(Te,jt<Ye?_i:L,Ye,T),Ye=Te.length}else I===0&&(he++,Te=[0]);st[D++]=he,Te[0]?Te[Ye++]=_[ao]||0:(Te=[_[ao]],Ye=1)}while((ao++<ns||Te[0]!=null)&&Y--);U=Te[0]!=null,st[0]||st.splice(0,1)}if(T==l){for(D=1,Y=st[0];Y>=10;Y/=10,D++);G(ze,N+(ze.e=D+V*u-1)+1,j,U)}else ze.e=V,ze.r=+U;return ze}}();function H(v,R,S,O){var P,N,j,T,I;if(S==null?S=ve:b(S,0,8),!v.c)return v.toString();if(P=v.c[0],j=v.e,R==null)I=C(v.c),I=O==1||O==2&&(j<=ye||j>=Ie)?W(I,j):F(I,j,"0");else if(v=G(new p(v),R,S),N=v.e,I=C(v.c),T=I.length,O==1||O==2&&(R<=N||N<=ye)){for(;T<R;I+="0",T++);I=W(I,N)}else if(R-=j,I=F(I,N,"0"),N+1>T){if(--R>0)for(I+=".";R--;I+="0");}else if(R+=N-T,R>0)for(N+1==T&&(I+=".");R--;I+="0");return v.s<0&&P?"-"+I:I}function k(v,R){for(var S,O,P=1,N=new p(v[0]);P<v.length;P++)O=new p(v[P]),(!O.s||(S=E(N,O))===R||S===0&&N.s===R)&&(N=O);return N}function B(v,R,S){for(var O=1,P=R.length;!R[--P];R.pop());for(P=R[0];P>=10;P/=10,O++);return(S=O+S*u-1)>Me?v.c=v.e=null:S<Nt?v.c=[v.e=0]:(v.e=S,v.c=R),v}K=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,j,T,I){var V,D=T?j:j.replace(P,"");if(O.test(D))N.s=isNaN(D)?null:D<0?-1:1;else{if(!T&&(D=D.replace(v,function(U,he,ce){return V=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!I||I==V?he:U}),I&&(V=I,D=D.replace(R,"$1").replace(S,"0.$1")),j!=D))return new p(D,V);if(p.DEBUG)throw Error(s+"Not a"+(I?" base "+I:"")+" number: "+j);N.s=null}N.c=N.e=null}}();function G(v,R,S,O){var P,N,j,T,I,V,D,U=v.c,he=h;if(U){e:{for(P=1,T=U[0];T>=10;T/=10,P++);if(N=R-P,N<0)N+=u,j=R,I=U[V=0],D=o(I/he[P-j-1]%10);else if(V=r((N+1)/u),V>=U.length)if(O){for(;U.length<=V;U.push(0));I=D=0,P=1,N%=u,j=N-u+1}else break e;else{for(I=T=U[V],P=1;T>=10;T/=10,P++);N%=u,j=N-u+P,D=j<0?0:o(I/he[P-j-1]%10)}if(O=O||R<0||U[V+1]!=null||(j<0?I:I%he[P-j-1]),O=S<4?(D||O)&&(S==0||S==(v.s<0?3:2)):D>5||D==5&&(S==4||O||S==6&&(N>0?j>0?I/he[P-j]:0:U[V-1])%10&1||S==(v.s<0?8:7)),R<1||!U[0])return U.length=0,O?(R-=v.e+1,U[0]=he[(u-R%u)%u],v.e=-R||0):U[0]=v.e=0,v;if(N==0?(U.length=V,T=1,V--):(U.length=V+1,T=he[u-N],U[V]=j>0?o(I/he[P-j]%he[j])*T:0),O)for(;;)if(V==0){for(N=1,j=U[0];j>=10;j/=10,N++);for(j=U[0]+=T,T=1;j>=10;j/=10,T++);N!=T&&(v.e++,U[0]==l&&(U[0]=1));break}else{if(U[V]+=T,U[V]!=l)break;U[V--]=0,T=1}for(N=U.length;U[--N]===0;U.pop());}v.e>Me?v.c=v.e=null:v.e<Nt&&(v.c=[v.e=0])}return v}function X(v){var R,S=v.e;return S===null?v.toString():(R=C(v.c),R=S<=ye||S>=Ie?W(R,S):F(R,S,"0"),v.s<0?"-"+R:R)}return z.absoluteValue=z.abs=function(){var v=new p(this);return v.s<0&&(v.s=1),v},z.comparedTo=function(v,R){return E(this,new p(v,R))},z.decimalPlaces=z.dp=function(v,R){var S,O,P,N=this;if(v!=null)return b(v,0,f),R==null?R=ve:b(R,0,8),G(new p(N),v+N.e+1,R);if(!(S=N.c))return null;if(O=((P=S.length-1)-y(this.e/u))*u,P=S[P])for(;P%10==0;P/=10,O--);return O<0&&(O=0),O},z.dividedBy=z.div=function(v,R){return A(this,new p(v,R),ne,ve)},z.dividedToIntegerBy=z.idiv=function(v,R){return A(this,new p(v,R),0,1)},z.exponentiatedBy=z.pow=function(v,R){var S,O,P,N,j,T,I,V,D,U=this;if(v=new p(v),v.c&&!v.isInteger())throw Error(s+"Exponent not an integer: "+X(v));if(R!=null&&(R=new p(R)),T=v.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!v.c||!v.c[0])return D=new p(Math.pow(+X(U),T?v.s*(2-$(v)):+X(v))),R?D.mod(R):D;if(I=v.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);O=!I&&U.isInteger()&&R.isInteger(),O&&(U=U.mod(R))}else{if(v.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||T&&U.c[1]>=24e7:U.c[0]<8e13||T&&U.c[0]<=9999975e7)))return N=U.s<0&&$(v)?-0:0,U.e>-1&&(N=1/N),new p(I?1/N:N);gn&&(N=r(gn/u+2))}for(T?(S=new p(.5),I&&(v.s=1),V=$(v)):(P=Math.abs(+X(v)),V=P%2),D=new p(le);;){if(V){if(D=D.times(U),!D.c)break;N?D.c.length>N&&(D.c.length=N):O&&(D=D.mod(R))}if(P){if(P=o(P/2),P===0)break;V=P%2}else if(v=v.times(S),G(v,v.e+1,1),v.e>14)V=$(v);else{if(P=+X(v),P===0)break;V=P%2}U=U.times(U),N?U.c&&U.c.length>N&&(U.c.length=N):O&&(U=U.mod(R))}return O?D:(I&&(D=le.div(D)),R?D.mod(R):N?G(D,gn,ve,j):D)},z.integerValue=function(v){var R=new p(this);return v==null?v=ve:b(v,0,8),G(R,R.e+1,v)},z.isEqualTo=z.eq=function(v,R){return E(this,new p(v,R))===0},z.isFinite=function(){return!!this.c},z.isGreaterThan=z.gt=function(v,R){return E(this,new p(v,R))>0},z.isGreaterThanOrEqualTo=z.gte=function(v,R){return(R=E(this,new p(v,R)))===1||R===0},z.isInteger=function(){return!!this.c&&y(this.e/u)>this.c.length-2},z.isLessThan=z.lt=function(v,R){return E(this,new p(v,R))<0},z.isLessThanOrEqualTo=z.lte=function(v,R){return(R=E(this,new p(v,R)))===-1||R===0},z.isNaN=function(){return!this.s},z.isNegative=function(){return this.s<0},z.isPositive=function(){return this.s>0},z.isZero=function(){return!!this.c&&this.c[0]==0},z.minus=function(v,R){var S,O,P,N,j=this,T=j.s;if(v=new p(v,R),R=v.s,!T||!R)return new p(NaN);if(T!=R)return v.s=-R,j.plus(v);var I=j.e/u,V=v.e/u,D=j.c,U=v.c;if(!I||!V){if(!D||!U)return D?(v.s=-R,v):new p(U?j:NaN);if(!D[0]||!U[0])return U[0]?(v.s=-R,v):new p(D[0]?j:ve==3?-0:0)}if(I=y(I),V=y(V),D=D.slice(),T=I-V){for((N=T<0)?(T=-T,P=D):(V=I,P=U),P.reverse(),R=T;R--;P.push(0));P.reverse()}else for(O=(N=(T=D.length)<(R=U.length))?T:R,T=R=0;R<O;R++)if(D[R]!=U[R]){N=D[R]<U[R];break}if(N&&(P=D,D=U,U=P,v.s=-v.s),R=(O=U.length)-(S=D.length),R>0)for(;R--;D[S++]=0);for(R=l-1;O>T;){if(D[--O]<U[O]){for(S=O;S&&!D[--S];D[S]=R);--D[S],D[O]+=l}D[O]-=U[O]}for(;D[0]==0;D.splice(0,1),--V);return D[0]?B(v,D,V):(v.s=ve==3?-1:1,v.c=[v.e=0],v)},z.modulo=z.mod=function(v,R){var S,O,P=this;return v=new p(v,R),!P.c||!v.s||v.c&&!v.c[0]?new p(NaN):!v.c||P.c&&!P.c[0]?new p(P):(Rt==9?(O=v.s,v.s=1,S=A(P,v,0,3),v.s=O,S.s*=O):S=A(P,v,0,Rt),v=P.minus(S.times(v)),!v.c[0]&&Rt==1&&(v.s=P.s),v)},z.multipliedBy=z.times=function(v,R){var S,O,P,N,j,T,I,V,D,U,he,ce,Pe,ze,st,Te=this,Ye=Te.c,xt=(v=new p(v,R)).c;if(!Ye||!xt||!Ye[0]||!xt[0])return!Te.s||!v.s||Ye&&!Ye[0]&&!xt||xt&&!xt[0]&&!Ye?v.c=v.e=v.s=null:(v.s*=Te.s,!Ye||!xt?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(O=y(Te.e/u)+y(v.e/u),v.s*=Te.s,I=Ye.length,U=xt.length,I<U&&(Pe=Ye,Ye=xt,xt=Pe,P=I,I=U,U=P),P=I+U,Pe=[];P--;Pe.push(0));for(ze=l,st=d,P=U;--P>=0;){for(S=0,he=xt[P]%st,ce=xt[P]/st|0,j=I,N=P+j;N>P;)V=Ye[--j]%st,D=Ye[j]/st|0,T=ce*V+D*he,V=he*V+T%st*st+Pe[N]+S,S=(V/ze|0)+(T/st|0)+ce*D,Pe[N--]=V%ze;Pe[N]=S}return S?++O:Pe.splice(0,1),B(v,Pe,O)},z.negated=function(){var v=new p(this);return v.s=-v.s||null,v},z.plus=function(v,R){var S,O=this,P=O.s;if(v=new p(v,R),R=v.s,!P||!R)return new p(NaN);if(P!=R)return v.s=-R,O.minus(v);var N=O.e/u,j=v.e/u,T=O.c,I=v.c;if(!N||!j){if(!T||!I)return new p(P/0);if(!T[0]||!I[0])return I[0]?v:new p(T[0]?O:P*0)}if(N=y(N),j=y(j),T=T.slice(),P=N-j){for(P>0?(j=N,S=I):(P=-P,S=T),S.reverse();P--;S.push(0));S.reverse()}for(P=T.length,R=I.length,P-R<0&&(S=I,I=T,T=S,R=P),P=0;R;)P=(T[--R]=T[R]+I[R]+P)/l|0,T[R]=l===T[R]?0:T[R]%l;return P&&(T=[P].concat(T),++j),B(v,T,j)},z.precision=z.sd=function(v,R){var S,O,P,N=this;if(v!=null&&v!==!!v)return b(v,1,f),R==null?R=ve:b(R,0,8),G(new p(N),v,R);if(!(S=N.c))return null;if(P=S.length-1,O=P*u+1,P=S[P]){for(;P%10==0;P/=10,O--);for(P=S[0];P>=10;P/=10,O++);}return v&&N.e+1>O&&(O=N.e+1),O},z.shiftedBy=function(v){return b(v,-9007199254740991,c),this.times("1e"+v)},z.squareRoot=z.sqrt=function(){var v,R,S,O,P,N=this,j=N.c,T=N.s,I=N.e,V=ne+4,D=new p("0.5");if(T!==1||!j||!j[0])return new p(!T||T<0&&(!j||j[0])?NaN:j?N:1/0);if(T=Math.sqrt(+X(N)),T==0||T==1/0?(R=C(j),(R.length+I)%2==0&&(R+="0"),T=Math.sqrt(+R),I=y((I+1)/2)-(I<0||I%2),T==1/0?R="5e"+I:(R=T.toExponential(),R=R.slice(0,R.indexOf("e")+1)+I),S=new p(R)):S=new p(T+""),S.c[0]){for(I=S.e,T=I+V,T<3&&(T=0);;)if(P=S,S=D.times(P.plus(A(N,P,V,1))),C(P.c).slice(0,T)===(R=C(S.c)).slice(0,T))if(S.e<I&&--T,R=R.slice(T-3,T+1),R=="9999"||!O&&R=="4999"){if(!O&&(G(P,P.e+ne+2,0),P.times(P).eq(N))){S=P;break}V+=4,T+=4,O=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(G(S,S.e+ne+2,1),v=!S.times(S).eq(N));break}}return G(S,S.e+ne+1,ve,v)},z.toExponential=function(v,R){return v!=null&&(b(v,0,f),v++),H(this,v,R,1)},z.toFixed=function(v,R){return v!=null&&(b(v,0,f),v=v+this.e+1),H(this,v,R)},z.toFormat=function(v,R,S){var O,P=this;if(S==null)v!=null&&R&&typeof R=="object"?(S=R,R=null):v&&typeof v=="object"?(S=v,v=R=null):S=Sn;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(O=P.toFixed(v,R),P.c){var N,j=O.split("."),T=+S.groupSize,I=+S.secondaryGroupSize,V=S.groupSeparator||"",D=j[0],U=j[1],he=P.s<0,ce=he?D.slice(1):D,Pe=ce.length;if(I&&(N=T,T=I,I=N,Pe-=N),T>0&&Pe>0){for(N=Pe%T||T,D=ce.substr(0,N);N<Pe;N+=T)D+=V+ce.substr(N,T);I>0&&(D+=V+ce.slice(N)),he&&(D="-"+D)}O=U?D+(S.decimalSeparator||"")+((I=+S.fractionGroupSize)?U.replace(new RegExp("\\d{"+I+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):U):D}return(S.prefix||"")+O+(S.suffix||"")},z.toFraction=function(v){var R,S,O,P,N,j,T,I,V,D,U,he,ce=this,Pe=ce.c;if(v!=null&&(T=new p(v),!T.isInteger()&&(T.c||T.s!==1)||T.lt(le)))throw Error(s+"Argument "+(T.isInteger()?"out of range: ":"not an integer: ")+X(T));if(!Pe)return new p(ce);for(R=new p(le),V=S=new p(le),O=I=new p(le),he=C(Pe),N=R.e=he.length-ce.e-1,R.c[0]=h[(j=N%u)<0?u+j:j],v=!v||T.comparedTo(R)>0?N>0?R:V:T,j=Me,Me=1/0,T=new p(he),I.c[0]=0;D=A(T,R,0,1),P=S.plus(D.times(O)),P.comparedTo(v)!=1;)S=O,O=P,V=I.plus(D.times(P=V)),I=P,R=T.minus(D.times(P=R)),T=P;return P=A(v.minus(S),O,0,1),I=I.plus(P.times(V)),S=S.plus(P.times(O)),I.s=V.s=ce.s,N=N*2,U=A(V,O,N,ve).minus(ce).abs().comparedTo(A(I,S,N,ve).minus(ce).abs())<1?[V,O]:[I,S],Me=j,U},z.toNumber=function(){return+X(this)},z.toPrecision=function(v,R){return v!=null&&b(v,1,f),H(this,v,R,2)},z.toString=function(v){var R,S=this,O=S.s,P=S.e;return P===null?O?(R="Infinity",O<0&&(R="-"+R)):R="NaN":(v==null?R=P<=ye||P>=Ie?W(C(S.c),P):F(C(S.c),P,"0"):v===10&&w?(S=G(new p(S),ne+P+1,ve),R=F(C(S.c),S.e,"0")):(b(v,2,g.length,"Base"),R=Z(F(C(S.c),P,"0"),10,v,O,!0)),O<0&&S.c[0]&&(R="-"+R)),R},z.valueOf=z.toJSON=function(){return X(this)},z._isBigNumber=!0,x!=null&&p.set(x),p}function y(x){var A=x|0;return x>0||x===A?A:A-1}function C(x){for(var A,Z,K=1,z=x.length,le=x[0]+"";K<z;){for(A=x[K++]+"",Z=u-A.length;Z--;A="0"+A);le+=A}for(z=le.length;le.charCodeAt(--z)===48;);return le.slice(0,z+1||1)}function E(x,A){var Z,K,z=x.c,le=A.c,ne=x.s,ve=A.s,ye=x.e,Ie=A.e;if(!ne||!ve)return null;if(Z=z&&!z[0],K=le&&!le[0],Z||K)return Z?K?0:-ve:ne;if(ne!=ve)return ne;if(Z=ne<0,K=ye==Ie,!z||!le)return K?0:!z^Z?1:-1;if(!K)return ye>Ie^Z?1:-1;for(ve=(ye=z.length)<(Ie=le.length)?ye:Ie,ne=0;ne<ve;ne++)if(z[ne]!=le[ne])return z[ne]>le[ne]^Z?1:-1;return ye==Ie?0:ye>Ie^Z?1:-1}function b(x,A,Z,K){if(x<A||x>Z||x!==o(x))throw Error(s+(K||"Argument")+(typeof x=="number"?x<A||x>Z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(x))}function $(x){var A=x.c.length-1;return y(x.e/u)==A&&x.c[A]%2!=0}function W(x,A){return(x.length>1?x.charAt(0)+"."+x.slice(1):x)+(A<0?"e":"e+")+A}function F(x,A,Z){var K,z;if(A<0){for(z=Z+".";++A;z+=Z);x=z+x}else if(K=x.length,++A>K){for(z=Z,A-=K;--A;z+=Z);x+=z}else A<K&&(x=x.slice(0,A)+"."+x.slice(A));return x}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(lG)})(eO);var tO=eO.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const rr=nR(),xG=eR(),OG=tR,HG=tO,Cn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},ld={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:nO,decimalSuffixes:Lg}=rr.currentBytes(),iR={general:{scale:1024,suffixes:Lg},binary:{scale:1024,suffixes:nO},decimal:{scale:1e3,suffixes:Lg}};function AG(t,e={},n){if(typeof e=="string"&&(e=OG.parseFormat(e)),!xG.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",s=NG(t,e,n);return s=JG(s,r),s=eK(s,o),s}function NG(t,e,n){switch(e.output){case"currency":return e=su(e,rr.currentCurrencyDefaultFormat()),BG(t,e,rr);case"percent":return e=su(e,rr.currentPercentageDefaultFormat()),WG(t,e,rr,n);case"byte":return e=su(e,rr.currentByteDefaultFormat()),$G(t,e,rr,n);case"time":return e=su(e,rr.currentTimeDefaultFormat()),VG(t);case"ordinal":return e=su(e,rr.currentOrdinalDefaultFormat()),FG(t,e,rr);case"number":default:return ud({instance:t,providedFormat:e})}}function DG(t){let e=iR.decimal;return cw(t._value,e.suffixes,e.scale).suffix}function kG(t){let e=iR.binary;return cw(t._value,e.suffixes,e.scale).suffix}function LG(t){let e=iR.general;return cw(t._value,e.suffixes,e.scale).suffix}function cw(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(r>=s&&r<a){i=e[o],t=t/s;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function $G(t,e,n,i){let r=e.base||"binary",o=Object.assign({},ld,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Lg,marker:"bd"},binary:{scale:1024,suffixes:s||nO,marker:"b"},decimal:{scale:1e3,suffixes:a||Lg,marker:"d"}}[r],{value:c,suffix:h}=cw(t._value,u.suffixes,u.scale);return`${ud({instance:i(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function FG(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},ld,e),o=ud({instance:t,providedFormat:e,state:n}),s=i(t._value);return`${o}${r.spaceSeparated?" ":""}${s}`}function VG(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function WG(t,e,n,i){let r=e.prefixSymbol,o=ud({instance:i(t._value*100),providedFormat:e,state:n}),s=Object.assign({},ld,e);return r?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function BG(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},ld,r),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=ud({instance:t,providedFormat:r,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function jG({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&i[e]&&Cn[e]?(a=i[e],t=t/Cn[e]):l>=Cn.trillion||n&&s(l/Cn.trillion)===1?(a=i.trillion,t=t/Cn.trillion):l<Cn.trillion&&l>=Cn.billion||n&&s(l/Cn.billion)===1?(a=i.billion,t=t/Cn.billion):l<Cn.billion&&l>=Cn.million||n&&s(l/Cn.million)===1?(a=i.million,t=t/Cn.million):(l<Cn.million&&l>=Cn.thousand||n&&s(l/Cn.thousand)===1)&&(a=i.thousand,t=t/Cn.thousand),a&&(a=(r?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function UG({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function Jd(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function zG(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,s=""]=i.split(".");if(+r>0)n=o+s+Jd(r-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Jd(-r-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Jd(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${Jd(e)}`),n}function YG(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?zG(t,e):new HG(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function GG(t,e,n,i,r,o){if(i===-1)return t;let s=YG(e,i,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let u=l.match(/0+$/);return r&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function KG(t,e,n,i){let r=t,[o,s]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),r=r.slice(1)),o.length<i){let l=i-o.length;for(let u=0;u<l;u++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function qG(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function XG(t,e,n,i,r){let o=i.currentDelimiters(),s=o.thousands;r=r||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),qG(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+r+c:l=u,l}function ZG(t,e){return t+e}function QG(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function JG(t,e){return e+t}function eK(t,e){return t+e}function ud({instance:t,providedFormat:e,state:n=rr,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},ld,r,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,y=s.trimMantissa,C=s.thousandSeparated,E=s.spaceSeparated,b=s.negative,$=s.forceSign,W=s.exponential,F=s.roundingFunction,x="";if(d){let Z=jG({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:F,totalLength:a});o=Z.value,x+=Z.abbreviation,a&&(f=Z.mantissaPrecision)}if(W){let Z=UG({value:o,characteristicPrecision:l});o=Z.value,x=Z.abbreviation+x}let A=GG(o.toString(),o,m,f,y,F);return A=KG(A,o,u,l),A=XG(A,o,C,n,i),(d||W)&&(A=ZG(A,x)),($||o<0)&&(A=QG(A,o,b)),A}function su(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var tK=t=>({format:(...e)=>AG(...e,t),getByteUnit:(...e)=>LG(...e,t),getBinaryByteUnit:(...e)=>kG(...e,t),getDecimalByteUnit:(...e)=>DG(...e,t),formatOrDefault:su});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ko=tO;function nK(t,e,n){let i=new Ko(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new Ko(r),t._value=i.plus(r).toNumber(),t}function iO(t,e,n){let i=new Ko(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new Ko(r),t._value=i.minus(r).toNumber(),t}function iK(t,e,n){let i=new Ko(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new Ko(r),t._value=i.times(r).toNumber(),t}function rK(t,e,n){let i=new Ko(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new Ko(r),t._value=i.dividedBy(r).toNumber(),t}function oK(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function sK(t,e,n){let i=n(t._value);return iO(i,e,n),Math.abs(i._value)}var aK=t=>({add:(e,n)=>nK(e,n,t),subtract:(e,n)=>iO(e,n,t),multiply:(e,n)=>iK(e,n,t),divide:(e,n)=>rK(e,n,t),set:(e,n)=>oK(e,n,t),difference:(e,n)=>sK(e,n,t),BigNumber:Ko});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const lK="2.5.0",so=nR(),uK=eR(),cK=IG(Xt),hK=J1();let aa=tK(Xt),ka=aK(Xt);const dK=tR;class rO{constructor(e){this._value=e}clone(){return Xt(this._value)}format(e={}){return aa.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=dK.parseFormat(e)),e=aa.formatOrDefault(e,so.currentCurrencyDefaultFormat()),e.output="currency",aa.format(this,e)}formatTime(e={}){return e.output="time",aa.format(this,e)}binaryByteUnits(){return aa.getBinaryByteUnit(this)}decimalByteUnits(){return aa.getDecimalByteUnit(this)}byteUnits(){return aa.getByteUnit(this)}difference(e){return ka.difference(this,e)}add(e){return ka.add(this,e)}subtract(e){return ka.subtract(this,e)}multiply(e){return ka.multiply(this,e)}divide(e){return ka.divide(this,e)}set(e){return ka.set(this,oO(e))}value(){return this._value}valueOf(){return this._value}}function oO(t){let e=t;return Xt.isNumbro(t)?e=t._value:typeof t=="string"?e=Xt.unformat(t):isNaN(t)&&(e=NaN),e}function Xt(t){return new rO(oO(t))}Xt.version=lK;Xt.isNumbro=function(t){return t instanceof rO};Xt.language=so.currentLanguage;Xt.registerLanguage=so.registerLanguage;Xt.setLanguage=so.setLanguage;Xt.languages=so.languages;Xt.languageData=so.languageData;Xt.zeroFormat=so.setZeroFormat;Xt.defaultFormat=so.currentDefaults;Xt.setDefaults=so.setDefaults;Xt.defaultCurrencyFormat=so.currentCurrencyDefaultFormat;Xt.validate=uK.validate;Xt.loadLanguagesInNode=cK.loadLanguagesInNode;Xt.unformat=hK.unformat;Xt.BigNumber=ka.BigNumber;var fK=Xt,la=uG(fK);const gK="numeric";function sO(t,e){if(Vn(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!la.languages()[i]){const o=i.replace("-",""),s=la.allLanguages?la.allLanguages[i]:la[o];s&&la.registerLanguage(s)}la.setLanguage(i),t=la(t).format(r||"0")}return t}function rR(t,e,n,i,r,o,s){let a=o;if(Vn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=sO(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ts(t,e,n,i,r,a,s)}rR.RENDERER_TYPE=gK;const mK="password";function oR(t,e,n,i,r,o,s){ts.apply(this,[t,e,n,i,r,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";pe(a-1,()=>{u+=l}),Wu(e,u)}oR.RENDERER_TYPE=mK;const pK="select";function sR(t,e,n,i,r,o,s){ts.apply(this,[t,e,n,i,r,o,s])}sR.RENDERER_TYPE=pK;const wK="time";function aR(t,e,n,i,r,o,s){ts.apply(this,[t,e,n,i,r,o,s]),e.dir="ltr"}aR.RENDERER_TYPE=wK;function vK(){Oi(zu),Oi(ad),Oi(ZS),Oi(XS),Oi(JS),Oi(qS),Oi(rR),Oi(oR),Oi(sR),Oi(ts),Oi(aR)}const CK="autocomplete";function hw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,GT(n,e)):GT(n,e)(this.source):e(!0)}hw.VALIDATOR_TYPE=CK;function GT(t,e){const n=t;return function(i){let r=!1;for(let o=0,s=i.length;o<s;o++)if(n===i[o]){r=!0;break}e(r)}}function yK(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const bK="date";function lR(t,e){const n=kx(z1,this.instance);let i=t,r=!0;i==null&&(i="");let o=Q(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Q(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(s=!0,o=!0),s||(r=!1),!s&&o&&(r=!0),s&&!o)if(this.correctFormat===!0){const a=SK(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}lR.VALIDATOR_TYPE=bK;function SK(t,e){const n=Q(yK(t)),i=Q(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const RK="dropdown";function uR(t,e){hw.apply(this,[t,e])}uR.VALIDATOR_TYPE=RK;const EK="numeric";function cR(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vn(t))}cR.VALIDATOR_TYPE=EK;const _K=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],TK="time";function hR(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const s=Q(r,_K,!0).isValid()?Q(r):Q(r,n);let a=s.isValid(),l=Q(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}hR.VALIDATOR_TYPE=TK;function MK(){ou(hw),ou(uR),ou(lR),ou(cR),ou(hR)}const PK="autocomplete",IK={CELL_TYPE:PK,editor:GS,renderer:zu,validator:hw},xK="checkbox",OK={CELL_TYPE:xK,editor:U1,renderer:ZS},HK="date";function aO(t,e,n,i,r,o,s){zu.apply(this,[t,e,n,i,r,o,s])}aO.RENDERER_TYPE=HK;const AK="date",NK={CELL_TYPE:AK,editor:Y1,renderer:aO,validator:lR},DK="dropdown",kK={CELL_TYPE:DK,editor:G1,renderer:XS,validator:uR,filter:!1,strict:!0},LK="handsontable",$K={CELL_TYPE:LK,editor:YS,renderer:JS},FK="numeric",VK={CELL_TYPE:FK,editor:K1,renderer:rR,validator:cR,dataType:"number"},WK="password",BK={CELL_TYPE:WK,editor:q1,renderer:oR,copyable:!1},jK="select",UK={CELL_TYPE:jK,editor:X1,renderer:sR},zK="time",YK={CELL_TYPE:zK,editor:Z1,renderer:aR,validator:hR};function GK(){nr(IK),nr(OK),nr(NK),nr(kK),nr($K),nr(VK),nr(BK),nr(UK),nr(V1),nr(YK)}function KK(t,e){lO(t,e),e.add(t)}function qK(t,e,n){lO(t,e),e.set(t,n)}function lO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(t,e,n){return(e=XK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=ZK(t,"string");return typeof e=="symbol"?e:e+""}function ZK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hl(t,e){return t.get(uO(t,e))}function uO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KT=new Map([["plugin",xV],["cell-type",x1],["editor",Dx],["renderer",jx],["validator",Ux]]),cO=Symbol("mainSetting"),QK="base",ef=[];let ua=null;var ca=new WeakMap,qT=new WeakSet;class nt{static get PLUGIN_KEY(){return QK}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){KK(this,qT),Ol(this,"eventManager",new wr(this)),Ol(this,"pluginName",null),Ol(this,"pluginsInitializedCallbacks",[]),Ol(this,"isPluginsReady",!1),Ol(this,"enabled",!1),Ol(this,"initialized",!1),qK(this,ca,{}),Jo(this,"hot",e,{writable:!1}),ua=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!KT.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);KT.get(s)(a)||r.push(` - ${a} (${s})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");ef.push(o)}}if(ua||(ua=Bx()),ua.indexOf(this.pluginName)>=0&&ua.splice(ua.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ua.length===0){if(ef.length>0){const r=[`${ef.join(`
`)}
`,"You have to import and register them manually."].join("");throw ef.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||We(n))&&i[cO]===e){var r;return Array.isArray(n)?n:(r=n[e])!==null&&r!==void 0?r:i[e]}if(We(n)){var o;return(o=n[e])!==null&&o!==void 0?o:i[e]}return i[e]}addHook(e,n,i){Hl(ca,this)[e]=Hl(ca,this)[e]||[];const r=Hl(ca,this)[e];this.hot.addHook(e,n,i),r.push(n),Hl(ca,this)[e]=r}removeHooks(e){M(Hl(ca,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Hl(ca,this);Be(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=uO(qT,this,JK).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Be(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function JK(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ha(t,e,n){return(e=eq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eq(t){var e=tq(t,"string");return typeof e=="symbol"?e:e+""}function tq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let hO=class{constructor(e){ha(this,"hot",null),ha(this,"container",null),ha(this,"injected",!1),ha(this,"rows",[]),ha(this,"columns",[]),ha(this,"samples",null),ha(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{M(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{M(r.strings,o=>{const s=o.col,a=e.createElement("th");i.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(i,r=>{const[o,s]=r;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{M(r.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let s=e+1;s<e+r;s++)o+=this.hot.getColWidth(s);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(l),r.appendChild(s),q(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function tf(t,e,n){return(e=nq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nq(t){var e=iq(t,"string");return typeof e=="symbol"?e:e+""}function iq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dw{static get SAMPLE_COUNT(){return 3}constructor(e){tf(this,"samples",null),tf(this,"dataFactory",null),tf(this,"customSampleCount",null),tf(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:dw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:s}=typeof i=="number"?{from:i,to:i}:i;return pe(o,s,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",s=[];return pe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:We(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${At(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),r}}function rq(t,e){dO(t,e),e.add(t)}function cC(t,e,n){dO(t,e),e.set(t,n)}function dO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mc(t,e,n){return(e=oq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oq(t){var e=sq(t,"string");return typeof e=="symbol"?e:e+""}function sq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hs(t,e){return t.get(ni(t,e))}function $g(t,e,n){return t.set(ni(t,e),n),n}function ni(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("modifyAutoColumnSizeSeed");const hC="autoColumnSize",aq=10,lq="autoColumnSize";var dR=new WeakMap,au=new WeakMap,Au=new WeakMap,mi=new WeakSet;class uh extends nt{static get PLUGIN_KEY(){return hC}static get PLUGIN_PRIORITY(){return aq}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),rq(this,mi),mc(this,"ghostTable",new hO(this.hot)),mc(this,"samplesGenerator",new dw((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,i);let a="";s.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),mc(this,"inProgress",!1),mc(this,"measuredColumns",0),mc(this,"columnWidthsMap",new zs),cC(this,dR,!1),cC(this,au,[]),cC(this,Au,[]),this.hot.columnIndexMapper.registerMap(lq,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>ni(mi,this,XT).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[hC]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ni(mi,e,hq).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ni(mi,e,dq).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ni(mi,e,gq).call(e,...r)}),this.addHook("beforeRender",()=>ni(mi,this,cq).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>ni(mi,this,fq).call(this)),super.enablePlugin()}updatePlugin(){$g(Au,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>ni(mi,this,XT).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;pe(r.from,r.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ni(mi,this,fO).call(this,s,o)}),this.ghostTable.columns.length&&(ni(mi,this,gO).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Og(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+uh.CALCULATION_STEP,r)},e,n),i=i+uh.CALCULATION_STEP+1,i<r?o=xg(s):(Og(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[hC];let n=uh.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return We(e)&&(n=e.syncLimit,sx(n)?n=Fx(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Iu))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const s=Hs(au,this).length;return(s-1<o||Hs(au,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),s-1<o?Hs(au,this).push(r):Hs(au,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function uq(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||ni(mi,this,fO).call(this,n,e))}),this.ghostTable.columns.length&&(ni(mi,this,gO).call(this),this.ghostTable.clean())}function fO(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function gO(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function cq(){this.calculateVisibleColumnsWidth(),this.inProgress||(ni(mi,this,uq).call(this,Hs(Au,this)),$g(Au,this,[]))}function hq(t,e){e||this.recalculateAllColumnsWidth()}function dq(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Hs(Au,this).push(...e)}function XT(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function fq(){$g(au,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),$g(dR,this,!0)}function gq(t){if(!Hs(dR,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Hs(Au,this).push(...e)}const ja={horizontal:"horizontal",vertical:"vertical"};function mq(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function pq(t){const e={};return t===!0?(e.directions=Object.keys(ja),e.autoInsertRow=!0):We(t)?(de(t.autoInsertRow)?t.direction===ja.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,de(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(ja)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function wq(t,e){vq(t,e),e.add(t)}function vq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){return(e=Cq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cq(t){var e=yq(t,"string");return typeof e=="symbol"?e:e+""}function yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("modifyAutofillRange");se.getSingleton().register("beforeAutofill");se.getSingleton().register("afterAutofill");const ZT="autofill",bq=20,Sq=["fillHandle"],Rq="insert_row_below",Eq=200;var Nl=new WeakSet;class _q extends nt{constructor(){super(...arguments),wq(this,Nl),Al(this,"addingStarted",!1),Al(this,"mouseDownOnCellCorner",!1),Al(this,"mouseDragOutside",!1),Al(this,"handleDraggedCells",0),Al(this,"directions",[]),Al(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return ZT}static get PLUGIN_PRIORITY(){return bq}static get SETTING_KEYS(){return[ZT,...Sq]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>pc(Nl,this,Mq).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>pc(Nl,this,Tq).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>pc(Nl,this,Pq).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=mq(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=o.clone(),y=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",f,m,y,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=C;const b=C;if(["up","left"].indexOf(c)>-1&&!(b.length===1&&b[0].length===0))if(E=[],c==="up"){const $=d.row-h.row+1,W=$%b.length;for(let F=0;F<$;F++)E.push(b[(F+(b.length-W))%b.length])}else{const $=d.col-h.col+1,W=$%b[0].length;for(let F=0;F<b.length;F++){E.push([]);for(let x=0;x<$;x++)E[F].push(b[F][(x+(b[F].length-W))%b[F].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,m,y,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(ja.vertical)&&this.directions.includes(ja.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(ja.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(ja.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Rq,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Eq)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!qt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!qt(s)||!qt(a))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ge(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=xn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+an(this.hot.table),r=xn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Jt(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>pc(Nl,this,Iq).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>pc(Nl,this,xq).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=pq(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Tq(){this.selectAdjacent()&&this.fillIn()}function Mq(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Pq(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Iq(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function xq(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Oq(t,e){mO(t,e),e.add(t)}function QT(t,e,n){mO(t,e),e.set(t,n)}function mO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dl(t,e,n){return(e=Hq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hq(t){var e=Aq(t,"string");return typeof e=="symbol"?e:e+""}function Aq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pO(t,e,n){return t.set(Ur(t,e),n),n}function Fg(t,e){return t.get(Ur(t,e))}function Ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dC="autoRowSize",Nq=40,Dq="autoRowSize";var Lh=new WeakMap,fR=new WeakMap,Eo=new WeakSet;class ch extends nt{static get PLUGIN_KEY(){return dC}static get PLUGIN_PRIORITY(){return Nq}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Oq(this,Eo),Dl(this,"headerHeight",null),Dl(this,"ghostTable",new hO(this.hot)),Dl(this,"samplesGenerator",new dw((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,i):n===-1&&(s=this.hot.getColHeader(i)),{value:s}})),Dl(this,"inProgress",!1),Dl(this,"measuredRows",0),Dl(this,"rowHeightsMap",new zs),QT(this,Lh,[]),QT(this,fR,!1),this.hot.rowIndexMapper.registerMap(Dq,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Ur(Eo,this,JT).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[dC];return e===!0||We(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ur(Eo,e,$q).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ur(Eo,e,Fq).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ur(Eo,e,Wq).call(e,...r)}),this.addHook("beforeRender",()=>Ur(Eo,this,Lq).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>Ur(Eo,this,Vq).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>Ur(Eo,this,JT).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}pe(r.from,r.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Og(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+ch.CALCULATION_STEP,r)},e,n),i=i+ch.CALCULATION_STEP+1,i<r?o=xg(s):(Og(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[dC];let n=ch.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return We(e)&&(n=e.syncLimit,sx(n)?n=Fx(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pe(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function kq(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function Lq(){this.calculateVisibleRowsHeight(),this.inProgress||(Ur(Eo,this,kq).call(this,Fg(Lh,this)),pO(Lh,this,[]))}function JT(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function $q(t,e){e||this.recalculateAllRowsHeight()}function Fq(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);Fg(Lh,this).push(...e)}function Vq(){this.recalculateAllRowsHeight(),pO(fR,this,!0)}function Wq(t){if(!Fg(fR,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Fg(Lh,this).push(...e)}const{getListWithInsertedItems:Bq,getListWithRemovedItems:jq}=f1("physicallyIndexed");class Uq extends pl{constructor(){super(e=>e)}insert(e,n){const i=kS(this.indexedValues,n);this.indexedValues=Bq(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=jq(this.indexedValues,e);this.indexedValues=DS(n,e),super.remove(e)}}const{getListWithInsertedItems:zq,getListWithRemovedItems:Yq}=f1("physicallyIndexed");class Gq extends pl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=zq(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=Yq(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Kq(t,e){qq(t,e),e.add(t)}function qq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xq(t,e,n){return(e=Zq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zq(t){var e=Qq(t,"string");return typeof e=="symbol"?e:e+""}function Qq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eM="bindRowsWithHeaders",e3=210,t3="loose",tM=new Map([["loose",Uq],["strict",Gq]]);var nM=new WeakSet;class n3 extends nt{constructor(){super(...arguments),Kq(this,nM),Xq(this,"headerIndexes",null)}static get PLUGIN_KEY(){return eM}static get PLUGIN_PRIORITY(){return e3}isEnabled(){return!!this.hot.getSettings()[eM]}enablePlugin(){var e;if(this.enabled)return;const n=(e=tM.get(this.getSetting()))!==null&&e!==void 0?e:tM.get(t3);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>Jq(nM,this,i3).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function i3(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function r3(t,e){wO(t,e),e.add(t)}function o3(t,e,n){wO(t,e),e.set(t,n)}function wO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iM(t,e,n){return(e=s3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rM(t,e){return t.get(gu(t,e))}function fC(t,e,n){return t.set(gu(t,e),n),n}function gu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lg="collapsibleColumns",l3=290,u3=["nestedHeaders"],Eu="collapsibleIndicator",oM=lg,sM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var kl=new WeakMap,wc=new WeakSet;class c3 extends nt{constructor(){super(...arguments),r3(this,wc),iM(this,"nestedHeadersPlugin",null),iM(this,"headerStateManager",null),o3(this,kl,null)}static get PLUGIN_KEY(){return lg}static get PLUGIN_PRIORITY(){return l3}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[lg,...u3]}isEnabled(){return!!this.hot.getSettings()[lg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||it("You need to configure the Nested Headers plugin in order to use collapsible headers."),fC(kl,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>gu(wc,this,f3).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return gu(wc,e,g3).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return gu(wc,e,h3).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>gu(wc,this,d3).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),fC(kl,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:oM,relativeToGroup:Ys,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oM)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};pe(0,e-1,s=>{const a=n.childNodes[s],l=i.childNodes[s],u=r?r.childNodes[s]:null;pe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Eu}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Eu}`),o(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Eu}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(r===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!sM.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Za(e,f=>{let{row:m}=f;return m<0});let r=i.length>0;M(i,f=>{var m;let{row:y,col:C}=f;const{collapsible:E,isCollapsed:b}=(m=this.headerStateManager.getHeaderSettings(y,C))!==null&&m!==void 0?m:{};if(!E||b&&n==="collapse"||!b&&n==="expand")return r=!1,!1});const o=[],s=[];r&&M(i,f=>{let{row:m,col:y}=f;const{colspanCompensation:C,affectedColumns:E,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,m,y);C>0&&(s.push(...E),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=k$([...a,...s]):n==="expand"&&(l=Za(a,f=>!s.includes(f)));const u=sM.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){M(o,f=>{f()});return}this.hot.batchExecution(()=>{M(s,f=>{rM(kl,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const C=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;C!==null&&E!==null&&this.hot.selectCell(C,E)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return rM(kl,this).getHiddenIndexes()}destroy(){fC(kl,this,null),super.destroy()}}function h3(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Eu}`);if(Vu(e,[Bi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Eu),e.querySelector("div:first-child").appendChild(u)),be(u,["collapsed","expanded"]),s?(q(u,"collapsed"),Ja(u,"+"),l&&Ee(e,...Bi(!1))):(q(u,"expanded"),Ja(u,"-"),l&&Ee(e,...Bi(!0))),l&&Ee(u,...ml());else{var c;(c=u)===null||c===void 0||c.remove()}}function d3(t,e){Se(t.target,Eu)&&(Se(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Se(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Cr(t))}function f3(){this.updatePlugin()}function g3(t,e){e||this.updatePlugin()}function da(t,e,n){return(e=m3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m3(t){var e=p3(t,"string");return typeof e=="symbol"?e:e+""}function p3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const w3=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],v3=!1,C3=!0,y3=!0;class b3{constructor(e,n){da(this,"hot",void 0),da(this,"sortingStates",new Bm),da(this,"sortEmptyCells",v3),da(this,"indicator",C3),da(this,"headerAction",y3),da(this,"compareFunctionFactory",void 0),da(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){We(e)&&Be(e,(n,i)=>{w3.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return We(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(de(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function vO(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:s}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?Qr:qt(r)?qt(o)?Qr:s&&t==="asc"?Vt:Wt:qt(o)?s&&t==="asc"?Wt:Vt:isNaN(r)&&!isNaN(o)?t==="asc"?Wt:Vt:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?Vt:Wt:r>o?t==="asc"?Wt:Vt:Qr}}const CO="default";function S3(t,e,n){return function(i,r){const o=parseFloat(i),s=parseFloat(r),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Qr;if(a){if(qt(i))return t==="asc"?Vt:Wt;if(qt(r))return t==="asc"?Wt:Vt}return isNaN(o)?Wt:isNaN(s)?Vt:o<s?t==="asc"?Vt:Wt:o>s?t==="asc"?Wt:Vt:Qr}}const R3="numeric";function E3(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=qt(s),u=qt(a),c=l?r:s,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(o===!1){if(l&&u===!1)return Wt;if(l===!1&&u)return Vt}return d===!1&&f?t==="asc"?Vt:Wt:d&&f===!1?t==="asc"?Wt:Vt:d===!1&&f===!1?vO(t,e,n)(s,a):c===r&&h===i?t==="asc"?Vt:Wt:c===i&&h===r?t==="asc"?Wt:Vt:Qr}}const _3="checkbox";function T3(t,e,n){return _O(t,e.dateFormat,n)}const M3="date";function P3(t,e,n){return _O(t,e.timeFormat,n)}const I3="time",{register:cd,getItem:aM,hasItem:x3}=yr("sorting.compareFunctionFactory"),{register:yO,getItem:O3}=yr("sorting.mainSortComparator");function bO(t){return x3(t)?aM(t):aM(CO)}cd(_3,E3);cd(M3,T3);cd(CO,vO);cd(R3,S3);cd(I3,P3);const Qr=0,Vt=-1,Wt=1;function H3(t,e){const n=O3(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const Vg="asc",Wg="desc",SO="colHeader";function A3(t){if(We(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Vg,Wg].includes(n)}function N3(t){if(t.some(n=>A3(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function lM(t){if(t!==Wg)return t===Vg?Wg:Vg}function RO(t){return t.querySelector(`.${SO}`)}function EO(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function gR(t,e,n){return t===-1&&e>=0&&el(n)===!1}function _O(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return Qr;if(qt(i))return qt(r)?Qr:o&&t==="asc"?Vt:Wt;if(qt(r))return o&&t==="asc"?Wt:Vt;const s=Q(i,e),a=Q(r,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Vt:Wt:a.isBefore(s)?t==="asc"?Wt:Vt:Qr:Vt:Wt}}function D3(t,e){it(ut`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const k3="ascending",L3="descending",TO="indicatorDisabled",MO="columnSorting",PO="sortAction",IO=new Map([[Vg,k3],[Wg,L3]]);function $3(t,e,n,i){const r=[MO];if(i&&r.push(PO),n===!1)return r.push(TO),r;const o=t.getSortOrderOfColumn(e);return de(o)&&r.push(IO.get(o)),r}function F3(){return Array.from(IO.values()).concat(PO,TO,MO)}function V3(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:bO(u.type))(l,u,d)(c,h)}(0)}}function W3(t,e){B3(t,e),e.add(t)}function B3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nf(t,e,n){return(e=j3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j3(t){var e=U3(t,"string");return typeof e=="symbol"?e:e+""}function U3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bg="columnSorting",z3=50,jg="append",Y3="replace",uM=Bg;yO(Bg,V3);se.getSingleton().register("beforeColumnSort");se.getSingleton().register("afterColumnSort");const vc=new WeakMap;var La=new WeakSet;class xO extends nt{constructor(){super(...arguments),W3(this,La),nf(this,"columnStatesManager",null),nf(this,"columnMetaCache",null),nf(this,"pluginKey",Bg),nf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Bg}static get PLUGIN_PRIORITY(){return z3}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(vc.has(this.hot)&&vc.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),D3(vc.get(this.hot),this.pluginKey);return}this.enabled||(vc.set(this.hot,this.pluginKey),this.columnStatesManager=new b3(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new zs(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>lu(La,this,G3).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lu(La,e,q3).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>lu(La,this,tb).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lu(La,e,K3).call(e,...i)}),this.hot.view&&lu(La,this,tb).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=RO(i);EO(n,i)===!1||r===null||this.updateHeaderClasses(r)};vc.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Ys,position:"before",group:uM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uM)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new g1),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return de(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return N3(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...s}=r;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ge(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...s}=r;return{column:this.hot.toVisualColumn(o),...s}};return de(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ge(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(de(n)){const r=lM(n);return de(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:lM()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jg;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(r){if(Ht(s))return[...o.slice(0,i),...o.slice(i+1)];if(n===jg)return[...o.slice(0,i),...o.slice(i+1),s];if(n===Y3)return[...o.slice(0,i),s,...o.slice(i+1)]}return de(s)?o.concat(s):o}getPluginColumnConfig(e){if(We(e)){const n=e[this.pluginKey];if(We(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):ft(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>Ge(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const o=Ge(n,u=>u[0]);H3(n,this.pluginKey,Ge(e,u=>u.sortOrder),Ge(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const s=Ge(n,u=>u[0]),a=new Map(Ge(o,(u,c)=>[u,s[c]])),l=Ge(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(We(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||We(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(be(e,F3()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];q(e,$3(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),de(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Se(e.target,SO)}onAfterOnCellMouseDown(e,n){if(gR(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function tb(){const t=this.getAllSavedSortSettings();if(We(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function G3(t,e){const n=RO(e);if(EO(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ee(e,...iF(s?`${s}ending`:"none"))}}function K3(t){t===!0&&this.hot.view&&lu(La,this,tb).call(this)}function q3(t,e,n,i){gR(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function fa(t,e,n){return(e=X3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X3(t){var e=Z3(t,"string");return typeof e=="symbol"?e:e+""}function Z3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q3{constructor(e,n){fa(this,"plugin",void 0),fa(this,"hot",void 0),fa(this,"endpoints",[]),fa(this,"settings",void 0),fa(this,"settingsType","array"),fa(this,"currentEndpoint",null),fa(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),M(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{r==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),r==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));r.push(s)}),M(r,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),i.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,i=>{M(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,s=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[r][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){it("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function gC(t){return t==null||isNaN(t)}function J3(t,e){eX(t,e),e.add(t)}function eX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tX(t,e,n){return(e=nX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mC="columnSummary",rX=220;var Cc=new WeakSet;class oX extends nt{constructor(){super(...arguments),J3(this,Cc),tX(this,"endpoints",null)}static get PLUGIN_KEY(){return mC}static get PLUGIN_PRIORITY(){return rX}isEnabled(){return!!this.hot.getSettings()[mC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[mC],this.endpoints=new Q3(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return rf(Cc,e,sX).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return rf(Cc,e,lX).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return rf(Cc,e,aX).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return rf(Cc,e,uX).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Be(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(r,n),o=gC(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**s)/10**s}calculateMinMax(e,n){let i=null;return Be(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=gC(s)?null:s,r===null)r=s;else if(s!==null)switch(i){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=gC(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return Be(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,s=this.countEmpty(r,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(i!==null&&r!==null&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ut`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function sX(){this.endpoints.initEndpoints()}function aX(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function lX(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function uX(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function cX(t,e){OO(t,e),e.add(t)}function pC(t,e,n){OO(t,e),e.set(t,n)}function OO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uu(t,e){return t.get(mR(t,e))}function nb(t,e,n){return t.set(mR(t,e),n),n}function mR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ug=new WeakMap,of=new WeakMap,sf=new WeakMap,cM=new WeakSet;class HO{constructor(){cX(this,cM),pC(this,Ug,!0),pC(this,of,null),pC(this,sf,new ResizeObserver(e=>mR(cM,this,hX).call(this,e)))}setObservedElement(e){nb(of,this,e)}unobserve(){uu(sf,this).unobserve(uu(of,this))}observe(){nb(Ug,this,!0),uu(sf,this).observe(uu(of,this))}destroy(){uu(sf,this).disconnect()}}function hX(t){if(uu(Ug,this)||!Array.isArray(t)||!t.length){nb(Ug,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}wt(HO,bn);function ga(t,e,n){dX(t,e),e.set(t,n)}function dX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(AO(t,e))}function vo(t,e,n){return t.set(AO(t,e),n),n}function AO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ma=new WeakMap,wC=new WeakMap,Co=new WeakMap,as=new WeakMap,ls=new WeakMap,af=new WeakMap,Ll=new WeakMap;class Ua{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;ga(this,ma,void 0),ga(this,wC,!1),ga(this,Co,null),ga(this,as,void 0),ga(this,ls,void 0),ga(this,af,!0),ga(this,Ll,new HO),vo(ma,this,e),vo(wC,this,n),vo(as,this,this.createEditor()),vo(ls,this,mt(as,this).style),mt(Ll,this).setObservedElement(this.getInputElement()),mt(Ll,this).addLocalHook("resize",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){mt(ls,this).left=`${e}px`,mt(ls,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:Jt(this.getInputElement()),height:an(this.getInputElement())}}observeSize(){mt(Ll,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(ls,this).display="block",vo(af,this,!1)}hide(){mt(Ll,this).unobserve(),mt(af,this)||(mt(ls,this).display="none"),vo(af,this,!0)}isVisible(){return mt(ls,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(ma,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(ma,this).createElement("div"),n=mt(ma,this).createElement("textarea");return e.style.display="none",vo(Co,this,mt(ma,this).createElement("div")),mt(Co,this).setAttribute("dir",mt(wC,this)?"rtl":"ltr"),q(mt(Co,this),Ua.CLASS_EDITOR_CONTAINER),mt(ma,this).body.appendChild(mt(Co,this)),q(e,Ua.CLASS_EDITOR),q(n,Ua.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(Co,this).appendChild(e),e}getInputElement(){return mt(as,this).querySelector(`.${Ua.CLASS_INPUT}`)}getEditorElement(){return mt(as,this)}destroy(){const e=mt(Co,this)?mt(Co,this).parentNode:null;mt(as,this).parentNode.removeChild(mt(as,this)),vo(as,this,null),vo(ls,this,null),mt(Ll,this).destroy(),e&&e.removeChild(mt(Co,this))}}wt(Ua,bn);function vC(t,e,n){return(e=fX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:e+""}function gX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mX=250,pX=250;class NO{constructor(e){vC(this,"wasLastActionShow",!0),vC(this,"showDebounced",null),vC(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},pX)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mX;this.showDebounced=km(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}wt(NO,bn);function wX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function vX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function pa(t,e){const n={};return M(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function ys(t,e,n,i,r){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&CX(s,a,e,n,i,r)})})}function CX(t,e,n,i,r,o){const s=r(t,e);let a=i;s.className&&(n==="vertical"?a=wX(s.className,i):a=vX(s.className,i)),o(t,e,"className",a)}function DO(t){return`<span class="selected">✓</span>${t}`}function ug(t,e){let n=!1;return Array.isArray(t)&&M(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function fw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const Ve="---------";function yX(){return{name:Ve}}const Di="alignment";function bX(){return{key:Di,name(){return this.getTranslatedPhrase(hp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Di}:left`,name(){return this.getTranslatedPhrase(dp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:center`,name(){return this.getTranslatedPhrase(fp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:right`,name(){return this.getTranslatedPhrase(gp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:justify`,name(){return this.getTranslatedPhrase(mp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{name:Ve},{key:`${Di}:top`,name(){return this.getTranslatedPhrase(pp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:middle`,name(){return this.getTranslatedPhrase(wp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:bottom`,name(){return this.getTranslatedPhrase(vp)},callback(){const t=this.getSelectedRange(),e=pa(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),ys(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1}]}}}const gw="clear_column";function SX(){return{key:gw,name(){return this.getTranslatedPhrase(Zm)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const hd="col_left";function RX(){return{key:hd,name(){return this.getTranslatedPhrase(zm)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const dd="col_right";function EX(){return{key:dd,name(){return this.getTranslatedPhrase(Ym)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const fd="make_read_only";function _X(){return{key:fd,checkable:!0,ariaChecked(){return ug(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Nh)},name(){let t=this.getTranslatedPhrase(Nh);return ug(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=DO(t)),t},callback(){const t=this.getSelectedRange(),e=ug(t,(n,i)=>this.getCellMeta(n,i).readOnly);M(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const mw="redo";function TX(){return{key:mw,name(){return this.getTranslatedPhrase(Xm)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const gd="remove_col";function MX(){return{key:gd,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(Km,e)},callback(){this.alter("remove_col",tz(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const pw="remove_row";function PX(){return{key:pw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(Gm,e)},callback(){this.alter("remove_row",nz(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const ww="row_above";function IX(){return{key:ww,name(){return this.getTranslatedPhrase(jm)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const vw="row_below";function xX(){return{key:vw,name(){return this.getTranslatedPhrase(Um)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const $h="no_items";function OX(){return{key:$h,name(){return this.getTranslatedPhrase($S)},disabled:!0,isCommand:!1}}const Cw="undo";function HX(){return{key:Cw,name(){return this.getTranslatedPhrase(qm)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const AX=[ww,vw,hd,dd,gw,pw,gd,Cw,mw,fd,Di,Ve,$h],NX={[Ve]:yX,[$h]:OX,[ww]:IX,[vw]:xX,[hd]:RX,[dd]:EX,[gw]:SX,[pw]:PX,[gd]:MX,[Cw]:HX,[mw]:TX,[fd]:_X,[Di]:bX};function kO(){const t={};return Be(NX,(e,n)=>{t[n]=e()}),t}function DX(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(lp):this.getTranslatedPhrase(ap)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function kX(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(up)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function LX(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(cp);return ug(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,cg))?DO(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,cg);t.updateCommentMeta(n,i,{[cg]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function $X(t,e){LO(t,e),e.add(t)}function $l(t,e,n){LO(t,e),e.set(t,n)}function LO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FX(t,e,n){return(e=VX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VX(t){var e=WX(t,"string");return typeof e=="symbol"?e:e+""}function WX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function As(t,e,n){return t.set(Xn(t,e),n),n}function ke(t,e){return t.get(Xn(t,e))}function Xn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zg="comments",BX=60,Io="comment",Zc="value",$O="style",cg="readOnly",yc=zg,ib=`plugin:${zg}`;var dt=new WeakMap,Wr=new WeakMap,yw=new WeakMap,hg=new WeakMap,rb=new WeakMap,Yg=new WeakMap,li=new WeakSet;class jX extends nt{constructor(){super(...arguments),$X(this,li),FX(this,"range",{}),$l(this,dt,null),$l(this,Wr,null),$l(this,yw,!1),$l(this,hg,!1),$l(this,rb,null),$l(this,Yg,"")}static get PLUGIN_KEY(){return zg}static get PLUGIN_PRIORITY(){return BX}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[zg]}enablePlugin(){var e=this;this.enabled||(ke(dt,this)||(As(dt,this,new Ua(this.hot.rootDocument,this.hot.isRtl())),ke(dt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xn(li,e,ZX).call(e,...i)})),ke(Wr,this)||As(Wr,this,new NO(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,s,a)=>Xn(li,this,KX).call(this,n,a)),this.addHook("afterScroll",()=>Xn(li,this,QX).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Xn(li,this,hM).call(this,n)),this.addHook("beforeCompositionStart",n=>Xn(li,this,hM).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xn(li,e,JX).call(e,...i)}),ke(Wr,this).addLocalHook("hide",()=>this.hide()),ke(Wr,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ke(Wr,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(ib);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();As(hg,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(ib),this.hot._registerTimeout(()=>{As(hg,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell()},group:yc}),i.addShortcut({keys:[["Escape"]],callback:()=>{ke(dt,this).setValue(ke(Yg,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(dt,this).isVisible()&&ke(dt,this).isFocused(),group:yc}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ke(dt,this).isVisible()&&ke(dt,this).isFocused(),group:yc}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{ke(dt,this).setValue(ke(dt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:yc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yc)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Xn(li,this,YX).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Xn(li,this,UX).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Xn(li,this,GX).call(this)),this.eventManager.addEventListener(n,"focus",()=>Xn(li,this,XX).call(this)),this.eventManager.addEventListener(n,"blur",()=>Xn(li,this,qX).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Xn(li,this,zX).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Qa(e.target,"TD","TBODY");return!!(n&&Se(n,"htCommentCell")&&Qa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=ke(dt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[Zc]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Io),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Zc)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Zc)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ke(Wr,this).cancelHiding(),ke(dt,this).setValue((e=r[Io]?r[Io][Zc]:null)!==null&&e!==void 0?e:""),ke(dt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){ke(dt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!ke(dt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(o);const l=s===null;ke(dt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),y=this.getCommentMeta(r,o,$O);y?ke(dt,this).setSize(y.width,y.height):ke(dt,this).resetSize();const C=c?0:f.getColumnWidth(a),E=l&&!u?an(m):0,{left:b,top:$,width:W,height:F}=m.getBoundingClientRect(),{width:x,height:A}=ke(dt,this).getSize(),{innerWidth:Z,innerHeight:K}=this.hot.rootWindow,z=this.hot.rootDocument.documentElement,le=vn(this.hot.rootDocument),ne=bx(this.hot.rootWindow)?le:0,ve=Sx(this.hot.rootWindow)?le:0;let ye=b+h.scrollX+C,Ie=$+h.scrollY+E;this.hot.isRtl()&&(ye-=x+C),this.hot.isLtr()&&b+W+x>Z-ne?ye=b+h.scrollX-x-1:this.hot.isRtl()&&ye<-(z.scrollWidth-z.clientWidth)&&(ye=b+h.scrollX+C+1),$+A>K-ve&&(Ie-=A-F+1),ke(dt,this).setPosition(ye,Ie),ke(dt,this).setReadOnlyState(this.getCommentMeta(r,o,cg)),ke(dt,this).observeSize()}focusEditor(){ke(dt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[Io];let o;r?(o=Wn(r),Lm(o,i)):o=i,this.hot.setCellMeta(e,n,Io,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[Io])return r[Io][i]}addToContextMenu(e){e.items.push({name:Ve},DX(this),kX(this),LX(this))}getEditorInputElement(){return ke(dt,this).getInputElement()}destroy(){var e,n;(e=ke(dt,this))===null||e===void 0||e.destroy(),(n=ke(Wr,this))===null||n===void 0||n.destroy(),super.destroy()}}function UX(t){if(!(!this.hot.view||!this.hot.view._wt)&&!ke(yw,this)&&!this.targetIsCommentTextArea(t)){const e=Qa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function zX(t){t.stopPropagation()}function YX(t){const{rootDocument:e}=this.hot;if(!(ke(yw,this)||ke(dt,this).isFocused()||Se(t.target,"wtBorder")||ke(rb,this)===t.target||!ke(dt,this)))if(As(rb,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));ke(Wr,this).show(n)}else qa(t.target,e)&&!this.targetIsCommentTextArea(t)&&ke(Wr,this).hide()}function GX(){As(yw,this,!1)}function KX(t,e){e[Io]&&e[Io][Zc]&&q(t,e.commentedCellClassName)}function qX(){As(Yg,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function XX(){As(Yg,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(ib)}function ZX(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[$O]:{width:t,height:e}})}function hM(t){ke(dt,this).isFocused()&&Cr(t)}function QX(){ke(hg,this)||this.hide()}function JX(){const t=ke(dt,this).getEditorElement();be(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function CC(t,e,n){return(e=e4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:e+""}function t4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FO{constructor(e){CC(this,"hot",void 0),CC(this,"commands",{}),CC(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=n4(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||sn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(o.join(":")),M(u,c=>c.apply(this.hot,i))}}function n4(t,e){let n;return M(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function yC(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=r4(t,"string");return typeof e=="symbol"?e:e+""}function r4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VO{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;yC(this,"hot",void 0),yC(this,"predefinedItems",kO()),yC(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Be(e,(i,r)=>{let o="";i.name===Ve?(n[Ve]=i,o=Ve):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return o4(e,this.defaultOrderPattern,this.predefinedItems)}}function o4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),We(r)?Be(r,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),We(o)?ln(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):M(r,(o,s)=>{let a=n[o];!a&&AX.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),We(o)&&ln(a,o),a.key===void 0&&(a.key=s),i.push(a))}),i}function us(t,e,n){return(e=s4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s4(t){var e=a4(t,"string");return typeof e=="symbol"?e:e+""}function a4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l4{constructor(e,n){us(this,"top",void 0),us(this,"topRelative",void 0),us(this,"left",void 0),us(this,"leftRelative",void 0),us(this,"scrollTop",void 0),us(this,"scrollLeft",void 0),us(this,"cellHeight",void 0),us(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=i,a+=r):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-i,l=a-r),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function bc(t,e,n){u4(t,e),e.set(t,n)}function u4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ae(t,e){return t.get(WO(t,e))}function lf(t,e,n){return t.set(WO(t,e),n),n}function WO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var An=new WeakMap,Yn=new WeakMap,Gn=new WeakMap,bC=new WeakMap,Fl=new WeakMap;class c4{constructor(e){bc(this,An,void 0),bc(this,Yn,void 0),bc(this,Gn,void 0),bc(this,bC,!1),bc(this,Fl,{above:0,below:0,left:0,right:0}),lf(bC,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ae(Fl,this)[e]=n,this}setElement(e){return lf(An,this,e),this}setParentElement(e){return lf(Yn,this,e),this}updatePosition(e){lf(Gn,this,new l4(e,Ae(An,this).ownerDocument.defaultView)),Ae(bC,this)?(Ae(Gn,this).fitsBelow(Ae(An,this))?this.setPositionBelowCursor():Ae(Gn,this).fitsAbove(Ae(An,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ae(An,this).dir==="rtl"?Ae(Gn,this).fitsOnLeft(Ae(An,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ae(Gn,this).fitsOnRight(Ae(An,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ae(Fl,this).above+Ae(Gn,this).top-Ae(An,this).offsetHeight;if(Ae(Yn,this)){const i=Ae(Yn,this).ownerDocument.defaultView.getComputedStyle(Ae(Yn,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=Ae(Gn,this).top+Ae(Gn,this).cellHeight-Ae(An,this).scrollHeight+r+o}Ae(An,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ae(Fl,this).below+Ae(Gn,this).top+1;if(Ae(Yn,this)){const i=Ae(Yn,this).ownerDocument.defaultView.getComputedStyle(Ae(Yn,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=Ae(Gn,this).top-r-o-1}Ae(An,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ae(Gn,this).left;if(Ae(Yn,this)){const n=Ae(Yn,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Ae(Yn,this).querySelector(".htCore")).borderRightWidth,10);e+=Ae(Gn,this).cellWidth+i}else e+=Ae(Fl,this).right;Ae(An,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ae(Fl,this).left+Ae(Gn,this).left-Ae(An,this).offsetWidth;if(Ae(Yn,this)){const n=Ae(Yn,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Ae(Yn,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}Ae(An,this).style.left=`${e}px`}}function BO(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let s=Xe(e,-1,m()-1);function a(C,E){const b=m()-1;return C<0&&(C=b),C>b&&(C=0),o.has(C)?-1:(o.add(C),i(C,!1)===!1&&(C=a(E===1?++C:--C,E)),C)}function l(C){C>-1&&C<m()&&i(C,!0)!==!1&&(s=C)}function u(){return s}function c(){m()>0&&(o.clear(),s=a(0,1))}function h(){m()>0&&(o.clear(),s=a(m()-1,-1))}function d(){m()>0&&(o.clear(),s=a(++s,1))}function f(){m()>0&&(o.clear(),s=a(--s,-1))}function m(){return Math.max(n(),0)}function y(){o.clear(),s=e,r()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:y}}function h4(t){return Ge(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ob(t){return sn(t,"submenu")}function sb(t){return new RegExp(Ve,"i").test(t.name)}function dg(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function dM(t){return sn(t,"disableSelection")}function d4(t){return Se(t,"htSeparator")}function f4(t){return Se(t,"htSubmenu")}function g4(t){return Se(t,"htDisabled")}function m4(t){return Se(t,"htSelectionDisabled")}function p4(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function jO(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function w4(t,e){let n=t.slice(0);return n.reverse(),n=jO(n,e),n.reverse(),n}function v4(t){const e=[];return M(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function C4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,n=t.slice(0);return n=jO(n,e),n=w4(n,e),n=v4(n),n}function y4(t){return t.checkable===!0}function b4(t){return BO({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||d4(i)||g4(i)||m4(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function S4(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const UO="menu",fM=UO;function R4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(S4(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:UO})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function o(){return[...n]}function s(u){return u?`${fM}:${u}`:fM}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:a,listen:l}}function E4(t){return(e,n,i,r,o,s)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Go(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!dg(a,t)&&!dM(a)&&!sb(a);Ee(n,[...y4(a)?[K$(),Ih(c),fx(h)]:[G$(),Ih(u)],...d?[gl(-1)]:[],...dg(a,t)?[tF()]:[],...ob(a)?[Bi(!1)]:[]])}n.className="",n.appendChild(l),sb(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,o,u))):Wu(l,u),dg(a,t)?q(n,"htDisabled"):dM(a)?q(n,"htSelectionDisabled"):ob(a)&&q(n,"htSubmenu")}}function SC(t,e,n){_4(t,e),e.set(t,n)}function _4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(t,e,n){return(e=T4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T4(t){var e=M4(t,"string");return typeof e=="symbol"?e:e+""}function M4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RC(t,e,n){return t.set(zO(t,e),n),n}function wa(t,e){return t.get(zO(t,e))}function zO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gM=215;var Sc=new WeakMap,uf=new WeakMap,cf=new WeakMap;class Yu{get tableBorderWidth(){return wa(cf,this)===void 0&&this.hotMenu&&RC(cf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),wa(cf,this)}constructor(e,n){var i=this;Pr(this,"hot",void 0),Pr(this,"options",void 0),Pr(this,"eventManager",new wr(this)),Pr(this,"container",void 0),Pr(this,"positioner",void 0),Pr(this,"hotMenu",null),Pr(this,"hotSubMenus",{}),Pr(this,"parentMenu",void 0),Pr(this,"menuItems",null),Pr(this,"origOutsideClickDeselects",null),SC(this,Sc,void 0),SC(this,uf,void 0),SC(this,cf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:gM,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new c4(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(r)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Mu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return wa(Sc,this)}getKeyboardShortcutsCtrl(){return wa(uf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=km(a=>this.openSubMenu(a),300),n=this.options.minWidth||gM;let i=!1,r=Za(this.menuItems,a=>(a.key===$h&&(i=!0),p4(a,this.hot)));if(r.length<1&&!i)r.push(kO()[$h]);else if(r.length===0)return;r=C4(r,Ve);let o=!1;const s={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return de(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:E4(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{wa(Sc,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),DE()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!DE()||!el(a))&&o&&this.hasSelectedItem()&&($o()||Ox()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),RC(Sc,this,b4(this.hotMenu)),RC(uf,this,R4(this)),wa(uf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(wa(Sc,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);Ee(i,[Bi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!f4(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Yu(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&Ee(n,[Bi(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ee(r,[Bi(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?h4(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||sb(e)||dg(e,this.hot)||ob(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=n.hider.style,o=n.holder.style,s=parseInt(r.width,10),a=si(i,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?an(this.hotMenu.getCell(c,0)):0;return l+(u.name===Ve?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),r.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(ft(i)&&(i=i.call(this.hot),i===null||Ht(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),q(r,`htMenu handsontable ${this.options.className}`),i&&q(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ee(this.hotMenu.rootElement,[Y$(),gl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!qa(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!qa(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Se(e.target,"htCore")&&qa(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}wt(Yu,bn);function P4(t,e){I4(t,e),e.add(t)}function I4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EC(t,e,n){return(e=x4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4(t){var e=O4(t,"string");return typeof e=="symbol"?e:e+""}function O4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qc="contextMenu",H4=70,mM=Qc;se.getSingleton().register("afterContextMenuDefaultOptions");se.getSingleton().register("beforeContextMenuShow");se.getSingleton().register("afterContextMenuShow");se.getSingleton().register("afterContextMenuHide");se.getSingleton().register("afterContextMenuExecute");var Rc=new WeakSet;class bw extends nt{constructor(){super(...arguments),P4(this,Rc),EC(this,"commandExecutor",new FO(this.hot)),EC(this,"itemsFactory",null),EC(this,"menu",null)}static get PLUGIN_KEY(){return Qc}static get PLUGIN_PRIORITY(){return H4}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ww,vw,Ve,hd,dd,Ve,pw,gd,Ve,Cw,mw,Ve,fd,Ve,Di]}isEnabled(){return!!this.hot.getSettings()[Qc]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Qc];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Yu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>hf(Rc,this,N4).call(this)),this.menu.addLocalHook("afterOpen",()=>hf(Rc,this,D4).call(this)),this.menu.addLocalHook("afterClose",()=>hf(Rc,this,k4).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>hf(Rc,this,A4).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=fw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:mM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mM)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;Be(i,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,r?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new VO(this.hot,bw.DEFAULT_ITEMS);const e=this.hot.getSettings()[Qc],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),M(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function A4(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Se(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(Se(o,"current")&&Se(o,"wtBorder"))))return;const s=fw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function N4(){this.hot.runHooks("beforeContextMenuShow",this)}function D4(){this.hot.runHooks("afterContextMenuShow",this)}function k4(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}bw.SEPARATOR={name:Ve};function L4(t){return{key:"copy",name(){return this.getTranslatedPhrase(Qm)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $4(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tp,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function F4(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ep,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function V4(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Xe(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Jm,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function W4(t){return{key:"cut",name(){return this.getTranslatedPhrase(np)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class B4{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class j4{constructor(){this.clipboardData=new B4}preventDefault(){}composedPath(){return[]}}function U4(t,e){YO(t,e),e.add(t)}function Vl(t,e,n){YO(t,e),e.set(t,n)}function YO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(t,e){return t.get(mu(t,e))}function Wl(t,e,n){return t.set(mu(t,e),n),n}function mu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cs=new WeakMap,_C=new WeakMap,Ec=new WeakMap,ab=new WeakMap,lb=new WeakMap,_c=new WeakMap,Tc=new WeakSet;class z4{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=e;U4(this,Tc),Vl(this,cs,void 0),Vl(this,_C,void 0),Vl(this,Ec,void 0),Vl(this,ab,void 0),Vl(this,lb,void 0),Vl(this,_c,void 0),Wl(_C,this,n),Wl(Ec,this,i),Wl(ab,this,r),Wl(lb,this,o),Wl(_c,this,s)}setSelectedRange(e){Wl(cs,this,e)}getCellsRange(){if(kn(_C,this).call(this)===0||kn(Ec,this).call(this)===0)return null;const{row:e,col:n}=kn(cs,this).getTopStartCorner(),{row:i,col:r}=kn(cs,this).getBottomEndCorner(),o=mu(Tc,this,Y4).call(this,e,i),s=mu(Tc,this,TC).call(this,n,r);return{isRangeTrimmed:i!==o||r!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kn(Ec,this).call(this)===0||kn(_c,this).call(this)===0)return null;const{col:e}=kn(cs,this).getTopStartCorner(),{col:n}=kn(cs,this).getBottomEndCorner(),i=mu(Tc,this,TC).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(kn(Ec,this).call(this)===0||kn(_c,this).call(this)===0)return null;const{col:e}=kn(cs,this).getTopStartCorner(),{col:n}=kn(cs,this).getBottomEndCorner(),i=mu(Tc,this,TC).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-kn(_c,this).call(this),startCol:e,endRow:-1,endCol:i}}}function TC(t,e){return Math.min(e,Math.max(t+kn(lb,this).call(this)-1,t))}function Y4(t,e){return Math.min(e,Math.max(t+kn(ab,this).call(this)-1,t))}function GO(t){const e=[],n=[];return M(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);pe(r,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);pe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function G4(t,e){KO(t,e),e.add(t)}function hs(t,e,n){KO(t,e),e.set(t,n)}function KO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mc(t,e,n){return(e=K4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ti(t,e){return t.get(ii(t,e))}function ir(t,e,n){return t.set(ii(t,e),n),n}function ii(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("afterCopyLimit");se.getSingleton().register("modifyCopyableRange");se.getSingleton().register("beforeCut");se.getSingleton().register("afterCut");se.getSingleton().register("beforePaste");se.getSingleton().register("afterPaste");se.getSingleton().register("beforeCopy");se.getSingleton().register("afterCopy");const MC="copyPaste",X4=80,Z4=["fragmentSelection"],pM=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var ub=new WeakMap,cb=new WeakMap,hb=new WeakMap,Bl=new WeakMap,df=new WeakMap,ff=new WeakMap,jl=new WeakMap,Gg=new WeakMap,pi=new WeakSet;class Q4 extends nt{constructor(){super(...arguments),G4(this,pi),Mc(this,"columnsLimit",1/0),Mc(this,"rowsLimit",1/0),Mc(this,"pasteMode","overwrite"),Mc(this,"uiContainer",this.hot.rootDocument.body),hs(this,ub,!1),hs(this,cb,!1),hs(this,hb,!1),hs(this,Bl,"cells-only"),hs(this,df,!1),hs(this,ff,!1),hs(this,jl,new z4({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),hs(this,Gg,!1),Mc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return MC}static get SETTING_KEYS(){return[MC,...Z4]}static get PLUGIN_PRIORITY(){return X4}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[MC]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ir(ub,this,this.getSetting("copyColumnHeaders")),ir(cb,this,this.getSetting("copyColumnGroupHeaders")),ir(hb,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>ii(pi,this,t9).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(pi,i,n9).call(i,...o)}),this.addHook("afterSelectionEnd",()=>ii(pi,this,i9).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),Hg()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(pi,i,r9).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(pi,i,o9).call(i,...o)}),this.addHook("afterSelection",()=>ii(pi,this,s9).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ir(Bl,this,e),ir(df,this,!0),ii(pi,this,wM).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ir(ff,this,!0),ii(pi,this,wM).call(this,"cut")}getRangedCopyableData(e){return ah(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=GO(e);return M(i,o=>{const s=[];M(r,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new j4;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ti(jl,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);ti(Bl,this)==="column-headers-only"?n.set("headers",ti(jl,this).getMostBottomColumnHeadersRange()):(ti(Bl,this)==="with-column-headers"?n.set("headers",ti(jl,this).getMostBottomColumnHeadersRange()):ti(Bl,this)==="with-column-group-headers"&&n.set("headers",ti(jl,this).getAllColumnHeadersRange()),n.set("cells",ti(jl,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=r;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<i||c<=l;){const{skipRowOnPaste:m,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,m===!0)continue;d=y,h=a;const C=[],E=o.length%i;for(;C.length<r||h<=u;){const{skipColumnOnPaste:b,visualCol:$}=this.hot.getCellMeta(s,h);if(h=$+1,b===!0)continue;f=$;const W=C.length%r;C.push(e[E][W])}o.push(C)}return ir(Gg,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ti(df,this)||this.isEditorOpened()||zo(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!ig(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ir(df,this,!1);const o=this.getRangedData(this.copyableRanges),s=ii(pi,this,J4).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=ah(o);if(e&&e.clipboardData){const u=o_(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[pM,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}ir(Bl,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ti(ff,this)||this.isEditorOpened()||zo(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!ig(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ir(ff,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=ah(o);if(e&&e.clipboardData){const l=o_(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[pM,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||zo(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!ig(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=nS(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=CV(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=az(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function wM(t){if(Hg()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&SF(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function J4(t){const{rows:e}=GO(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function e9(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&_x(i)}}}function qO(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&Tx(i)}}}function t9(t){t.items.push({name:"---------"},L4(this)),ti(ub,this)&&t.items.push(V4(this)),ti(cb,this)&&t.items.push(F4(this)),ti(hb,this)&&t.items.push($4(this)),t.items.push(W4(this))}function n9(t,e,n,i,r){ti(Gg,this)&&(r.value=!0),ir(Gg,this,!1)}function i9(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function r9(){ii(pi,this,qO).call(this)}function o9(){ii(pi,this,e9).call(this)}function s9(){ii(pi,this,qO).call(this)}function XO(t,e){return`border_row${t}col${e}`}function Jc(){return{width:1,color:"#000"}}function Fo(){return{hide:!0}}function a9(){return{width:1,color:"#000",cornerVisible:!1}}function PC(t){if(de(t.start)||de(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(de(t.end)||de(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Pc(t){return de(t.start)&&(t.left=t.start),de(t.end)&&(t.right=t.end),t}function IC(t,e){return{id:XO(t,e),border:a9(),row:t,col:e,top:Fo(),bottom:Fo(),start:Fo(),end:Fo()}}function l9(t,e){return sn(e,"border")&&e.border&&(t.border=e.border),sn(e,"top")&&de(e.top)&&(e.top?(We(e.top)||(e.top=Jc()),t.top=e.top):(e.top=Fo(),t.top=e.top)),sn(e,"bottom")&&de(e.bottom)&&(e.bottom?(We(e.bottom)||(e.bottom=Jc()),t.bottom=e.bottom):(e.bottom=Fo(),t.bottom=e.bottom)),sn(e,"start")&&de(e.start)&&(e.start?(We(e.start)||(e.start=Jc()),t.start=e.start):(e.start=Fo(),t.start=e.start)),sn(e,"end")&&de(e.end)&&(e.end?(We(e.end)||(e.end=Jc()),t.end=e.end):(e.end=Fo(),t.end=e.end)),t}function qo(t,e){let n=!1;return M(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const s=t.getCellMeta(r,o).borders;if(s)if(e){if(!sn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Sw(t){return`<span class="selected">✓</span>${t}`}function u9(t){return t.some(e=>de(e.left)||de(e.right))}function c9(t){return t.some(e=>de(e.start)||de(e.end))}const h9=new Map([["left","start"],["right","end"]]);function d9(t){var e;return(e=h9.get(t))!==null&&e!==void 0?e:t}function f9(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Sp);return qo(this,"bottom")&&(e=Sw(e)),e},callback(e,n){const i=qo(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function g9(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Rp);return qo(this,e)&&(n=Sw(n)),n},callback(n,i){const r=qo(this,e);t.prepareBorder(i,e,r)}}}function m9(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Ep)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!qo(this)}}}function p9(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(bp);return qo(this,e)&&(n=Sw(n)),n},callback(n,i){const r=qo(this,e);t.prepareBorder(i,e,r)}}}function w9(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(yp);return qo(this,"top")&&(e=Sw(e)),e},callback(e,n){const i=qo(this,"top");t.prepareBorder(n,"top",i)}}}function v9(t,e){C9(t,e),e.add(t)}function C9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y9(t,e,n){return(e=b9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b9(t){var e=S9(t,"string");return typeof e=="symbol"?e:e+""}function S9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fg="customBorders",R9=90;var xC=new WeakSet;class E9 extends nt{constructor(){super(...arguments),v9(this,xC),y9(this,"savedBorders",[])}static get PLUGIN_KEY(){return fg}static get PLUGIN_PRIORITY(){return R9}isEnabled(){return!!this.hot.getSettings()[fg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>vM(xC,this,_9).call(this,e)),this.addHook("init",()=>vM(xC,this,T9).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=PC(n));const o=xu(e),s=kh(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,d9(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=xu(e),i=kh(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return M(e,o=>{i(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&r.push(Pc(l))})})}),r}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=IC(e,n);i&&(a=l9(a,i),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Pc(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);pe(e.from.row,i,o=>{pe(e.from.col,r,s=>{const a=IC(o,s);let l=0;o===e.from.row&&sn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&sn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&sn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&sn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Pc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=XO(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=IC(e,n):o=PC(o),r?(o[i]=Fo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Pc(o)))):(o[i]=Jc(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Pc(o)))}prepareBorder(e,n,i){M(e,r=>{let{start:o,end:s}=r;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":pe(o.col,s.col,a=>{pe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":pe(o.col,s.col,a=>{this.setBorder(o.row,a,n,i)});break;case"bottom":pe(o.col,s.col,a=>{this.setBorder(s.row,a,n,i)});break;case"start":pe(o.row,s.row,a=>{this.setBorder(a,o.col,n,i)});break;case"end":pe(o.row,s.row,a=>{this.setBorder(a,s.col,n,i)});break}})}createCustomBorders(e){M(e,n=>{const i=PC(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return si([n,i,r,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ge(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ge(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[fg];if(Array.isArray(e)){const n=Wn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=u9(e),i=c9(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _9(t){this.hot.getSettings()[fg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Cp)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[w9(this),p9(this),f9(this),g9(this),m9(this)]}})}function T9(){this.changeBorderSettings()}function M9(t,e){P9(t,e),e.add(t)}function P9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OC(t,e,n){return(e=I9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I9(t){var e=x9(t,"string");return typeof e=="symbol"?e:e+""}function x9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yM="dragToScroll",O9=100;var HC=new WeakSet;class H9 extends nt{constructor(){super(...arguments),M9(this,HC),OC(this,"boundaries",null),OC(this,"callback",null),OC(this,"listening",!1)}static get PLUGIN_KEY(){return yM}static get PLUGIN_PRIORITY(){return O9}isEnabled(){return!!this.hot.getSettings()[yM]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>CM(HC,this,bM).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>CM(HC,this,bM).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Mu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function bM(t){if(el(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const s=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function A9(t,e){ZO(t,e),e.add(t)}function N9(t,e,n){ZO(t,e),e.set(t,n)}function ZO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AC(t,e,n){return(e=D9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D9(t){var e=k9(t,"string");return typeof e=="symbol"?e:e+""}function k9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L9(t,e){return t.get(ki(t,e))}function QO(t,e,n){return t.set(ki(t,e),n),n}function ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("afterDropdownMenuDefaultOptions");se.getSingleton().register("beforeDropdownMenuShow");se.getSingleton().register("afterDropdownMenuShow");se.getSingleton().register("afterDropdownMenuHide");se.getSingleton().register("afterDropdownMenuExecute");const gg="dropdownMenu",$9=230,Fh="changeType",NC=gg;var Rw=new WeakMap,or=new WeakSet;class Ew extends nt{static get PLUGIN_KEY(){return gg}static get PLUGIN_PRIORITY(){return $9}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[hd,dd,Ve,gd,Ve,gw,Ve,fd,Ve,Di]}constructor(e){super(e),A9(this,or),AC(this,"commandExecutor",new FO(this.hot)),AC(this,"itemsFactory",null),AC(this,"menu",null),N9(this,Rw,!1),this.hot.addHook("afterGetColHeader",(n,i)=>ki(or,this,V9).call(this,n,i))}isEnabled(){return this.hot.getSettings()[gg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new VO(this.hot,Ew.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ki(or,e,Y9).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ki(or,e,z9).call(e,...o)});const n=this.hot.getSettings()[gg],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Yu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>ki(or,this,W9).call(this)),this.menu.addLocalHook("afterOpen",()=>ki(or,this,B9).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ki(or,this,j9).call(this,o)),this.menu.addLocalHook("afterClose",()=>ki(or,this,U9).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),o=fw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,r.col,!0).querySelector(`.${Fh}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:NC},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:NC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(NC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ki(or,this,F9).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Be(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function JO(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function F9(t){if(Se(t.target,Fh)){const e=fw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),QO(Rw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function V9(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${Fh}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Fh,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ee(s,[ml(),Ih(" ")]),Ee(e,[cx("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function W9(){this.hot.runHooks("beforeDropdownMenuShow",this)}function B9(){this.hot.runHooks("afterDropdownMenuShow",this),ki(or,this,JO).call(this,this.menu)}function j9(t){ki(or,this,JO).call(this,t)}function U9(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function z9(t){return L9(Rw,this)?null:t}function Y9(t){Se(t.target,Fh)&&QO(Rw,this,!0)}Ew.SEPARATOR={name:Ve};function SM(t,e,n){return(e=G9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G9(t){var e=K9(t,"string");return typeof e=="symbol"?e:e+""}function K9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q9{constructor(e){SM(this,"hot",void 0),SM(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return pe(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(pe(n,r,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();pe(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();pe(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,s=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:i,startCol:r,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function RM(t,e,n){return(e=X9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X9(t){var e=Z9(t,"string");return typeof e=="symbol"?e:e+""}function Z9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pR{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){RM(this,"dataProvider",void 0),RM(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=eo(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=ln(eo(pR.DEFAULT_OPTIONS),n),n=ln(n,e),n.filename=ax(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function Q9(t,e){J9(t,e),e.add(t)}function J9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eH="\r",e6='"',t6=`
`,n6="=",i6="+",r6="-",o6="@",s6="	";var DC=new WeakSet;class a6 extends pR{constructor(){super(...arguments),Q9(this,DC)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=Ge(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=At(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=EM(DC,this,u6).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=EM(DC,this,l6).call(this,r)),(n||r.indexOf(eH)>=0||r.indexOf(e6)>=0||r.indexOf(t6)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function l6(t){return t.startsWith(n6)||t.startsWith(i6)||t.startsWith(r6)||t.startsWith(o6)||t.startsWith(s6)||t.startsWith(eH)?`'${t}`:t}function u6(t,e){return e.test(t)?`'${t}`:t}const c6="csv",db={[c6]:a6};function h6(t,e,n){return typeof db[t]=="function"?new db[t](e,n):null}const d6="exportFile",f6=240;class g6 extends nt{static get PLUGIN_KEY(){return d6}static get PLUGIN_PRIORITY(){return f6}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!db[e])throw new Error(`Export format type "${e}" is not supported.`);return h6(e,new q9(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ul(t,e,n){return(e=m6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m6(t){var e=p6(t,"string");return typeof e=="symbol"?e:e+""}function p6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class md{constructor(e,n){let{id:i,stateless:r=!0}=n;Ul(this,"hot",void 0),Ul(this,"id",void 0),Ul(this,"elements",[]),Ul(this,"hidden",!1),Ul(this,"stateId",""),Ul(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Bm)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}wt(md,bn);const Vh={};function Vs(t,e){if(!Vh[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=Vh[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function za(t){if(!Vh[t])throw Error(`Filter condition "${t}" does not exist.`);return Vh[t].descriptor}function en(t,e,n){n.key=t,Vh[t]={condition:e,descriptor:n}}const wn="none";function w6(){return!0}en(wn,w6,{name:od,inputsCount:0,showOperators:!1});const hh="empty";function v6(t){return qt(t.value)}en(hh,v6,{name:Op,inputsCount:0,showOperators:!0});const mg="not_empty";function C6(t,e){return!Vs(hh,e)(t)}en(mg,C6,{name:Hp,inputsCount:0,showOperators:!0});const dh="eq";function y6(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale)===At(n)}en(dh,y6,{name:Ap,inputsCount:1,showOperators:!0});const pg="neq";function b6(t,e){return!Vs(dh,e)(t)}en(pg,b6,{name:Np,inputsCount:1,showOperators:!0});const tH="gt";function S6(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}en(tH,S6,{name:Fp,inputsCount:1,showOperators:!0});const nH="gte";function R6(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}en(nH,R6,{name:Vp,inputsCount:1,showOperators:!0});const iH="lt";function E6(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}en(iH,E6,{name:Wp,inputsCount:1,showOperators:!0});const rH="lte";function _6(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}en(rH,_6,{name:Bp,inputsCount:1,showOperators:!0});const wR="date_after";function T6(t,e){let[n]=e;const i=Q(t.value,t.meta.dateFormat),r=Q(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}en(wR,T6,{name:zp,inputsCount:1,showOperators:!0});const vR="date_before";function M6(t,e){let[n]=e;const i=Q(t.value,t.meta.dateFormat),r=Q(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}en(vR,M6,{name:Yp,inputsCount:1,showOperators:!0});const Kg="between";function P6(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const s=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Vs(vR,[o]),a=Vs(wR,[r]);return s(t)&&a(t)}return t.value>=r&&t.value<=o}en(Kg,P6,{name:jp,inputsCount:2,showOperators:!0});const oH="not_between";function I6(t,e){return!Vs(Kg,e)(t)}en(oH,I6,{name:Up,inputsCount:2,showOperators:!0});const sH="begins_with";function x6(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).startsWith(At(n))}en(sH,x6,{name:Dp,inputsCount:1,showOperators:!0});const aH="ends_with";function O6(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).endsWith(At(n))}en(aH,O6,{name:kp,inputsCount:1,showOperators:!0});const CR="contains";function H6(t,e){let[n]=e;return At(t.value).toLocaleLowerCase(t.meta.locale).indexOf(At(n))>=0}en(CR,H6,{name:Lp,inputsCount:1,showOperators:!0});const lH="not_contains";function A6(t,e){return!Vs(CR,e)(t)}en(lH,A6,{name:$p,inputsCount:1,showOperators:!0});const uH="date_tomorrow";function N6(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}en(uH,N6,{name:Kp,inputsCount:0});const cH="date_today";function D6(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}en(cH,D6,{name:Gp,inputsCount:0});const hH="date_yesterday";function k6(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}en(hH,k6,{name:qp,inputsCount:0});IF();function L6(t,e){let n=t;return n===""&&(n=`(${e})`),n}function pd(t){const e=new Set(t);return function(n){return e.has(n)}}function yR(t){return t??""}function fb(t){return Array.from(new Set(t)).map(e=>yR(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function _M(t,e,n,i){const r=[],o=t===e;let s;return o||(s=pd(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:L6(a,n)};i&&i(u),r.push(u)}),r}const Ya="by_value";function $6(t,e){let[n]=e;return n(t.value)}en(Ya,$6,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[pd(e)]},showOperators:!1});const Wh={};function F6(t){if(!Wh[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Wh[t].func;return function(n,i){return e(n,i)}}function V6(t){return Wh[t].name}function bR(t,e,n){Wh[t]={name:e,func:n}}const $s="conjunction",W6=Qp;function B6(t,e){return t.every(n=>n.func(e))}bR($s,W6,B6);const qg="disjunction",j6=sd;function U6(t,e){return t.some(n=>n.func(e))}bR(qg,j6,U6);const SR="disjunctionWithExtraCondition",z6=sd;function Y6(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}bR(SR,z6,Y6);const G6="numeric",dH="text",K6="date",TM={[G6]:[wn,Ve,hh,mg,Ve,dh,pg,Ve,tH,nH,iH,rH,Kg,oH],[dH]:[wn,Ve,hh,mg,Ve,dh,pg,Ve,sH,aH,Ve,CR,lH],[K6]:[wn,Ve,hh,mg,Ve,dh,pg,Ve,vR,wR,Kg,Ve,uH,cH,hH]};function q6(t){const e=[];let n=t;return TM[n]||(n=dH),M(TM[n],i=>{let r;i===Ve?r={name:Ve}:r=eo(za(i)),e.push(r)}),e}function Ic(t,e,n){return(e=X6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X6(t){var e=Z6(t,"string");return typeof e=="symbol"?e:e+""}function Z6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kC="built",LC="building",MM=["click","input","keydown","keypress","keyup","focus","blur","change"];let fr=class fH{static get DEFAULTS(){return eo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Ic(this,"hot",void 0),Ic(this,"eventManager",new wr(this)),Ic(this,"options",void 0),Ic(this,"_element",void 0),Ic(this,"buildState",void 0),this.hot=e,this.options=ln(fH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===LC?this._element:this.buildState===kC?(this.update(),this._element):(this.buildState=LC,this.build(),this.buildState=kC,this._element)}isBuilt(){return this.buildState===kC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Bn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=LC),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Be(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),M(MM,i=>e(n,i))}else M(MM,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};wt(fr,bn);function Q6(t,e){gH(t,e),e.add(t)}function J6(t,e,n){gH(t,e),e.set(t,n)}function gH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gf(t,e){return t.get(RR(t,e))}function e8(t,e,n){return t.set(RR(t,e),n),n}function RR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zl=new WeakMap,PM=new WeakSet;class Fs extends fr{static get DEFAULTS(){return eo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,ln(Fs.DEFAULTS,n)),Q6(this,PM),J6(this,zl,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>RR(PM,this,t8).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");e8(zl,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(gf(zl,this).type=this.options.type,gf(zl,this).placeholder=this.translateIfPossible(this.options.placeholder),gf(zl,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&gf(zl,this).focus()}}function t8(t){this.options.value=t.target.value}function n8(t,e){mH(t,e),e.add(t)}function xc(t,e,n){mH(t,e),e.set(t,n)}function mH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e,n){return t.set(fh(t,e),n),n}function Dt(t,e){return t.get(fh(t,e))}function fh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cn=new WeakMap,mf=new WeakMap,pf=new WeakMap,$C=new WeakMap,wf=new WeakMap,vf=new WeakSet;class Bh extends fr{static get DEFAULTS(){return eo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,ln(Bh.DEFAULTS,n)),n8(this,vf),xc(this,cn,null),xc(this,mf,[]),xc(this,pf,void 0),xc(this,$C,void 0),xc(this,wf,void 0),this.registerHooks()}getMenu(){return Dt(cn,this)}registerHooks(){this.addLocalHook("click",()=>fh(vf,this,o8).call(this))}setItems(e){Yl(mf,this,this.translateNames(e)),Dt(cn,this)&&Dt(cn,this).setMenuItems(Dt(mf,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Yl(cn,this,new Yu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Dt(cn,this).setMenuItems(Dt(mf,this));const e=new fr(this.hot,{className:"htUISelectCaption"}),n=new fr(this.hot,{className:"htUISelectDropdown"});Yl(pf,this,e),Yl($C,this,e.element),Yl(wf,this,n),this.hot.getSettings().ariaTags&&(Ee(n.element,[ml()]),Ee(this._element,[ux()])),M([e,n],i=>this._element.appendChild(i.element)),Dt(cn,this).addLocalHook("select",i=>fh(vf,this,i8).call(this,i)),Dt(cn,this).addLocalHook("afterClose",()=>fh(vf,this,r8).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Dt(cn,this).hot.getTranslatedPhrase(od),Dt($C,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Dt(cn,this)&&(Dt(cn,this).open(),Dt(cn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Dt(cn,this).getNavigator().toFirstItem(),Dt(cn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Dt(cn,this)&&Dt(cn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Dt(cn,this)&&(Dt(cn,this).destroy(),Yl(cn,this,null)),Dt(pf,this)&&Dt(pf,this).destroy(),Dt(wf,this)&&Dt(wf,this).destroy(),super.destroy()}}function i8(t){t.name!==Ve&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function r8(){this.runLocalHooks("afterClose")}function o8(){this.openOptions()}function s8(t,e){a8(t,e),e.add(t)}function a8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IM(t,e,n){return(e=l8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var FC=new WeakSet;class gb extends md{constructor(e,n){super(e,{id:n.id,stateless:!1}),s8(this,FC),IM(this,"name",""),IM(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Bh(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fs(this.hot,{placeholder:rw})),this.elements.push(new Fs(this.hot,{placeholder:ow})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>xM(FC,this,c8).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>xM(FC,this,h8).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=eo(e.command);n.name.startsWith(Bt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||za(wn),n=[];return M(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=za(e?e.name:wn);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||M(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Bh)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[za(wn)];if(e!==null){const{visualIndex:i}=e;n=q6(this.hot.getDataType(0,i,this.hot.countRows(),i))}M(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function c8(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function h8(t){ed(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Cr(t))}function OM(t,e,n){d8(t,e),e.set(t,n)}function d8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e){return t.get(pH(t,e))}function HM(t,e,n){return t.set(pH(t,e),n),n}function pH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gl=new WeakMap,VC=new WeakMap;class Xg extends fr{static get DEFAULTS(){return eo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,ln(Xg.DEFAULTS,n)),OM(this,Gl,void 0),OM(this,VC,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),HM(VC,this,e),HM(Gl,this,this._element.firstChild),Oc(Gl,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Oc(VC,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Oc(Gl,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Oc(Gl,this).checked=e)}focus(){this.isBuilt()&&Oc(Gl,this).focus()}}function f8(t,e){g8(t,e),e.add(t)}function g8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m8(t,e,n){return(e=p8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p8(t){var e=w8(t,"string");return typeof e=="symbol"?e:e+""}function w8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const AM=0;var NM=new WeakSet;class C8 extends md{constructor(e,n){super(e,{id:n.id,stateless:!1}),f8(this,NM),m8(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),M(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[$s,qg];M(e,n=>{const i=new Xg(this.hot,{name:"operator",label:{htmlFor:n,textContent:V6(n)},value:n,checked:n===e[AM],id:n});i.addLocalHook("change",r=>v8(NM,this,y8).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(ut`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Xg&&n.isChecked());return e?e.getValue():$s}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$s,n=arguments.length>1?arguments[1]:void 0,i=e;i===SR&&(i=qg),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(AM)}}function y8(t){this.setState(t.target.value)}function b8(t,e,n){S8(t,e),e.set(t,n)}function S8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WC(t,e){return t.get(wH(t,e))}function R8(t,e,n){return t.set(wH(t,e),n),n}function wH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hc=new WeakMap;class jh extends fr{static get DEFAULTS(){return eo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,ln(jh.DEFAULTS,n)),b8(this,Hc,void 0)}build(){super.build(),R8(Hc,this,this._element.firstChild)}update(){this.isBuilt()&&(WC(Hc,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&WC(Hc,this).focus()}activate(){WC(Hc,this).click()}}function E8(t,e){vH(t,e),e.add(t)}function Kl(t,e,n){vH(t,e),e.set(t,n)}function vH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(pu(t,e))}function Qi(t,e,n){return t.set(pu(t,e),n),n}function pu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DM="multipleSelect.itemBox";var sr=new WeakMap,Yt=new WeakMap,BC=new WeakMap,yo=new WeakMap,ds=new WeakMap,fs=new WeakMap,Ac=new WeakSet;class Uh extends fr{static get DEFAULTS(){return eo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,ln(Uh.DEFAULTS,n)),E8(this,Ac),Kl(this,sr,[]),Kl(this,Yt,void 0),Kl(this,BC,void 0),Kl(this,yo,void 0),Kl(this,ds,void 0),Kl(this,fs,void 0),Qi(yo,this,new Fs(this.hot,{placeholder:iw,className:"htUIMultipleSelectSearch"})),Qi(ds,this,new jh(this.hot,{textContent:Jp,className:"htUISelectAll"})),Qi(fs,this,new jh(this.hot,{textContent:ew,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Oe(Yt,this)}registerHooks(){Oe(yo,this).addLocalHook("keydown",e=>pu(Ac,this,T8).call(this,e)),Oe(yo,this).addLocalHook("input",e=>pu(Ac,this,_8).call(this,e)),Oe(ds,this).addLocalHook("click",e=>pu(Ac,this,M8).call(this,e)),Oe(fs,this).addLocalHook("click",e=>pu(Ac,this,P8).call(this,e))}setItems(e){var n;Qi(sr,this,e),(n=Oe(Yt,this))===null||n===void 0||n.loadData(Oe(sr,this))}setLocale(e){Qi(BC,this,e)}getLocale(){return Oe(BC,this)}getItems(){return[...Oe(sr,this)]}getValue(){return x8(Oe(sr,this))}getSearchInputElement(){return Oe(yo,this)}getSelectAllElement(){return Oe(ds,this)}getClearAllElement(){return Oe(fs,this)}isSelectedAllValues(){return Oe(sr,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new fr(this.hot,{className:"htUISelectionControls",children:[Oe(ds,this),Oe(fs,this)]});this._element.appendChild(Oe(yo,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=o=>{var s;if(!this._element)return;(s=Oe(Yt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),Qi(Yt,this,new this.hot.constructor(o,{data:Oe(sr,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Oe(Yt,this).listen()},modifyColWidth:u=>{const c=Oe(Yt,this).container.scrollWidth-vn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Oe(Yt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Oe(Yt,this).useTheme(u)});const l=Oe(Yt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:DM}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Oe(Yt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:DM})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&Oe(Yt,this).listen()}reset(){Oe(yo,this).reset(),Oe(ds,this).reset(),Oe(fs,this).reset()}update(){this.isBuilt()&&(Oe(Yt,this).loadData(I8(Oe(sr,this),this.options.value)),super.update())}destroy(){var e;(e=Oe(Yt,this))===null||e===void 0||e.destroy(),Oe(yo,this).destroy(),Oe(fs,this).destroy(),Oe(ds,this).destroy(),Qi(yo,this,null),Qi(fs,this,null),Qi(ds,this,null),Qi(Yt,this,null),Qi(sr,this,null),super.destroy()}}function _8(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Oe(sr,this)]:n=Oe(sr,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Oe(Yt,this).loadData(n)}function T8(t){this.runLocalHooks("keydown",t,this),Mx(ed,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Cr(t),Oe(Yt,this).listen(),Oe(Yt,this).selectCell(0,0))}function M8(t){const e=[];t.preventDefault(),Oe(Yt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(h1(n,i)[0])}),Oe(Yt,this).setSourceDataAtCell(e)}function P8(t){const e=[];t.preventDefault(),Oe(Yt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(h1(n,i)[0])}),Oe(Yt,this).setSourceDataAtCell(e)}function I8(t,e){const n=pd(e);return t.map(i=>(i.checked=n(i.value),i))}function x8(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function O8(t,e){H8(t,e),e.add(t)}function H8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A8(t,e,n){return(e=N8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N8(t){var e=D8(t,"string");return typeof e=="symbol"?e:e+""}function D8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nc=new WeakSet;class k8 extends md{constructor(e,n){super(e,{id:n.id,stateless:!1}),O8(this,Nc),A8(this,"name",""),this.name=n.name,this.elements.push(new Uh(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Cf(Nc,this,L8).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Cf(Nc,this,$8).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ya){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?wn:Ya},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,s,a)=>{const[l]=Za(r,h=>h.name===Ya),u={},c=this.hot.getTranslatedPhrase(Dh);if(l){const h=s(i,a),d=Ge(h,b=>b.value),f=new Map(h.map(b=>[b.value,this.hot.getCellMeta(b.meta.visualRow,b.meta.visualCol)])),m=fb(d);o&&(l.args[0]=o);const y=[],C=_M(m,l.args[0],c,b=>{b.checked&&y.push(b.value),Cf(Nc,this,kM).call(this,b,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[y],u.command=za(Ya),u.itemsSnapshot=C}else u.args=[],u.command=za(wn);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Uh)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Dh),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),o=fb(i),s=_M(o,o,e,l=>{Cf(Nc,this,kM).call(this,l,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ge(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:yR(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function L8(t){ed(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Cr(t))}function kM(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function $8(t,e){switch(e.type){case"numeric":return sO(t,e);default:return t}}var CH;function F8(t,e){V8(t,e),e.add(t)}function V8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W8(t,e,n){return(e=B8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B8(t){var e=j8(t,"string");return typeof e=="symbol"?e:e+""}function j8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LM=new WeakSet;class zh extends md{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),F8(this,LM),W8(this,"name",""),this.name=n.name,this.elements.push(new Fs(this.hot,{type:"button",value:tw,className:"htUIButton htUIButtonOK",identifier:zh.BUTTON_OK})),this.elements.push(new Fs(this.hot,{type:"button",value:nw,className:"htUIButton htUIButtonCancel",identifier:zh.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,i)=>U8(LM,this,z8).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}CH=zh;function z8(t,e){e.options.identifier===CH.BUTTON_OK?this.accept():this.cancel()}function jC(t,e,n){return(e=Y8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y8(t){var e=G8(t,"string");return typeof e=="symbol"?e:e+""}function G8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $M="ConditionCollection.filteringStates";class ER{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;jC(this,"hot",void 0),jC(this,"isMapRegistrable",void 0),jC(this,"filteringStates",new Bm),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap($M,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],s=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$s;return e.length?F6(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$s,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(ut`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ht(Wh[i]))throw new Error(ut`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:Vs(a,s)}]},r):u.push({name:a,args:s,func:Vs(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap($M),this.filteringStates=null,this.clearLocalHooks()}}wt(ER,bn);function FM(t,e,n){return(e=K8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K8(t){var e=q8(t,"string");return typeof e=="symbol"?e:e+""}function q8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];FM(this,"conditionCollection",void 0),FM(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return M(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return M(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function X8(t,e){Z8(t,e),e.add(t)}function Z8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(t,e,n){return(e=Q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q8(t){var e=J8(t,"string");return typeof e=="symbol"?e:e+""}function J8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yf=new WeakSet;class bH{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];X8(this,yf),va(this,"hot",void 0),va(this,"conditionCollection",void 0),va(this,"columnDataFactory",void 0),va(this,"changes",[]),va(this,"grouping",!1),va(this,"latestEditedColumnPosition",-1),va(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>UC(yf,this,e7).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>UC(yf,this,t7).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>UC(yf,this,n7).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();const l=RF(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new ER(i.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const y=i.columnDataFactory(h);let C;f.isEmpty()?C=y:C=new yH(f,b=>i.columnDataFactory(b)).filter(),C=Ge(C,b=>b.meta.visualRow);const E=pd(C);return f.destroy(),Za(y,b=>E(b.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Be(this,(e,n)=>{this[n]=null})}}function e7(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function t7(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function n7(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}wt(bH,bn);function i7(t){return BO({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof Uh)return i;if(r.element&&!Pu(r.element))return!1;r.focus()}})}const Dc="filters";function r7(t,e){let n=-1,i;const r=i7(e),o=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(Dc),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof fr&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Dc),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Dc)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const y=i.getNavigator();y.getCurrentPage()>-1&&(n=y.getCurrentPage()),y.clear(),m.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const y=e[r.getCurrentPage()];y instanceof Bh&&(y.openOptions(),m.preventDefault()),y instanceof jh&&(y.activate(),m.preventDefault()),y instanceof fr||m.preventDefault()}}],Dc)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(Dc)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),i=h}function u(){return i}function c(){return n}return{...r,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function o7(t,e){SH(t,e),e.add(t)}function zC(t,e,n){SH(t,e),e.set(t,n)}function SH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kc(t,e,n){return(e=s7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s7(t){var e=a7(t,"string");return typeof e=="symbol"?e:e+""}function a7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wg(t,e,n){return t.set(Zn(t,e),n),n}function Li(t,e){return t.get(Zn(t,e))}function Zn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mb="filters",l7=250,VM=mb;var _o=new WeakMap,pb=new WeakMap,Wa=new WeakMap,ui=new WeakSet;class u7 extends nt{static get PLUGIN_KEY(){return mb}static get PLUGIN_PRIORITY(){return l7}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,o7(this,ui),kc(this,"dropdownMenuPlugin",null),kc(this,"conditionCollection",null),kc(this,"conditionUpdateObserver",null),kc(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),kc(this,"filtersRowsMap",null),zC(this,_o,void 0),zC(this,pb,new WeakSet),zC(this,Wa,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Zn(ui,n,p7).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[mb]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new rd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootDocument.body,r=a=>(a.addLocalHook("accept",()=>Zn(ui,this,WM).call(this,"accept")),a.addLocalHook("cancel",()=>Zn(ui,this,WM).call(this,"cancel")),a.addLocalHook("change",l=>Zn(ui,this,m7).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(Xp)}:`,s=()=>`${this.hot.getTranslatedPhrase(Zp)}:`;if(!this.components.get("filter_by_condition")){const a=new gb(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>Zn(ui,this,BM).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new C8(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new gb(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>Zn(ui,this,BM).call(this)),this.components.set("filter_by_condition2",r(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new k8(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new zh(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ER(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new bH(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Zn(ui,this,w7).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Zn(ui,e,g7).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Zn(ui,this,f7).call(this)),this.addHook("afterDropdownMenuShow",()=>Zn(ui,this,h7).call(this)),this.addHook("afterDropdownMenuHide",()=>Zn(ui,this,d7).call(this)),this.addHook("afterChange",a=>Zn(ui,this,c7).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Li(_o,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Li(_o,this).getMenu(),c=u.getNavigator(),h=Li(_o,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];wg(_o,this,r7(this.dropdownMenuPlugin.menu,a));const l=u=>{Li(_o,this).listen(),u.preventDefault(),ed(u.keyCode,"TAB")&&(u.shiftKey?Li(_o,this).toPreviousItem():Li(_o,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:VM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VM)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$s;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,Li(Wa,this));if(s!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Ge(n.filter(),u=>u.meta.visualRow);const l=pd(r);pe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),wg(Wa,this,this.exportConditions())}else s!==!1&&!i?(wg(Wa,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Li(Wa,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return M(this.hot.getSourceDataAtCol(n),(r,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),y=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:yR(y)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=fb(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===qg&&n.command.key!==wn&&i.command.key!==wn&&r.command.key!==wn?o=SR:r.command.key!==wn&&(n.command.key===wn||i.command.key===wn)&&(o=$s),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new yH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return M(r,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function c7(t){t&&M(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function h7(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function d7(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function f7(){const t=this.dropdownMenuPlugin.menu;Li(pb,this).has(t)||Li(_o,this).setMenu(t),Li(pb,this).add(t)}function g7(t){t.items.push({name:Ve}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function WM(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),o.command.key!==wn&&(this.conditionCollection.addCondition(r,o,l,u),s.command.key!==wn&&this.conditionCollection.addCondition(r,s,l,u)),a.command.key!==wn&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function m7(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===gb&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function BM(){this.setListeningDropdownMenu()}function p7(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):be(e,"htFiltersActive")}function w7(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&wg(Wa,this,Li(Wa,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const o=n.filter(a=>a.name===Ya),s=n.filter(a=>a.name!==Ya);if(o.length>=2||s.length>=3)it(ut`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const RH="internal-use-in-handsontable",wb={licenseKey:RH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function EH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[In])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function _H(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function v7(t){var e;const n=t[In],i=_H(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=EH(t);return{...wb,...i,...r}}function C7(t){var e;const n=t[In],i=_H(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=EH(t);return{...i,...r}}function y7(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function _w(){const t="engine_relationship",e=yr(In);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function _R(){const t="shared_engine_usage",e=yr(In);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function b7(t){const e=t.getSettings(),n=e[In],i=n==null?void 0:n.engine;if(n===!0||Ht(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return S7((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Ht(i.hyperformula)){const o=_w(),s=_R().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),s&&s.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:RH}),(i.getConfig().leapYear1900!==wb.leapYear1900||lS(i.getConfig().nullDate,wb.nullDate)===!1)&&it(ut`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function S7(t,e,n){const i=e[In],r=v7(e),o=_w(),s=_R();R7(t,i.functions),E7(t,i.language);const a=t.buildEmpty(r);return o.set(a,[n]),s.set(a,[n.guid]),_7(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function jM(t){var e;const n=_w(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function UM(t,e){if(t){const n=_w(),i=n.get(t),r=_R(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function R7(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(s){it(s.message)}})}function E7(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){it(i.message)}}}function _7(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:s}=n;try{t.addNamedExpression(i,r,o,s)}catch(a){it(a.message)}}),t.resumeEvaluation())}function T7(t,e){return(Ht(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const TH="DD/MM/YYYY";function M7(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function P7(t){return M7(t)?t.substr(1):t}function I7(t){return typeof t=="string"&&t.startsWith("=")}function TR(t,e){return typeof t=="string"&&e==="date"}function MH(t,e){return Q(t,e,!0).isValid()}function PH(t,e){return Q(t,e,!0).format(TH)}function x7(t,e){return Q(t,TH,!0).format(e)}function IH(t,e){const i=new Date(Date.UTC(0,0,t+-1));return Q(i).format(e)}function O7(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function H7(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=r.from;o.from>r.from&&a&&s&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function A7(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function MR(t,e,n){const i=H7(t,O7(t,e,n));return A7(i)}function Ca(t,e,n){N7(t,e),e.set(t,n)}function N7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(t,e){return t.get(xH(t,e))}function gs(t,e,n){return t.set(xH(t,e),n),n}function xH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lc=new WeakMap,ms=new WeakMap,ci=new WeakMap,bf=new WeakMap,YC=new WeakMap,GC=new WeakMap,Sf=new WeakMap;class zM{constructor(e,n,i){Ca(this,Lc,void 0),Ca(this,ms,void 0),Ca(this,ci,void 0),Ca(this,bf,[]),Ca(this,YC,[]),Ca(this,GC,void 0),Ca(this,Sf,[]),gs(Lc,this,e),gs(ms,this,n),gs(ci,this,i)}setRemovedHfIndexes(e){return gs(Sf,this,e.map(n=>{const i=_t(ms,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),_t(Sf,this)}getRemovedHfIndexes(){return _t(Sf,this)}getHfIndexFromVisualIndex(e){const n=_t(ms,this).getIndexesSequence(),i=_t(ms,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${pr(_t(Lc,this))}s`;_t(ci,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,s=r.from+1!==r.to;o&&s&&_t(ci,this).getEngine()[i](_t(ci,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(gs(YC,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),gs(GC,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(_t(ci,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=MR(_t(YC,this),_t(GC,this),_t(ms,this).getNumberOfIndexes());_t(ci,this).getSheetId()===null?_t(ci,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${pr(_t(Lc,this))}Order`;return n=>{if(_t(ci,this).isPerformingUndoRedo())return;const i=_t(ms,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=_t(bf,this).map(l=>i.indexOf(l)),o=_t(ci,this).getEngine().getSheetDimensions(_t(ci,this).getSheetId());let s;_t(Lc,this)==="row"?s=o.height:s=o.width;const a=r.length;for(let l=a;l<s;l+=1)r.push(l);_t(ci,this).getEngine()[e](_t(ci,this).getSheetId(),r)}gs(bf,this,i)}}init(){gs(bf,this,_t(ms,this).getIndexesSequence())}}function ya(t,e,n){D7(t,e),e.set(t,n)}function D7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bo(t,e){return t.get(OH(t,e))}function ba(t,e,n){return t.set(OH(t,e),n),n}function OH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rf=new WeakMap,Ef=new WeakMap,KC=new WeakMap,qC=new WeakMap,XC=new WeakMap,ZC=new WeakMap,QC=new WeakMap;class k7{constructor(e,n,i){ya(this,Rf,void 0),ya(this,Ef,void 0),ya(this,KC,void 0),ya(this,qC,!1),ya(this,XC,!1),ya(this,ZC,null),ya(this,QC,null),ba(Rf,this,new zM("row",e,this)),ba(Ef,this,new zM("column",n,this)),ba(KC,this,i)}getForAxis(e){return e==="row"?bo(Rf,this):bo(Ef,this)}setPerformUndo(e){ba(qC,this,e)}setPerformRedo(e){ba(XC,this,e)}isPerformingUndoRedo(){return bo(qC,this)||bo(XC,this)}getSheetId(){return bo(QC,this)}getEngine(){return bo(ZC,this)}getPostponeAction(){return bo(KC,this)}setupSyncEndpoint(e,n){ba(ZC,this,e),ba(QC,this,n),bo(Rf,this).init(),bo(Ef,this).init()}}function L7(t,e){HH(t,e),e.add(t)}function Sa(t,e,n){return(e=$7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $7(t){var e=F7(t,"string");return typeof e=="symbol"?e:e+""}function F7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JC(t,e,n){HH(t,e),e.set(t,n)}function HH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(t,e,n){return t.set(Qe(t,e),n),n}function Xa(t,e){return t.get(Qe(t,e))}function Qe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const In="formulas",V7=["maxRows","maxColumns","language"],W7=260;se.getSingleton().register("afterNamedExpressionAdded");se.getSingleton().register("afterNamedExpressionRemoved");se.getSingleton().register("afterSheetAdded");se.getSingleton().register("afterSheetRemoved");se.getSingleton().register("afterSheetRenamed");se.getSingleton().register("afterFormulasValuesUpdate");const Gu=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Xo=new WeakMap,Tw=new WeakMap,$c=new WeakMap,tt=new WeakSet;class B7 extends nt{constructor(){var e;super(...arguments),e=this,L7(this,tt),JC(this,Xo,!1),JC(this,Tw,!1),JC(this,$c,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,r5).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,o5).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,s5).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,a5).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,l5).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Qe(tt,e,u5).call(e,...i)}]]),Sa(this,"staticRegister",yr("formulas")),Sa(this,"engine",null),Sa(this,"sheetId",null),Sa(this,"sheetName",null),Sa(this,"indexSyncer",null),Sa(this,"rowAxisSyncer",null),Sa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return In}static get PLUGIN_PRIORITY(){return W7}static get SETTING_KEYS(){return[In,...V7]}isEnabled(){return!!this.hot.getSettings()[In]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=b7(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){it("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&Qe(tt,this,gh).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,YM).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,GM).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,YM).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,GM).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,Y7).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,G7).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,j7).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,K7).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,KM).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,KM).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,q7).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,X7).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,J7).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,e5).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,Z7).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,Q7).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,t5).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,n5).call(n,...r)}),this.indexSyncer=new k7(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,s)=>{this.rowAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("beforeColumnMove",(i,r,o,s)=>{this.columnAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("afterRowMove",(i,r,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,r,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,z7).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,i5).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qe(tt,n,U7).call(n,...r)}),Xa($c,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){Xa($c,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),UM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=C7(this.hot.getSettings());y7(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[In];if(de(i)&&de(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[In].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const o=this.addSheet(r??void 0,this.hot.getSourceDataArray());Qe(tt,this,gh).call(this,o)}}super.updatePlugin(e)}destroy(){Xa($c,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Ws($c,this,null),UM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(de(n)&&!Yj(n))return it("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return it("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return it(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){hS(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Qe(tt,this,gh).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${pr(In)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const s=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(i.has(s)||i.add(s))}),jM(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var s;r.render(),(s=r.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return de(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(de(l)===!1||de(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=i(o);if(c!==void 0&&!r.has(h)){const d=jM(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){it(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return TR(i,o.type)&&(MH(i,o.dateFormat)?i=PH(i,o.dateFormat):I7(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function gh(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function j7(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(r);return o.type==="date"&&Vn(s)&&(s=IH(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function U7(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:y}=h.start,{row:C,col:E}=h.end,b=C-m+1,$=E-y+1;for(let W=0;W<f.length;W+=1)for(let F=0;F<f[W].length;F+=1){const x=f[W][F],A=m+W%b,Z=y+F%$,K=this.hot.getCellMeta(A,Z);TR(x,K.type)&&(x.startsWith("'")?f[W][F]=x.slice(1):this.isFormulaCellType(A,Z,this.sheetId)===!1&&(f[W][F]=x7(x,K.dateFormat)))}return f}function YM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(pr(In))||Ws(Tw,this,Ht(this.hot.getSettings().data))}function z7(){if(Xa(Tw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,i)=>{n.forEach((r,o)=>{const s=this.hot.getCellMeta(i,o,{skipMetaExtension:!0}),a=s.dateFormat;TR(r,s.type)&&(MH(r,a)?t[i][o]=PH(r,a):r.startsWith("=")||(t[i][o]=`'${r}`))})}),Ws(Xo,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ws(Xo,this,!1)}function GM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(pr(In)))return;const i=T7(this.engine,this.hot.getSettings()[In].sheetName);if(Qe(tt,this,gh).call(this,i),n!=="updateSettings")if(Xa(Tw,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ws(Xo,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ws(Xo,this,!1)}}}function Y7(t,e,n,i){if(i!=="get"||Xa(Xo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;const o=this.getCellType(r,e);if(o==="VALUE"||o==="EMPTY"){n.value=P7(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(r,e,{skipMetaExtension:!0});l.type==="date"&&Vn(a)&&(a=IH(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function G7(t,e,n,i){if(i!=="get"||Xa(Xo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null)return;const s=this.getCellType(r,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function KM(t,e){if(Gu(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function K7(t,e){if(Gu(e))return;const n=[],i=[];t.forEach(r=>{let[o,s,,a]=r;const l=this.hot.propToCol(s);if(!Vn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){it(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function q7(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function X7(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Z7(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Q7(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function J7(t,e,n){if(Gu(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function e5(t,e,n){if(Gu(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function t5(t,e,n,i){if(Gu(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function n5(t,e,n,i){if(Gu(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function i5(t,e,n){var i;Ws(Xo,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Ws(Xo,this,!1),r.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function r5(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function o5(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function s5(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function a5(t){this.hot.runHooks("afterSheetAdded",t)}function l5(t,e){Qe(tt,this,gh).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function u5(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function c5(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(Mp,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function h5(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Pp,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function d5(t,e){AH(t,e),e.add(t)}function f5(t,e,n){AH(t,e),e.set(t,n)}function AH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e){return t.get(Ss(t,e))}function qM(t,e,n){return t.set(Ss(t,e),n),n}function Ss(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeHideColumns");se.getSingleton().register("afterHideColumns");se.getSingleton().register("beforeUnhideColumns");se.getSingleton().register("afterUnhideColumns");const XM="hiddenColumns",g5=310;var Ir=new WeakMap,Ea=new WeakSet;class m5 extends nt{constructor(){super(...arguments),d5(this,Ea),f5(this,Ir,null)}static get PLUGIN_KEY(){return XM}static get PLUGIN_PRIORITY(){return g5}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[XM]}enablePlugin(){var e=this;this.enabled||(qM(Ir,this,new Wm),Ra(Ir,this).addLocalHook("init",()=>Ss(Ea,this,b5).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ra(Ir,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ss(Ea,e,y5).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Ss(Ea,this,w5).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Ss(Ea,this,p5).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ss(Ea,e,C5).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Ss(Ea,this,v5).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=Ra(Ir,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),r=si(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&s)!==!1&&(i&&s&&Ra(Ir,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&s,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{Ra(Ir,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Ge(Ra(Ir,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ra(Ir,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){qM(Ir,this,null),super.destroy()}}function p5(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function w5(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function v5(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;pe(i.startCol,i.endCol,s=>{this.isHidden(s)?(r||n(i.startRow,i.endRow,o,s-1),r=!0):(r&&(o=s),s===i.endCol&&n(i.startRow,i.endRow,o,s),r=!1)})}),e}function C5(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function y5(t){t.items.push({name:Ve},c5(this),h5(this))}function b5(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function S5(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(Ip,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function R5(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(xp,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function E5(t,e){NH(t,e),e.add(t)}function _5(t,e,n){NH(t,e),e.set(t,n)}function NH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e){return t.get(Rs(t,e))}function ZM(t,e,n){return t.set(Rs(t,e),n),n}function Rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeHideRows");se.getSingleton().register("afterHideRows");se.getSingleton().register("beforeUnhideRows");se.getSingleton().register("afterUnhideRows");const QM="hiddenRows",T5=320;var xr=new WeakMap,Ta=new WeakSet;class M5 extends nt{constructor(){super(...arguments),E5(this,Ta),_5(this,xr,null)}static get PLUGIN_KEY(){return QM}static get PLUGIN_PRIORITY(){return T5}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[QM]}enablePlugin(){var e=this;this.enabled||(ZM(xr,this,new Wm),_a(xr,this).addLocalHook("init",()=>Rs(Ta,this,A5).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_a(xr,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rs(Ta,e,H5).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Rs(Ta,this,I5).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>Rs(Ta,this,P5).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rs(Ta,e,O5).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Rs(Ta,this,x5).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=_a(xr,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),r=si(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&s)!==!1&&(i&&s&&_a(xr,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&s,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{_a(xr,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Ge(_a(xr,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _a(xr,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){ZM(xr,this,null),super.destroy()}}function P5(t,e){return this.isHidden(e)?0:t}function I5(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function x5(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;pe(i.startRow,i.endRow,s=>{this.isHidden(s)?(r||n(o,s-1,i.startCol,i.endCol),r=!0):(r&&(o=s),s===i.endRow&&n(o,s,i.startCol,i.endCol),r=!1)})}),e}function O5(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function H5(t){t.items.push({name:Ve},S5(this),R5(this))}function A5(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function N5(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(ip)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function D5(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(rp)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function k5(t,e){DH(t,e),e.add(t)}function L5(t,e,n){DH(t,e),e.set(t,n)}function DH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(t,e){return t.get(Zg(t,e))}function ey(t,e,n){return t.set(Zg(t,e),n),n}function Zg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeColumnFreeze");se.getSingleton().register("afterColumnFreeze");se.getSingleton().register("beforeColumnUnfreeze");se.getSingleton().register("afterColumnUnfreeze");const JM="manualColumnFreeze",$5=110;var $a=new WeakMap,ty=new WeakSet;class F5 extends nt{constructor(){super(...arguments),k5(this,ty),L5(this,$a,!1)}static get PLUGIN_KEY(){return JM}static get PLUGIN_PRIORITY(){return $5}isEnabled(){return!!this.hot.getSettings()[JM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Zg(ty,this,V5).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Zg(ty,this,W5).call(this,e,n)),super.enablePlugin())}disablePlugin(){ey($a,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;vb($a,this)||ey($a,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;vb($a,this)||ey($a,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function V5(t){t.items.push({name:"---------"},N5(this),D5(this))}function W5(t,e){if(vb($a,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function _f(t,e,n){return(e=B5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B5(t){var e=j5(t,"string");return typeof e=="symbol"?e:e+""}function j5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ny=0,eP=1,tP=2,ql="px";let kH=class{constructor(e){_f(this,"hot",void 0),_f(this,"_element",null),_f(this,"state",ny),_f(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=tP}build(){this.state===ny&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eP)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ny}isAppended(){return this.state===tP}isBuilt(){return this.state>=eP}setPosition(e,n){Vn(e)&&(this._element.style.top=e+ql),Vn(n)&&(this._element.style[this.inlineProperty]=n+ql)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vn(e)&&(this._element.style.width=e+ql),Vn(n)&&(this._element.style.height=n+ql)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vn(e)&&(this._element.style.marginTop=e+ql),Vn(n)&&(this._element.style[`margin${pr(this.inlineProperty)}`]=n+ql)}getOffset(){const e=this._element.style,n=`margin${pr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const U5="ht__manualColumnMove--backlight";let z5=class extends kH{build(){super.build(),q(this._element,U5)}};const Y5="ht__manualColumnMove--guideline";let G5=class extends kH{build(){super.build(),q(this._element,Y5)}};function K5(t,e){LH(t,e),e.add(t)}function Ji(t,e,n){LH(t,e),e.set(t,n)}function LH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,n){return t.set(Es(t,e),n),n}function ge(t,e){return t.get(Es(t,e))}function Es(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeColumnMove");se.getSingleton().register("afterColumnMove");const iy="manualColumnMove",q5=120,nP="ht__manualColumnMove",Qg="show-ui",Cb="on-moving--columns",yb="after-selection--columns";var $n=new WeakMap,Ts=new WeakMap,Vo=new WeakMap,vg=new WeakMap,Ns=new WeakMap,Ln=new WeakMap,Tf=new WeakMap,Hi=new WeakMap,cu=new WeakMap,Jg=new WeakMap,mh=new WeakMap,Ma=new WeakSet;class X5 extends nt{constructor(){super(...arguments),K5(this,Ma),Ji(this,$n,new z5(this.hot)),Ji(this,Ts,new G5(this.hot)),Ji(this,Vo,[]),Ji(this,vg,0),Ji(this,Ns,!1),Ji(this,Ln,{}),Ji(this,Tf,void 0),Ji(this,Hi,void 0),Ji(this,cu,void 0),Ji(this,Jg,void 0),Ji(this,mh,void 0)}static get PLUGIN_KEY(){return iy}static get PLUGIN_PRIORITY(){return q5}isEnabled(){return!!this.hot.getSettings()[iy]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Ma,e,Z5).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Ma,e,J5).call(e,...i)}),this.addHook("afterScrollVertically",()=>Es(Ma,this,tZ).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Ma,e,nZ).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,nP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){be(this.hot.rootElement,nP),this.unregisterEvents(),ge($n,this).destroy(),ge(Ts,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=ge(Tf,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(ri(Tf,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return ri(Tf,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=si(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const s=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[iy];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return pe(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ge(Hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ge(Hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ge($n,this).getOffset().start,u=ge($n,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,y=Jt(this.hot.rootElement),C=m.innerWidth-ge(cu,this)-y;h=m.innerWidth-ge(Ln,this).eventPageX-C-(i.scrollX===void 0?r:0)}else h=ge(Ln,this).eventPageX-(ge(cu,this)-(i.scrollX===void 0?r:0));if(ge(Jg,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ge(Hi,this))&&(o+=r),o+=c,ge(Hi,this)<0)ge(mh,this)>0?ge(Ln,this).col=0:ge(Ln,this).col=e>0?e-1:e;else if(ge(Ln,this).TD.offsetWidth/2+o<=h){const m=ge(Hi,this)>=ge(vg,this)?ge(vg,this)-1:ge(Hi,this);ge(Ln,this).col=m+1,o+=ge(Ln,this).TD.offsetWidth}else ge(Ln,this).col=ge(Hi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:i.scrollX!==void 0&&ge(Hi,this)<ge(mh,this)&&(f-=ge(cu,this)<=i.scrollX?ge(cu,this):0),ge($n,this).setPosition(null,d),ge(Ts,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Es(Ma,this,Q5).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Es(Ma,this,eZ).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ge($n,this).build(),ge(Ts,this).build()}destroy(){ge($n,this).destroy(),ge(Ts,this).destroy(),super.destroy()}}function Z5(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Se(t.target,"sortAction");if(!s||!o||ge(Ns,this)||t.button!==0||a){ri(Ns,this,!1),ge(Vo,this).length=0,be(this.hot.rootElement,[Cb,Qg]);return}const l=ge(Ts,this).isBuilt()&&!ge(Ts,this).isAppended(),u=ge($n,this).isBuilt()&&!ge($n,this).isAppended();l&&u&&(ge(Ts,this).appendTo(r.hider),ge($n,this).appendTo(r.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,ri(Ns,this,!0);const m=n.firstChild?FF(t,n.firstChild).x:t.offsetX;ge(Ln,this).eventPageX=t.pageX,ri(Hi,this,e.col),ge(Ln,this).TD=n,ge(Ln,this).col=e.col,ri(Vo,this,this.prepareColumnsToMoving(d,f)),ri(Jg,this,!!this.hot.getSettings().rowHeaders),ri(vg,this,this.hot.countCols()),ri(mh,this,this.hot.getSettings().fixedColumnsStart),ri(cu,this,xn(this.hot.rootElement).left);const y=ge(Jg,this)?-1:0,C=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,E=e.col<ge(mh,this),b=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),$=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),W=this.getColumnsWidth(d,e.col-1)+$,F=this.getColumnsWidth(y,d-1)+(E?b:0)+W;ge($n,this).setPosition(C,F),ge($n,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-C),ge($n,this).setOffset(null,-W),q(this.hot.rootElement,Cb)}else be(this.hot.rootElement,yb),ri(Ns,this,!1),ge(Vo,this).length=0}function Q5(t){ge(Ns,this)&&(ge(Ln,this).eventPageX=t.pageX,this.refreshPositions())}function J5(t,e,n,i){!this.hot.getSelectedRangeLast()||!ge(Ns,this)||(ge(Vo,this).indexOf(e.col)>-1?be(this.hot.rootElement,Qg):q(this.hot.rootElement,Qg),i.row=!0,i.column=!0,i.cell=!0,ri(Hi,this,e.col),ge(Ln,this).TD=n)}function eZ(){const t=ge(Ln,this).col,e=ge(Vo,this).length;if(ri(Hi,this,void 0),ri(Ns,this,!1),be(this.hot.rootElement,[Cb,Qg,yb]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,yb),e<1||t===void 0)return;const n=ge(Vo,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(ge(Vo,this),t);if(ge(Vo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(i),s=o+e-1;this.hot.selectColumns(o,s)}}function tZ(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;ge($n,this).setPosition(i),ge($n,this).setSize(null,t.hider.offsetHeight-i)}function nZ(){this.moveBySettingsOrLoad()}function iZ(t,e){$H(t,e),e.add(t)}function En(t,e,n){$H(t,e),e.set(t,n)}function $H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,n){return t.set(ar(t,e),n),n}function ae(t,e){return t.get(ar(t,e))}function ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const em="manualColumnResize",rZ=130,iP="manualColumnWidths";var xo=new WeakMap,Mf=new WeakMap,vi=new WeakMap,tm=new WeakMap,qr=new WeakMap,oZ=new WeakMap,_u=new WeakMap,Pf=new WeakMap,qn=new WeakMap,To=new WeakMap,ol=new WeakMap,nm=new WeakMap,ph=new WeakMap,wh=new WeakMap,yi=new WeakMap,vh=new WeakMap,Or=new WeakSet;class sZ extends nt{static get PLUGIN_KEY(){return em}static get PLUGIN_PRIORITY(){return rZ}constructor(e){super(e),iZ(this,Or),En(this,xo,null),En(this,Mf,null),En(this,vi,[]),En(this,tm,null),En(this,qr,null),En(this,oZ,null),En(this,_u,null),En(this,Pf,null),En(this,qn,this.hot.rootDocument.createElement("DIV")),En(this,To,this.hot.rootDocument.createElement("DIV")),En(this,ol,null),En(this,nm,!1),En(this,ph,0),En(this,wh,null),En(this,yi,void 0),En(this,vh,void 0),q(ae(qn,this),"manualColumnResizer"),q(ae(To,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[em]}enablePlugin(){var e=this;this.enabled||(Kt(yi,this,new zs),ae(yi,this).addLocalHook("init",()=>ar(Or,this,aZ).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(yi,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ar(Or,e,fZ).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ar(Or,e,gZ).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ar(Or,e,mZ).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(vh,this,ae(yi,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",iP,ae(yi,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",iP,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return ae(yi,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(yi,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Kt(xo,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(ae(xo,this)),r=i.col;if(r<0)return;const o=an(ae(xo,this)),s=ae(xo,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(xo,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(xo,this),i.row,i.col)),Kt(Mf,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),Kt(vi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;pe(d,f,m=>{ae(vi,this).includes(m)||ae(vi,this).push(m)})})}ae(vi,this).includes(ae(Mf,this))||Kt(vi,this,[ae(Mf,this)]),Kt(Pf,this,l.start-6),Kt(_u,this,parseInt(s.width,10)),ae(qn,this).style.top=`${l.top}px`,ae(qn,this).style[this.inlineDir]=`${ae(Pf,this)+ae(_u,this)}px`,ae(qn,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(qn,this))}refreshHandlePosition(){ae(qn,this).style[this.inlineDir]=`${ae(Pf,this)+ae(tm,this)}px`}setupGuidePosition(){const e=parseInt(an(ae(qn,this)),10),n=parseInt(ae(qn,this).style.top,10)+e,i=this.hot.view.getTableHeight();q(ae(qn,this),"active"),q(ae(To,this),"active"),ae(To,this).style.top=`${n}px`,this.refreshGuidePosition(),ae(To,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(ae(To,this))}refreshGuidePosition(){ae(To,this).style[this.inlineDir]=ae(qn,this).style[this.inlineDir]}hideHandleAndGuide(){be(ae(qn,this),"active"),be(ae(To,this),"active")}checkIfColumnHeader(e){const n=Qa(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",ae(qr,this),i,!0);o!==void 0&&Kt(qr,this,o),this.setManualSize(i,ae(qr,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(qr,this),i,!0),r&&e()};ae(ph,this)>=2&&(ae(vi,this).length>1?(M(ae(vi,this),r=>{n(r)}),e()):M(ae(vi,this),r=>{n(r,!0)})),Kt(ph,this,0),Kt(wh,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>ar(Or,this,lZ).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>ar(Or,this,uZ).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>ar(Or,this,cZ).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ar(Or,this,hZ).call(this)),this.eventManager.addEventListener(ae(qn,this),"contextmenu",()=>ar(Or,this,dZ).call(this))}destroy(){super.destroy()}}function aZ(){const t=this.hot.getSettings()[em],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0),Kt(vh,this,t)):t===!0&&Array.isArray(ae(vh,this))&&this.hot.batchExecution(()=>{ae(vh,this).forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0)}function lZ(t){if(!Ex(t.target)&&ae(nm,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(ol,this)||this.setupHandlePosition(e))}}function uZ(t){t.target.parentNode===this.hot.rootElement&&Se(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(xo,this)),this.setupGuidePosition(),Kt(ol,this,!0),ae(wh,this)===null&&(Kt(wh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(wh,this))),Kt(ph,this,ae(ph,this)+1),this.startX=t.pageX,Kt(qr,this,ae(_u,this)))}function cZ(t){if(ae(ol,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Kt(tm,this,ae(_u,this)+e),M(ae(vi,this),n=>{Kt(qr,this,this.setManualSize(n,ae(tm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hZ(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",ae(qr,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(qr,this),n,!1)};ae(ol,this)&&(this.hideHandleAndGuide(),Kt(ol,this,!1),ae(qr,this)!==ae(_u,this)&&(ae(vi,this).length>1?(M(ae(vi,this),i=>{e(i)}),t()):M(ae(vi,this),i=>{e(i,!0)})),this.setupHandlePosition(ae(xo,this)))}function dZ(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(qn,this)),this.hot.rootElement.removeChild(ae(To,this)),Kt(ol,this,!1),Kt(nm,this,!0),this.hot._registerImmediate(()=>{Kt(nm,this,!1)})}function fZ(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=ae(yi,this).getValueAtIndex(i);this.hot.getSettings()[em]&&r&&(n=r)}return n}function gZ(t,e){const n=ae(yi,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function mZ(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function ry(t,e,n){return(e=pZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pZ(t){var e=wZ(t,"string");return typeof e=="symbol"?e:e+""}function wZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oy=0,rP=1,oP=2,Xl="px";let FH=class{constructor(e){ry(this,"hot",void 0),ry(this,"_element",null),ry(this,"state",oy),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=oP}build(){this.state===oy&&(this._element=this.hot.rootDocument.createElement("div"),this.state=rP)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=oy}isAppended(){return this.state===oP}isBuilt(){return this.state>=rP}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Xl),n!==void 0&&(this._element.style.left=n+Xl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Xl),n&&(this._element.style.height=n+Xl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Xl),n&&(this._element.style.marginLeft=n+Xl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const vZ="ht__manualRowMove--backlight";class CZ extends FH{build(){super.build(),q(this._element,vZ)}}const yZ="ht__manualRowMove--guideline";class bZ extends FH{build(){super.build(),q(this._element,yZ)}}function SZ(t,e){VH(t,e),e.add(t)}function Zl(t,e,n){VH(t,e),e.set(t,n)}function VH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ga(t,e,n){return t.set(_s(t,e),n),n}function xe(t,e){return t.get(_s(t,e))}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeRowMove");se.getSingleton().register("afterRowMove");const sy="manualRowMove",RZ=140,sP="ht__manualRowMove",im="show-ui",bb="on-moving--rows",Sb="after-selection--rows";var Fn=new WeakMap,Ms=new WeakMap,Wo=new WeakMap,Ds=new WeakMap,oi=new WeakMap,If=new WeakMap,Pa=new WeakSet;class EZ extends nt{constructor(){super(...arguments),SZ(this,Pa),Zl(this,Fn,new CZ(this.hot)),Zl(this,Ms,new bZ(this.hot)),Zl(this,Wo,[]),Zl(this,Ds,void 0),Zl(this,oi,{}),Zl(this,If,void 0)}static get PLUGIN_KEY(){return sy}static get PLUGIN_PRIORITY(){return RZ}isEnabled(){return!!this.hot.getSettings()[sy]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return _s(Pa,e,_Z).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return _s(Pa,e,MZ).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>_s(Pa,this,IZ).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return _s(Pa,e,xZ).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,sP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){be(this.hot.rootElement,sP),this.unregisterEvents(),xe(Fn,this).destroy(),xe(Ms,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=xe(If,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Ga(If,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Ga(If,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=si(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const s=i.getRenderableFromVisualIndex(o);s!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[sy];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return pe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=xe(oi,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=xe(oi,this).TD,a=this.hot.rootElement,l=xn(a),u=xh(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=xe(oi,this).eventPageY-d+c,m=o.hider.offsetHeight,y=o.TBODY.offsetTop,C=xe(Fn,this).getOffset().top,E=xe(Fn,this).getSize().height,b=s.offsetHeight/2,$=s.offsetHeight;let W=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const F=f>=W+b;this.isFixedRowTop(e.row)&&(W+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?xe(oi,this).row=n>0?n-1:n:F?(xe(oi,this).row=e.row+1,W+=e.row===0?$-1:$):xe(oi,this).row=e.row;let x=f,A=W;f+E+C>=m?x=m-E-C:f+C<y&&(x=y+Math.abs(C)),W>=m-1&&(A=m-1),xe(Fn,this).setPosition(x),xe(Ms,this).setPosition(A)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>_s(Pa,this,TZ).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>_s(Pa,this,PZ).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){xe(Fn,this).build(),xe(Ms,this).build()}destroy(){xe(Fn,this).destroy(),xe(Ms,this).destroy(),super.destroy()}}function _Z(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||xe(Ds,this)||t.button!==0){Ga(Ds,this,!1),xe(Wo,this).length=0,be(this.hot.rootElement,[bb,im]);return}const l=xe(Ms,this).isBuilt()&&!xe(Ms,this).isAppended(),u=xe(Fn,this).isBuilt()&&!xe(Fn,this).isAppended();l&&u&&(xe(Ms,this).appendTo(r.hider),xe(Fn,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,Ga(Ds,this,!0),xe(oi,this).eventPageY=t.pageY,xe(oi,this).coords=e,xe(oi,this).TD=n,Ga(Wo,this,this.prepareRowsToMoving());const m=r.holder.scrollLeft+o.getRowHeaderWidth(),y=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);xe(Fn,this).setPosition(null,m),xe(Fn,this).setSize(r.hider.offsetWidth-m,this.getRowsHeight(d,f)),xe(Fn,this).setOffset(-y,null),q(this.hot.rootElement,bb),this.refreshPositions()}else be(this.hot.rootElement,Sb),Ga(Ds,this,!1),xe(Wo,this).length=0}function TZ(t){xe(Ds,this)&&(xe(oi,this).eventPageY=t.pageY,this.refreshPositions())}function MZ(t,e,n,i){!this.hot.getSelectedRangeLast()||!xe(Ds,this)||(xe(Wo,this).indexOf(e.row)>-1?be(this.hot.rootElement,im):q(this.hot.rootElement,im),i.row=!0,i.column=!0,i.cell=!0,xe(oi,this).coords=e,xe(oi,this).TD=n)}function PZ(){const t=xe(oi,this).row,e=xe(Wo,this).length;if(Ga(Ds,this,!1),be(this.hot.rootElement,[bb,im,Sb]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,Sb),e<1||t===void 0)return;const n=xe(Wo,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(xe(Wo,this),t);if(xe(Wo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(i),s=o+e-1;this.hot.selectRows(o,s)}}function IZ(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;xe(Fn,this).setPosition(null,i),xe(Fn,this).setSize(t.hider.offsetWidth-i)}function xZ(){this.moveBySettingsOrLoad()}function OZ(t,e){WH(t,e),e.add(t)}function _n(t,e,n){WH(t,e),e.set(t,n)}function WH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e,n){return t.set(Oo(t,e),n),n}function oe(t,e){return t.get(Oo(t,e))}function Oo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rm="manualRowResize",HZ=30,aP="manualRowHeights";var Br=new WeakMap,xf=new WeakMap,Ci=new WeakMap,Ch=new WeakMap,Ps=new WeakMap,PR=new WeakMap,Tu=new WeakMap,Of=new WeakMap,Dn=new WeakMap,Fr=new WeakMap,sl=new WeakMap,om=new WeakMap,yh=new WeakMap,bh=new WeakMap,cr=new WeakMap,Sh=new WeakMap,ps=new WeakSet;class AZ extends nt{static get PLUGIN_KEY(){return rm}static get PLUGIN_PRIORITY(){return HZ}constructor(e){super(e),OZ(this,ps),_n(this,Br,null),_n(this,xf,null),_n(this,Ci,[]),_n(this,Ch,null),_n(this,Ps,null),_n(this,PR,null),_n(this,Tu,null),_n(this,Of,null),_n(this,Dn,this.hot.rootDocument.createElement("DIV")),_n(this,Fr,this.hot.rootDocument.createElement("DIV")),_n(this,sl,!1),_n(this,om,!1),_n(this,yh,0),_n(this,bh,null),_n(this,cr,void 0),_n(this,Sh,void 0),q(oe(Dn,this),"manualRowResizer"),q(oe(Fr,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[rm]}enablePlugin(){this.enabled||(Ft(cr,this,new zs),oe(cr,this).addLocalHook("init",()=>Oo(ps,this,VZ).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,oe(cr,this)),this.addHook("modifyRowHeight",(e,n)=>Oo(ps,this,FZ).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ft(Sh,this,oe(cr,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",aP,oe(cr,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",aP,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.view.getDefaultRowHeight());return oe(cr,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return oe(Ch,this)}setupHandlePosition(e){Ft(Br,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(oe(Br,this)),o=r.row;if(o<0)return;const s=Jt(oe(Br,this)),a=oe(Br,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(Br,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(oe(Br,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(oe(Br,this),r.row,r.col)),Ft(xf,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Ft(Ci,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const m=f.getTopStartCorner().row,y=f.getBottomStartCorner().row;pe(m,y,C=>{oe(Ci,this).includes(C)||oe(Ci,this).push(C)})})}oe(Ci,this).includes(oe(xf,this))||Ft(Ci,this,[oe(xf,this)]),Ft(Of,this,c.top-6),Ft(Tu,this,parseInt(a.height,10)),oe(Dn,this).style.top=`${oe(Of,this)+oe(Tu,this)}px`,oe(Dn,this).style[this.inlineDir]=`${c.start}px`,oe(Dn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(oe(Dn,this))}refreshHandlePosition(){oe(Dn,this).style.top=`${oe(Of,this)+oe(Ch,this)}px`}setupGuidePosition(){const e=parseInt(Jt(oe(Dn,this)),10),n=parseInt(oe(Dn,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();q(oe(Dn,this),"active"),q(oe(Fr,this),"active"),oe(Fr,this).style.top=oe(Dn,this).style.top,oe(Fr,this).style[this.inlineDir]=`${n}px`,oe(Fr,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(oe(Fr,this))}refreshGuidePosition(){oe(Fr,this).style.top=oe(Dn,this).style.top}hideHandleAndGuide(){be(oe(Dn,this),"active"),be(oe(Fr,this),"active")}checkIfRowHeader(e){const n=Qa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&oe(Ps,this)<n?n:oe(Ps,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&Ft(Ps,this,o),this.setManualSize(i,oe(Ps,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};oe(yh,this)>=2&&(oe(Ci,this).length>1?(M(oe(Ci,this),r=>{n(r)}),e()):M(oe(Ci,this),r=>{n(r,!0)})),Ft(yh,this,0),Ft(bh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Oo(ps,this,NZ).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Oo(ps,this,DZ).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Oo(ps,this,kZ).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Oo(ps,this,LZ).call(this)),this.eventManager.addEventListener(oe(Dn,this),"contextmenu",()=>Oo(ps,this,$Z).call(this))}destroy(){super.destroy()}}function NZ(t){if(!Ex(t.target)&&oe(om,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(oe(sl,this)||this.setupHandlePosition(e))}}function DZ(t){Se(t.target,"manualRowResizer")&&(this.setupHandlePosition(oe(Br,this)),this.setupGuidePosition(),Ft(sl,this,!0),oe(bh,this)===null&&(Ft(bh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(bh,this))),Ft(yh,this,oe(yh,this)+1),Ft(PR,this,t.pageY),Ft(Ps,this,oe(Tu,this)))}function kZ(t){oe(sl,this)&&(Ft(Ch,this,oe(Tu,this)+(t.pageY-oe(PR,this))),M(oe(Ci,this),e=>{Ft(Ps,this,this.setManualSize(e,oe(Ch,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function LZ(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};oe(sl,this)&&(this.hideHandleAndGuide(),Ft(sl,this,!1),oe(Ps,this)!==oe(Tu,this)&&(oe(Ci,this).length>1?(M(oe(Ci,this),i=>{e(i)}),t()):M(oe(Ci,this),i=>{e(i,!0)})),this.setupHandlePosition(oe(Br,this)))}function $Z(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(Dn,this)),this.hot.rootElement.removeChild(oe(Fr,this)),Ft(sl,this,!1),Ft(om,this,!0),this.hot._registerImmediate(()=>{Ft(om,this,!1)})}function FZ(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=oe(cr,this).getValueAtIndex(i);this.hot.getSettings()[rm]&&r&&(n=r)}return n}function VZ(){const t=this.hot.getSettings()[rm],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{oe(cr,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{oe(cr,this).setValueAtIndex(i,n)}),Ft(Sh,this,t)):t===!0&&Array.isArray(oe(Sh,this))&&oe(Sh,this).forEach((n,i)=>{oe(cr,this).setValueAtIndex(i,n)})},!0)}var lP={},uP;function WZ(){if(uP)return lP;uP=1;var t=bm();return t("flatMap"),lP}WZ();var cP={},hP={},ay,dP;function BZ(){if(dP)return ay;dP=1;var t=Ri(),e=ji(),n=io(),i=GA();return ay=function(r,o){(!o||typeof r!="string")&&e(r);var s=i(r);return n(e(s!==void 0?t(s,r):r))},ay}var fP;function jZ(){if(fP)return hP;fP=1;var t=yt(),e=Ri(),n=to(),i=ji(),r=io(),o=BZ(),s=Ab(),a=Ui(),l=Du(),u=js(),c=!l&&u("flatMap",TypeError),h=s(function(){for(var d=this.iterator,f=this.mapper,m,y;;){if(y=this.inner)try{if(m=i(e(y.next,y.iterator)),!m.done)return m.value;this.inner=null}catch(C){a(d,"throw",C)}if(m=i(e(this.next,d)),this.done=!!m.done)return;try{this.inner=o(f(m.value,this.counter++),!1)}catch(C){a(d,"throw",C)}}});return t({target:"Iterator",proto:!0,real:!0,forced:l||c},{flatMap:function(f){i(this);try{n(f)}catch(m){a(this,"throw",m)}return c?e(c,this,f):new h(r(this),{mapper:f,inner:null})}}),hP}var gP;function UZ(){return gP||(gP=1,jZ()),cP}UZ();function zZ(t,e,n){YZ(t,e),e.set(t,n)}function YZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(t,e,n){return(e=GZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GZ(t){var e=KZ(t,"string");return typeof e=="symbol"?e:e+""}function KZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mP(t,e){return t.get(BH(t,e))}function Hf(t,e,n){return t.set(BH(t,e),n),n}function BH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xa=new WeakMap;class jr{constructor(e,n,i,r,o,s){Ia(this,"row",void 0),Ia(this,"col",void 0),Ia(this,"rowspan",void 0),Ia(this,"colspan",void 0),Ia(this,"removed",!1),Ia(this,"cellCoordsFactory",void 0),Ia(this,"cellRangeFactory",void 0),zZ(this,xa,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return ut`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return ut`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return ut`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return ut`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Hf(xa,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=i),i>0)n<=c&&n>u&&(this[o]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,Hf(xa,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(u<=a&&c>=l)this[o]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return Hf(xa,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return mP(xa,this)||Hf(xa,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),mP(xa,this)}}function qZ(t,e){XZ(t,e),e.add(t)}function XZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Af(t,e,n){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ws=new WeakSet;class sm{constructor(e){qZ(this,ws),Af(this,"plugin",void 0),Af(this,"mergedCells",[]),Af(this,"mergedCellsMatrix",new Map),Af(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return ut`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=r&&h>=i&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){it(sm.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let u=r;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,s=e.colspan,a=new jr(i,r,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Oa(ws,this,pP).call(this,a),a):(u&&it(sm.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Oa(ws,this,JZ).call(this,i),i):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;pe(n,n+r,s=>{pe(i,i+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:s,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Xe(u,r,r+s-1),d=Xe(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Oa(ws,this,Nf).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Oa(ws,this,Nf).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Oa(ws,this,Nf).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Oa(ws,this,Nf).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(s=>{s.shift(r,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Oa(ws,this,pP).call(this,s)})}}function Nf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=r.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=r.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function pP(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function JZ(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function ly(t,e,n){return(e=eQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:e+""}function tQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nQ{constructor(e){ly(this,"plugin",void 0),ly(this,"mergedCellsCollection",void 0),ly(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),s=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,y=this.getFarthestCollection(e,n,i,r);if(y){if(i==="down"){const C=y.row+y.rowspan-a-m;o[2]+C>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?C:0}else if(i==="right"){const C=y.col+y.colspan-l-m;o[3]+C>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?C:0}else if(i==="up"){const C=u-m-y.row+1;o[0]+C<0?o[0]+=m:o[0]-=m?C:0}else if(i==="left"){const C=c-m-y.col+1;o[1]+C<0?o[1]+=m:o[1]-=m?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),ln(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[r,a+f,c,h]}default:return null}}getFarthestCollection(e,n,i,r){const[o,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,i),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,y=d-m;let C=null,E=null,b=null;switch(i){case"up":C="includesVertically",b=c-y+1;break;case"left":C="includesHorizontally",b=c-y+1;break;case"down":C="includesVertically",b=h+y-1;break;case"right":C="includesHorizontally",b=h+y-1;break}return M(r,$=>{$[C](b)&&$.isFarther(E,i)&&(E=$)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===i.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return M(e,r=>{const o=r[0],s=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,s,a,l]=r,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(m=>{let{colspan:y}=m;return y===h.getWidth()}):!f.every(m=>{let{rowspan:y}=m;return y===h.getHeight()})}}function uy(t,e,n){return(e=iQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iQ(t){var e=rQ(t,"string");return typeof e=="symbol"?e:e+""}function rQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oQ{constructor(e){uy(this,"plugin",void 0),uy(this,"hot",void 0),uy(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function sQ(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(sp)}return this.getTranslatedPhrase(op)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?jr.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Rh(t,e,n){return(e=aQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aQ(t){var e=lQ(t,"string");return typeof e=="symbol"?e:e+""}function lQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wP{constructor(e){Rh(this,"data",void 0),Rh(this,"next",null),Rh(this,"prev",null),this.data=e}}class Df{constructor(){Rh(this,"first",null),Rh(this,"last",null)}push(e){const n=new wP(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new wP(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function uQ(t,e){jH(t,e),e.add(t)}function Ha(t,e,n){jH(t,e),e.set(t,n)}function jH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(am(t,e))}function hi(t,e,n){return t.set(am(t,e),n),n}function am(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hr=new WeakMap,Ar=new WeakMap,Nr=new WeakMap,Dr=new WeakMap,Rb=new WeakMap,kf=new WeakMap,Lf=new WeakMap,cy=new WeakSet;class cQ{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;uQ(this,cy),Ha(this,Hr,new Df),Ha(this,Ar,new Df),Ha(this,Nr,null),Ha(this,Dr,null),Ha(this,Rb,null),Ha(this,kf,null),Ha(this,Lf,null),hi(Rb,this,n),hi(kf,this,i),hi(Lf,this,r)}getCurrentVerticalNode(){return at(Dr,this).data}getFirstVerticalNode(){return at(Ar,this).first.data}getNextVerticalNode(){return at(Dr,this).next.data}getPrevVerticalNode(){return at(Dr,this).prev.data}getCurrentHorizontalNode(){return at(Nr,this).data}getFirstHorizontalNode(){return at(Hr,this).first.data}getNextHorizontalNode(){return at(Nr,this).next.data}getPrevHorizontalNode(){return at(Nr,this).prev.data}setPrevNodeAsActive(){hi(Dr,this,at(Dr,this).prev),hi(Nr,this,at(Nr,this).prev)}setNextNodeAsActive(){hi(Dr,this,at(Dr,this).next),hi(Nr,this,at(Nr,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;hi(Hr,this,new Df);for(let s=n.row;s<=i.row;s++)if(!at(kf,this).isHidden(s))for(let a=n.col;a<=i.col;a++){if(at(Lf,this).isHidden(a))continue;const l=am(cy,this,vP).call(this,e,at(Hr,this),r,s,a);l&&hi(Nr,this,l)}at(Hr,this).first&&(at(Hr,this).first.prev=at(Hr,this).last,at(Hr,this).last.next=at(Hr,this).first);const o=new WeakSet;hi(Ar,this,new Df);for(let s=n.col;s<=i.col;s++)if(!at(Lf,this).isHidden(s))for(let a=n.row;a<=i.row;a++){if(at(kf,this).isHidden(a))continue;const l=am(cy,this,vP).call(this,e,at(Ar,this),o,a,s);l&&hi(Dr,this,l)}at(Ar,this).first&&(at(Ar,this).first.prev=at(Ar,this).last,at(Ar,this).last.next=at(Ar,this).first)}setActiveNode(e,n){return at(Hr,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return hi(Nr,this,i),!1}),at(Ar,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return hi(Dr,this,i),!1}),this}}function vP(t,e,n,i,r){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=at(Rb,this).call(this,i,r);if(l&&n.has(l))return null;const u={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&r===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function UH(t,e,n){const{view:i,rowIndexMapper:r}=t,o=i.getStylesHandler(),s=i.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!r.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function hQ(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!We(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Hg()&&r.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${r.get(l)}px`,r.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[y,C]=t.translateMergedCellToRenderable(h,m,d,f),E=t.getSetting("virtualized");if(Hg()&&d===0&&!e.getSettings().rowHeaders){const z=UH(e,h,m);r.set(l,z/m)}const b=n.getRenderableFromVisualIndex(l),$=i.getRenderableFromVisualIndex(u),W=y-b+1,F=C-$+1;let x=n.getNearestNotHiddenIndex(h,1),A=i.getNearestNotHiddenIndex(d,1);if(E){const z=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(z)||(x=Math.max(x,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(z)||(A=Math.max(A,e.getFirstRenderedVisibleColumn()))}const Z=Math.min(m,W),K=Math.min(f,F);x===l&&A===u?(a.setAttribute("rowspan",Z),a.setAttribute("colspan",K)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function dQ(t,e){zH(t,e),e.add(t)}function $f(t,e,n){zH(t,e),e.set(t,n)}function zH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hy(t,e,n){return(e=fQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fQ(t){var e=gQ(t,"string");return typeof e=="symbol"?e:e+""}function gQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yh(t,e,n){return t.set(ht(t,e),n),n}function Ct(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}se.getSingleton().register("beforeMergeCells");se.getSingleton().register("afterMergeCells");se.getSingleton().register("beforeUnmergeCells");se.getSingleton().register("afterUnmergeCells");const Eb="mergeCells",mQ=150,CP=Eb;var Vi=new WeakMap,Wi=new WeakMap,Xr=new WeakMap,yP=new WeakMap,pt=new WeakSet;class pQ extends nt{constructor(){super(...arguments),dQ(this,pt),hy(this,"mergedCellsCollection",null),hy(this,"autofillCalculations",null),hy(this,"selectionCalculations",null),$f(this,Vi,null),$f(this,Wi,{row:0,col:0}),$f(this,Xr,new cQ({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),$f(this,yP,hQ(this))}static get PLUGIN_KEY(){return Eb}static get PLUGIN_PRIORITY(){return mQ}static get DEFAULT_SETTINGS(){return{[cO]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[Eb]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new sm(this),this.autofillCalculations=new nQ(this),this.selectionCalculations=new oQ(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,wQ).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,CQ).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,yQ).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,bQ).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,SQ).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,SP).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,SP).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,EQ).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,_Q).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,TQ).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,bP).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,bP).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,vQ).call(e,...i)}),this.addHook("afterRenderer",function(){return Ct(yP,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,RQ).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,MQ).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,PQ).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,IQ).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,xQ).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,OQ).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,HQ).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,AQ).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,NQ).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,DQ).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,kQ).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,LQ).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,$Q).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,FQ).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,VQ).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!Ix())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let s=r+1;s<r+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(r);s&&(s.style.background=Ig(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=Ig(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?jr.containsNegativeValues(e)?(it(jr.NEGATIVE_VALUES_WARNING(e)),!1):jr.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(it(jr.IS_OUT_OF_BOUNDS_WARNING(e)),!1):jr.isSingleCell(e)?(it(jr.IS_SINGLE_CELL(e)),!1):jr.containsZeroSpan(e)?(it(jr.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:s,rowspan:a,colspan:l}=r,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),pe(0,s.rowspan-1,c=>{pe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),pe(0,r.rowspan-1,o=>{pe(0,r.colspan-1,s=>{this.hot.removeCellMeta(r.row+o,r.col+s,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+s,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:CP})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CP)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(We(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(We(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(We(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(We(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function wQ(){this.generateFromSettings(),this.hot.render()}function vQ(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function CQ(t){Ct(Wi,this).row=t.row,Ct(Wi,this).col=t.col}function yQ(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;Ct(Vi,this)&&(r.getRenderableFromVisualIndex(Ct(Vi,this).row)!==null&&(n.row=Ct(Vi,this).row),i.getRenderableFromVisualIndex(Ct(Vi,this).col)!==null&&(n.col=Ct(Vi,this).col),Yh(Vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function bQ(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function SQ(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Yh(Vi,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Yh(Vi,this,e.clone()),n&&e.assign(n)}function bP(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:s,colspan:a,rowspan:l}=r,u=o,c=s,h=o+l-1,d=s+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),y=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Xe(m,u,h),Xe(y,c,d),Xe(this.hot.getLastRenderedVisibleRow(),u,h),Xe(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function RQ(t){t.items.push({name:"---------"},sQ(this))}function SP(){Yh(Vi,this,null)}function EQ(){if(Ct(Vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=Ct(Vi,this).clone().normalize();Ct(Xr,this).setActiveNode(i.row,i.col),Ct(Wi,this).row>0||Ct(Wi,this).col>0?Ct(Xr,this).setPrevNodeAsActive():(n==="E-W"&&Ct(Wi,this).col<0||e==="S-N"&&Ct(Wi,this).row<0)&&Ct(Xr,this).setNextNodeAsActive()}function _Q(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let o=null,s=null;if(Ct(Wi,this).col<0){const{rowEnd:a,colEnd:l}=Ct(Xr,this).getPrevHorizontalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(Ct(Wi,this).col>0){const{rowStart:a,colStart:l}=Ct(Xr,this).getNextHorizontalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}else if(Ct(Wi,this).row<0){const{rowEnd:a,colEnd:l}=Ct(Xr,this).getPrevVerticalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(Ct(Wi,this).row>0){const{rowStart:a,colStart:l}=Ct(Xr,this).getNextVerticalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Ct(Xr,this).setActiveNode(t,e),Yh(Wi,this,{row:0,col:0})}function TQ(){this.hot.getSelectedRangeLast().isHeader()||Ct(Xr,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function MQ(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function PQ(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function IQ(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function xQ(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function OQ(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function HQ(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function AQ(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function NQ(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function DQ(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function kQ(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);M(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function LQ(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function $Q(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function FQ(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(s,s,a))}function VQ(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,UH(this.hot,e,m))}),t}function WQ(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function s(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:bO(u.type))(l,u,d)(c,h);if(m===Qr){const y=a+1;if(typeof e[y]<"u")return s(y)}return m}(0)}}const YH="sort";function BQ(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${YH}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function jQ(t){const e=t.className.split(" "),n=new RegExp(`^${YH}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function UQ(t,e,n){return(e=zQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zQ(t){var e=YQ(t,"string");return typeof e=="symbol"?e:e+""}function YQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lm="multiColumnSorting",GQ=170,RP=lm;yO(lm,WQ);class KQ extends xO{constructor(){super(...arguments),UQ(this,"pluginKey",lm)}static get PLUGIN_KEY(){return lm}static get PLUGIN_PRIORITY(){return GQ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,jg)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Ys,position:"before",group:RP})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RP)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),be(e,jQ(e)),this.enabled!==!1&&q(e,BQ(...i))}onAfterOnCellMouseDown(e,n){gR(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,jg))):this.sort(this.getColumnNextConfig(n.col)))}}function EP(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ZQ="multipleSelectionHandles",QQ=160;class JQ extends nt{constructor(){super(...arguments),EP(this,"dragged",[]),EP(this,"lastSetCell",null)}static get PLUGIN_KEY(){return ZQ}static get PLUGIN_PRIORITY(){return QQ}isEnabled(){return $o()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(Se(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(Se(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(Se(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(Se(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function _b(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function GH(){return{label:"",isPlaceholder:!0}}function eJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,r=>{const o=[];let s=0;n.push(o),M(r,a=>{const l=_b();if(We(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=At(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=At(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(GH());return!u})});const i=Math.max(...Ge(n,r=>r.length));return M(n,r=>{if(r.length<i){const o=Ge(new Array(i-r.length),()=>_b());r.splice(r.length,0,...o)}}),n}function dy(t,e,n){tJ(t,e),e.set(t,n)}function tJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function er(t,e){return t.get(KH(t,e))}function Fc(t,e,n){return t.set(KH(t,e),n),n}function KH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _P=["label","collapsible"];var So=new WeakMap,Aa=new WeakMap,fy=new WeakMap;class nJ{constructor(){dy(this,So,[]),dy(this,Aa,0),dy(this,fy,1/0)}setColumnsLimit(e){Fc(fy,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Fc(So,this,eJ(e,er(fy,this))),Fc(Aa,this,er(So,this).length)}getData(){return er(So,this)}mergeWith(e){M(e,n=>{let{row:i,col:r,...o}=n;const s=this.getHeaderSettings(i,r);s!==null&&ln(s,o,_P)})}map(e){M(er(So,this),n=>{M(n,i=>{const r=e({...i});We(r)&&ln(i,r,_P)})})}getHeaderSettings(e,n){var i;if(e>=er(Aa,this)||e<0)return null;const r=er(So,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=er(Aa,this)||e<0)return r;const o=er(So,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return er(Aa,this)}getColumnsCount(){return er(Aa,this)>0?er(So,this)[0].length:0}clear(){Fc(So,this,[]),Fc(Aa,this,0)}}function gy(t,e,n){return(e=iJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iJ(t){var e=rJ(t,"string");return typeof e=="symbol"?e:e+""}function rJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qH="DF-pre-order";function XH(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=XH.call(this.childs[i],t,e)}return n}const oJ="DF-post-order";function ZH(t,e){for(let n=0;n<this.childs.length;n++)if(ZH.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const QH="BF";function sJ(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const aJ=QH,TP=new Map([[qH,XH],[oJ,ZH],[QH,sJ]]);class um{constructor(e){gy(this,"data",{}),gy(this,"parent",null),gy(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new um({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aJ;if(!TP.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);TP.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function my(t,e,n){lJ(t,e),e.set(t,n)}function lJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){return t.get(JH(t,e))}function uJ(t,e,n){return t.set(JH(t,e),n),n}function JH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ql=new WeakMap,Na=new WeakMap,Jl=new WeakMap;class cJ{constructor(e){my(this,Ql,new Map),my(this,Na,new Map),my(this,Jl,null),uJ(Jl,this,e)}getRoots(){return Array.from(Nn(Ql,this).values())}getRootByColumn(e){let n;return Nn(Na,this).has(e)&&(n=Nn(Ql,this).get(Nn(Na,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Nn(Na,this).get(n);let o=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=o&&r<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Nn(Na,this).clear(),M(Nn(Ql,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Nn(Na,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Nn(Jl,this).getColumnsCount();let n=0;for(;n<e;){const i=Nn(Jl,this).getHeaderSettings(0,n),r=new um;Nn(Ql,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Nn(Jl,this).getHeadersSettings(i,n,r);i+=1,M(o,s=>{const a={...s,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new um(a),e.addChild(l)),i<Nn(Jl,this).getLayersCount()&&this.buildLeaves(l,n,i,s.origColspan),n+=s.origColspan})}clear(){Nn(Ql,this).clear(),Nn(Na,this).clear()}}function eA(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function cm(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function hm(t){return cm(t,"origColspan")===t.data.origColspan}function IR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(hm(t))return IR(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let s=0;if(r.length>0)M(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,eA(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):hm(a)&&(l.isCollapsed=cm(a,"isCollapsed"))}),{rollbackModification:()=>xR(t),affectedColumns:Array.from(o),colspanCompensation:s}}function xR(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(hm(t))return xR(i[0]);n.isCollapsed=!0;const o=i.slice(1),s=new Set;if(o.length>0)M(o,l=>{eA(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=cm(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):hm(l)&&(u.isCollapsed=cm(l,"isCollapsed"))}),{rollbackModification:()=>IR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function hJ(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ut`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function dJ(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ut`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const MP=new Map([["collapse",xR],["expand",IR],["hide-column",hJ],["show-column",dJ]]);function fJ(t,e,n){if(!MP.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return MP.get(t)(e,n)}function Ff(t){const e=[];return M(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=r,u=mJ(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(GH());else{const f=gJ(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function gJ(t){const{crossHiddenColumns:e,...n}=_b(t);return n}function mJ(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function py(t,e,n){pJ(t,e),e.set(t,n)}function pJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vc(t,e,n){return t.set(tA(t,e),n),n}function kt(t,e){return t.get(tA(t,e))}function tA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kr=new WeakMap,Kn=new WeakMap,Da=new WeakMap;class wJ{constructor(){py(this,kr,new nJ),py(this,Kn,new cJ(kt(kr,this))),py(this,Da,[[]])}setState(e){kt(kr,this).setData(e);let n=!1;try{kt(Kn,this).buildTree()}catch{kt(Kn,this).clear(),kt(kr,this).clear(),n=!0}return Vc(Da,this,Ff(kt(Kn,this).getRoots())),n}setColumnsLimit(e){kt(kr,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ge(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});kt(kr,this).mergeWith(n),kt(Kn,this).buildTree(),Vc(Da,this,Ff(kt(Kn,this).getRoots()))}mapState(e){kt(kr,this).map(e),kt(Kn,this).buildTree(),Vc(Da,this,Ff(kt(Kn,this).getRoots()))}mapNodes(e){return si(kt(Kn,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=kt(Kn,this).getNode(n,i);let o;return r&&(o=fJ(e,r,i),Vc(Da,this,Ff(kt(Kn,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=kt(Da,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=kt(Kn,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let s=e;s<=n;s++){const a=kt(Kn,this).getRootByColumn(s);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=i&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},qH)}return r&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return kt(kr,this).getLayersCount()}getColumnsCount(){return kt(kr,this).getColumnsCount()}clear(){Vc(Da,this,[]),kt(kr,this).clear(),kt(Kn,this).clear()}}function Wc(t,e,n){return(e=vJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t){var e=CJ(t,"string");return typeof e=="symbol"?e:e+""}function CJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yJ{constructor(e,n){Wc(this,"hot",void 0),Wc(this,"nestedHeaderSettingsGetter",void 0),Wc(this,"layersCount",0),Wc(this,"container",void 0),Wc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Wu(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function bJ(t,e){nA(t,e),e.add(t)}function PP(t,e,n){return(e=SJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SJ(t){var e=RJ(t,"string");return typeof e=="symbol"?e:e+""}function RJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bc(t,e,n){nA(t,e),e.set(t,n)}function nA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bo(t,e,n){return t.set(Lt(t,e),n),n}function Ue(t,e){return t.get(Lt(t,e))}function Lt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IP="nestedHeaders",EJ=280;var gt=new WeakMap,vs=new WeakMap,Eh=new WeakMap,Mw=new WeakMap,dm=new WeakMap,Ut=new WeakSet;class _J extends nt{constructor(){super(...arguments),bJ(this,Ut),Bc(this,gt,new wJ),Bc(this,vs,null),Bc(this,Eh,null),Bc(this,Mw,!1),Bc(this,dm,null),PP(this,"ghostTable",new yJ(this.hot,(e,n)=>this.getHeaderSettings(e,n))),PP(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return IP}static get PLUGIN_PRIORITY(){return EJ}isEnabled(){return!!this.hot.getSettings()[IP]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&it(ut`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Lt(Ut,this,WJ).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,BJ).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,IJ).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,xJ).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,OJ).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,HJ).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,AJ).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,NJ).call(e,...r)}),this.addHook("afterSelection",()=>Lt(Ut,this,Vf).call(this)),this.addHook("afterSelectionFocusSet",()=>Lt(Ut,this,Vf).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,TJ).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Lt(Ut,this,kJ).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,$J).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,FJ).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,MJ).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,PJ).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,DJ).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,LJ).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Lt(Ut,e,VJ).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Lt(Ut,this,Vf).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Lt(Ut,this,Vf).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ue(gt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ue(gt,this).setState(e)),this.detectedOverlappedHeaders&&it(ut`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";Ue(gt,this).triggerColumnModification(r,i)}),!Ue(vs,this)&&this.enabled&&Bo(vs,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:s}=i;if(r==="replace"){const a=s===!0?"hide-column":"show-column";Ue(gt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ue(gt,this).clear(),Ue(vs,this).unsubscribe(),Bo(vs,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ue(gt,this)}getLayersCount(){return Ue(gt,this).getLayersCount()}getHeaderSettings(e,n){return Ue(gt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=i.childNodes[s];if(!a)break;const l=r.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),be(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),be(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),be(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),o.removeAttribute("colspan"),be(o,"hiddenHeader"),be(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ue(gt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var m,y,C;const{wtOverlays:E}=l._wt,b=(m=E.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),$=(y=E.inlineStartOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o);((C=E.topOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o))&&u<i&&q(o,"hiddenHeaderText");const F=b||$?Math.min(c,i-r):c;F>1&&o.setAttribute("colspan",F)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(be(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=Ue(gt,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){Bo(gt,this,null),Ue(vs,this)!==null&&(Ue(vs,this).unsubscribe(),Bo(vs,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ue(gt,this).getHeaderTreeNodeData(e.row,e.col)}}function Vf(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=Ue(gt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=r,o.visualCellRange.from.col=r,o.visualCellRange.to.col=r,o.commit()}}function TJ(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?r.row:(n=Ue(dm,this))===null||n===void 0?void 0:n.row,l=s?t:r.col,u=a<0&&l>=0;if(Bo(dm,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ue(gt,this).findLeftMostColumnIndex(a,l),m=Ue(gt,this).findRightMostColumnIndex(a,l),y=m-f+1;if(f<c&&m>h)return f;if(s){let C=null;return f>=c&&m>h?y>d?(e.value="start",C=f):(e.value="end",C=m):f<c&&m<=h&&(y>d?(e.value="end",C=m):(e.value="start",C=f)),C}return f<=c?f:m}function MJ(t,e,n){const i=Ue(gt,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ue(gt,this).getHeaderSettings(e,t);if(o===bS){if(!a)return i.columnIndex}else if(o===n1&&(l>s-r||!a))return null;return t}function PJ(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var r;const m=c+f,y=d-a;if(y===0)continue;((r=Ue(gt,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[m][y]="")}}}function IJ(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function xJ(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Bo(Eh,this,e.clone()),Bo(Mw,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,s,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(cS(t)||el(t)&&l||$F(t))&&o.push(s,s+a-1,e.row),i.selectColumns(...o)}function OJ(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:s}=r,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=Xe(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function HJ(){Bo(Mw,this,!1)}function AJ(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ue(Mw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=Ue(gt,this).getHeaderTreeNodeData(Ue(Eh,this).row,Ue(Eh,this).col);if(e.setHighlight(Ue(Eh,this)),o>e.getWidth()||r<n||r+o-1>i){const s=Ue(gt,this).findTopMostEntireHeaderLevel(Xe(n,r,r+o-1),Xe(i,r,r+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function NJ(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=Ue(gt,this).findLeftMostColumnIndex(n.row,n.col),o=Ue(gt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=r&&e.col<=o?r-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=r&&e.col<=o?o+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function DJ(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});Bo(dm,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function kJ(t){if(Ue(gt,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ue(gt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function LJ(t){const e=Ue(gt,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=Ue(gt,this).findLeftMostColumnIndex(r,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Vn(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?Ue(gt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function $J(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function FJ(t,e,n){var i;const{label:r}=(i=Ue(gt,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function VJ(t,e){if(t<0)return this.hot.getCell(t,Ue(gt,this).findLeftMostColumnIndex(t,e),!0)}function WJ(){this.updatePlugin()}function BJ(t,e){e||this.updatePlugin()}function jc(t,e,n){return(e=jJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jJ(t){var e=UJ(t,"string");return typeof e=="symbol"?e:e+""}function UJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zJ{constructor(e,n){jc(this,"hot",void 0),jc(this,"data",null),jc(this,"plugin",void 0),jc(this,"parentReference",new WeakMap),jc(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:r!=null&&a===r?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,i,r),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(M(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(pe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),pe(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];M(i,o=>{r.push(this.getDataObject(o))}),M(r,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,s=e;r&&r.__children&&r.__children.length===0?(o=r,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(s,n,...i):o.__children.splice(s,n):i?this.data.splice(s,n,...i):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function xP(t,e,n){return(e=YJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=GJ(t,"string");return typeof e=="symbol"?e:e+""}function GJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OR{constructor(e,n){xP(this,"hot",void 0),xP(this,"plugin",void 0),this.hot=n,this.plugin=e}}class zr extends OR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),q(n,zr.CSS_CLASSES.indicatorContainer),r){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",pe(0,r-1,()=>{const d=c.createElement("SPAN");q(d,zr.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ee(c,[ml()]),q(n,zr.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(q(c,`${zr.CSS_CLASSES.button} ${zr.CSS_CLASSES.expandButton}`),u&&Ee(n,[Bi(!1)])):(q(c,`${zr.CSS_CLASSES.button} ${zr.CSS_CLASSES.collapseButton}`),u&&Ee(n,[Bi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let r=11;i.isClassicTheme()||(r=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class KJ extends OR{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(i.lastCollapsedRows,(a,l)=>{a>=r&&a<o&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{pe(r,r+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);Se(e.target,zr.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Cr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function qJ(t,e,n){XJ(t,e),e.set(t,n)}function XJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZJ(t,e,n){return(e=QJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=JJ(t,"string");return typeof e=="symbol"?e:e+""}function JJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eee(t,e){return t.get(tee(t,e))}function tee(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OP=new WeakMap;class nee extends OR{constructor(){super(...arguments),ZJ(this,"dataManager",this.plugin.dataManager),qJ(this,OP,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(_p)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Tp)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pe(0,e.items.length-1,i=>{if(i===0)return M(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pe(0,e.items.length-1,n=>{const i=eee(OP,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function Wf(t,e,n){return(e=iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oee{constructor(e){Wf(this,"plugin",void 0),Wf(this,"hot",void 0),Wf(this,"dataManager",void 0),Wf(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(m=>{if(!l)return!1;const y=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(y,a),y}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let s=!1;return Ht(r)&&(it(ut`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let s=null;e[i-1]<n?s=this.dataManager.translateTrimmedRow(n-i):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function see(t,e){iA(t,e),e.add(t)}function HP(t,e,n){iA(t,e),e.set(t,n)}function iA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wy(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cg(t,e){return t.get(dn(t,e))}function fm(t,e,n){return t.set(dn(t,e),n),n}function dn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gm="nestedRows",uee=300,AP=gm,cee="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Pw=new WeakMap,eu=new WeakMap,pn=new WeakSet;class hee extends nt{constructor(){super(...arguments),see(this,pn),wy(this,"dataManager",null),wy(this,"headersUI",null),wy(this,"collapsedRowsMap",null),HP(this,Pw,!1),HP(this,eu,!1)}static get PLUGIN_KEY(){return gm}static get PLUGIN_PRIORITY(){return uee}isEnabled(){return!!this.hot.getSettings()[gm]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new rd),this.dataManager=new zJ(this,this.hot),this.collapsingUI=new KJ(this,this.hot),this.headersUI=new zr(this,this.hot),this.contextMenuUI=new nee(this,this.hot),this.rowMoveController=new oee(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,_ee).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,Tee).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,gee).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,mee).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,pee).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,fee).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,Cee).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,vee).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,yee).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,bee).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,See).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,Ree).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,wee).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,Eee).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(pn,e,dee).call(e,...i)}),this.addHook("beforeLoadData",n=>dn(pn,this,NP).call(this,n)),this.addHook("beforeUpdateData",n=>dn(pn,this,NP).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:AP,relativeToGroup:Ys,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AP)}disableCoreAPIModifiers(){fm(eu,this,!0)}enableCoreAPIModifiers(){fm(eu,this,!1)}onModifyRowData(e){if(!Cg(eu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Cg(eu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return Cg(eu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function dee(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function fee(t,e,n){this.collapsingUI.toggleState(t,e,n)}function gee(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),fm(Pw,this,!0),this.dataManager.getData().slice()}function mee(t){return this.contextMenuUI.appendOptions(t)}function pee(t,e){this.headersUI.appendLevelIndicators(t,e)}function wee(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function vee(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{fm(Pw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Cee(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(s)&&s.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function yee(){this.collapsingUI.collapsedRowsStash.stash()}function bee(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function See(){this.collapsingUI.collapsedRowsStash.stash()}function Ree(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Eee(){this.dataManager.rewriteCache()}function _ee(){this.headersUI.updateRowHeaderWidth()}function Tee(t,e){Cg(Pw,this)&&(e.skipRender=!0)}function NP(t){if(!Gj(t)){hS(cee),this.hot.getSettings()[gm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function vy(t,e,n){return(e=Mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=Pee(t,"string");return typeof e=="symbol"?e:e+""}function Pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;vy(this,"rootWindow",void 0),vy(this,"prefix",void 0),vy(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function xee(t,e,n){return(e=Oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:e+""}function Hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}se.getSingleton().register("persistentStateSave");se.getSingleton().register("persistentStateLoad");se.getSingleton().register("persistentStateReset");const DP="persistentState",Aee=0;class Nee extends nt{constructor(){super(...arguments),xee(this,"storage",void 0)}static get PLUGIN_KEY(){return DP}static get PLUGIN_PRIORITY(){return Aee}isEnabled(){return!!this.hot.getSettings()[DP]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Iee(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Dee(t,e){kee(t,e),e.add(t)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cy(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yy="search",Fee=190,Vee="htSearchResult",Wee=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},Bee=function(t,e,n){return Ht(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ht(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var by=new WeakSet;class jee extends nt{constructor(){super(...arguments),Dee(this,by),Cy(this,"callback",Wee),Cy(this,"queryMethod",Bee),Cy(this,"searchResultClass",Vee)}static get PLUGIN_KEY(){return yy}static get PLUGIN_PRIORITY(){return Fee}isEnabled(){return this.hot.getSettings()[yy]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[yy];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return kP(by,e,LP).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return kP(by,e,LP).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return pe(0,r-1,l=>{pe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||i)(e,c,h);if(m){const y={row:l,col:u,data:c};s.push(y)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){We(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function LP(t,e,n,i,r,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Bf(t,e,n){return(e=Uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:e+""}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rA{constructor(e){Bf(this,"viewportWidth",void 0),Bf(this,"overwriteColumnWidthFn",void 0),Bf(this,"baseWidths",new Map),Bf(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Yee extends rA{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=Iu?(r.push([d,m]),a+=m):f!==m&&(r.push([d,m]),o.push(d),s-=m)}),s<=Iu){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;r.forEach((h,d)=>{let[f,m]=h,y=m;o.includes(f)||(y=Math.round(m*l)),this.stretchedWidths.set(f,y),u=f,d<r.length-1&&(c+=y)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function $P(t,e,n){Gee(t,e),e.set(t,n)}function Gee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sy(t,e){return t.get(oA(t,e))}function jf(t,e,n){return t.set(oA(t,e),n),n}function oA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uf=new WeakMap,Uc=new WeakMap;class Kee extends rA{constructor(){super(...arguments),$P(this,Uf,0),$P(this,Uc,-1)}prepare(e){super.prepare(e),jf(Uf,this,0),jf(Uc,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),jf(Uc,this,e),jf(Uf,this,n)}calculate(){if(Sy(Uc,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+Sy(Uf,this),0);this.stretchedWidths.set(Sy(Uc,this),n)}}function qee(t,e){sA(t,e),e.add(t)}function zf(t,e,n){sA(t,e),e.set(t,n)}function sA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(wu(t,e))}function Ry(t,e,n){return t.set(wu(t,e),n),n}function wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xee="stretchColumns";var Pn=new WeakMap,tu=new WeakMap,Ey=new WeakMap,Yf=new WeakMap,zc=new WeakSet;class Zee{constructor(e){qee(this,zc),zf(this,Pn,void 0),zf(this,tu,void 0),zf(this,Ey,new Map([["all",new Yee(wu(zc,this,FP).bind(this))],["last",new Kee(wu(zc,this,FP).bind(this))]])),zf(this,Yf,"none"),Ry(Pn,this,e),Ry(tu,this,zt(Pn,this).columnIndexMapper.createAndRegisterIndexMap(Xee,"physicalIndexToValue"))}useStrategy(e){Ry(Yf,this,zt(Ey,this).has(e)?e:"none")}refreshStretching(){if(zt(Yf,this)==="none"){zt(tu,this).clear();return}zt(Pn,this).batchExecution(()=>{zt(tu,this).clear();const e=zt(Ey,this).get(zt(Yf,this));let i=zt(Pn,this).view.getViewportWidth();wu(zc,this,Qee).call(this)&&(i-=vn(zt(Pn,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<zt(Pn,this).countCols();r++)zt(Pn,this).columnIndexMapper.isHidden(zt(Pn,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,wu(zc,this,Jee).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,s]=r;zt(tu,this).setValueAtIndex(zt(Pn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return zt(tu,this).getValueAtIndex(zt(Pn,this).toPhysicalColumn(e))}}function Qee(){const{view:t}=zt(Pn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=zt(Pn,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let r=0,o=!1;for(let a=0;a<n;a++){var s;if(r+=((s=zt(Pn,this).getRowHeight(a))!==null&&s!==void 0?s:i)+(a===0?1:0),r>e){o=!0;break}}return o}function Jee(t){var e;return(e=zt(Pn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Iu}function FP(t,e){return zt(Pn,this).runHooks("beforeStretchingColumnWidth",t,e)}function ete(t,e){aA(t,e),e.add(t)}function _y(t,e,n){aA(t,e),e.set(t,n)}function aA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ty(t,e,n){return t.set(mm(t,e),n),n}function Mo(t,e){return t.get(mm(t,e))}function mm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tte="stretchColumns",nte=155;var hu=new WeakMap,Gf=new WeakMap,Yc=new WeakMap,My=new WeakSet;class ite extends nt{constructor(){super(...arguments),ete(this,My),_y(this,hu,new Zee(this.hot)),_y(this,Gf,null),_y(this,Yc,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Mo(Gf,this)!==null&&Mo(Gf,this)!==r.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),Ty(Gf,this,r.width)})})}))}static get PLUGIN_KEY(){return tte}static get PLUGIN_PRIORITY(){return nte}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Mo(hu,this).useStrategy(this.hot.getSettings().stretchH),Mo(Yc,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mm(My,e,ote).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return mm(My,e,rte).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Mo(hu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Mo(Yc,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Mo(hu,this).getStretchedWidth(e)}destroy(){Mo(Yc,this).disconnect(),Ty(Yc,this,null),Ty(hu,this,null),super.destroy()}}function rte(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function ote(t){t&&Mo(hu,this).refreshStretching()}function ste(t,e){ate(t,e),e.add(t)}function ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kf(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Py(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cte="touchScroll",hte=200;var qf=new WeakSet;class dte extends nt{constructor(){super(...arguments),ste(this,qf),Kf(this,"scrollbars",[]),Kf(this,"clones",[]),Kf(this,"lockedCollection",!1),Kf(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return cte}static get PLUGIN_PRIORITY(){return hte}static get SETTING_KEYS(){return!0}isEnabled(){return Px()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Py(qf,this,fte).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Py(qf,this,gte).call(this)),this.addHook("afterMomentumScroll",()=>Py(qf,this,mte).call(this))}}function fte(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function gte(){this.freezeOverlays=!0,M(this.clones,t=>{q(t,"hide-tween")})}function mte(){this.freezeOverlays=!1,M(this.clones,t=>{be(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{be(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function pte(t,e){wte(t,e),e.add(t)}function wte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vte(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yg="trimRows",Ste=330;var VP=new WeakSet;class Rte extends nt{constructor(){super(...arguments),pte(this,VP),vte(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return yg}static get PLUGIN_PRIORITY(){return Ste}isEnabled(){return!!this.hot.getSettings()[yg]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new rd),this.trimmedRowsMap.addLocalHook("init",()=>bte(VP,this,Ete).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[yg];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(M(e,l=>{o[l]=!1}),r=si(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&s,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function Ete(){const t=this.hot.getSettings()[yg];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function _te(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gi{constructor(e){_te(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Xf(t,e,n){return(e=Pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pte(t){var e=Ite(t,"string");return typeof e=="symbol"?e:e+""}function Ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HR extends Gi{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),Xf(this,"stateBefore",void 0),Xf(this,"range",void 0),Xf(this,"type",void 0),Xf(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,s)=>{n.done(()=>new HR({stateBefore:i,range:r,type:o,alignment:s}))})}undo(e,n){M(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ys(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,s)=>e.setCellMeta(i,r,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function WP(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Ote(t,"string");return typeof e=="symbol"?e:e+""}function Ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AR extends Gi{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),WP(this,"columns",void 0),WP(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new AR({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),MR(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function BP(t,e,n){return(e=Hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Ate(t,"string");return typeof e=="symbol"?e:e+""}function Ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NR extends Gi{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),BP(this,"previousSortState",void 0),BP(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{o&&n.done(()=>new NR({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function jP(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:e+""}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DR extends Gi{constructor(e){let{index:n,amount:i}=e;super("insert_col"),jP(this,"index",void 0),jP(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new DR({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function UP(t,e,n){return(e=kte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=Lte(t,"string");return typeof e=="symbol"?e:e+""}function Lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kR extends Gi{constructor(e){let{index:n,amount:i}=e;super("insert_row"),UP(this,"index",void 0),UP(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new kR({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Zf(t,e,n){return(e=$te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $te(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LR extends Gi{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),Zf(this,"changes",void 0),Zf(this,"selected",void 0),Zf(this,"countCols",void 0),Zf(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new LR({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=Wn(this.changes);for(let s=0,a=i.length;s<a;s++)i[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const i=Wn(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function zP(t,e,n){return(e=Vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:e+""}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $R extends Gi{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),zP(this,"conditionsStack",void 0),zP(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new $R({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function Bte(t,e,n){return(e=jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jte(t){var e=Ute(t,"string");return typeof e=="symbol"?e:e+""}function Ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FR extends Gi{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),Bte(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),s=i.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new FR({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function lA(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return pe(i,r,l=>{pe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ro(t,e,n){return(e=zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:e+""}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VR extends Gi{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ro(this,"index",void 0),Ro(this,"indexes",void 0),Ro(this,"data",void 0),Ro(this,"amount",void 0),Ro(this,"headers",void 0),Ro(this,"columnPositions",void 0),Ro(this,"rowPositions",void 0),Ro(this,"fixedColumnsStart",void 0),Ro(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+i)%e.countCols(),c=u+r-1,h=[],d=[],f=[];return pe(l.length-1,m=>{const y=[],C=l[m];pe(u,c,E=>{y.push(C[e.toPhysicalColumn(E)])}),h.push(y)}),pe(r-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&pe(r-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new VR({index:u,indexes:f,data:h,amount:r,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:lA(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(r[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ge(this.data[c],o));const l=Ge(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),M(e.getSourceDataArray(),(c,h)=>{M(r,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&M(l,(c,h)=>{e.getSettings().colHeaders[r[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function nu(t,e,n){return(e=Gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WR extends Gi{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),nu(this,"index",void 0),nu(this,"data",void 0),nu(this,"fixedRowsBottom",void 0),nu(this,"fixedRowsTop",void 0),nu(this,"rowIndexesSequence",void 0),nu(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,s)=>{const a=()=>{const l=e.toPhysicalRow(i),u=l+r-1,c=Wn(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new WR({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:lA(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);r.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function YP(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Xte(t,"string");return typeof e=="symbol"?e:e+""}function Xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BR extends Gi{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),YP(this,"rows",void 0),YP(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new BR({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),MR(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Zte(t,e,n){return(e=Qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:e+""}function Jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jR extends Gi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Zte(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new jR({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function ene(t,e){[HR,AR,NR,DR,kR,LR,$R,FR,VR,WR,BR,jR].forEach(n=>n.startRegisteringEvents(t,e))}function tne(t,e){nne(t,e),e.add(t)}function nne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iy(t,e,n){return(e=ine(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ine(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GP="undoRedo",one="undoRedo",sne=1e3;se.getSingleton().register("beforeUndo");se.getSingleton().register("afterUndo");se.getSingleton().register("beforeRedo");se.getSingleton().register("afterRedo");const KP=new Set;var Qf=new WeakSet;class ane extends nt{static get PLUGIN_KEY(){return one}static get PLUGIN_PRIORITY(){return sne}static get SETTING_KEYS(){return!0}constructor(e){super(e),tne(this,Qf),Iy(this,"doneActions",[]),Iy(this,"undoneActions",[]),Iy(this,"ignoreNewActions",!1),ene(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return xy(Qf,e,lne).call(e,...i)}),this.registerShortcuts(),xy(Qf,this,une).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),xy(Qf,this,cne).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:GP};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(GP)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Wn(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Wn(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function lne(t,e){e==="loadData"&&this.clear()}function une(){const t=e=>{KP.has(e)||(it(ut`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),KP.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function cne(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function hne(){Ze(uh),Ze(_q),Ze(ch),Ze(n3),Ze(c3),Ze(xO),Ze(oX),Ze(jX),Ze(bw),Ze(Q4),Ze(E9),Ze(H9),Ze(Ew),Ze(g6),Ze(u7),Ze(B7),Ze(m5),Ze(M5),Ze(F5),Ze(X5),Ze(sZ),Ze(EZ),Ze(AZ),Ze(pQ),Ze(KQ),Ze(JQ),Ze(_J),Ze(hee),Ze(Nee),Ze(jee),Ze(ite),Ze(dte),Ze(Rte),Ze(ane)}function dne(){q2(),vK(),MK(),GK(),hne()}/**
 * @preserve
 * Authors: Handsoncode, Enrique Enciso
 * Last updated: Nov 18, 2022
 *
 * Description: Definition file for Spanish - Mexico language-country.
 */const fne={languageCode:"es-MX",[jm]:"Insertar fila arriba",[Um]:"Insertar fila abajo",[zm]:"Insertar columna izquierda",[Ym]:"Insertar columna derecha",[Gm]:["Eliminar fila","Eliminar filas"],[Km]:["Eliminar columna","Eliminar columnas"],[qm]:"Deshacer",[Xm]:"Rehacer",[Nh]:"Solo lectura",[Zm]:"Limpiar columna",[hp]:"Alineación",[dp]:"Izquierda",[fp]:"Centro",[gp]:"Derecha",[mp]:"Justificar",[pp]:"Superior",[wp]:"Medio",[vp]:"Inferior",[ip]:"Congelar columna",[rp]:"Descongelar columna",[Cp]:"Bordes",[yp]:"Superior",[bp]:"Derecho",[Sp]:"Inferior",[Rp]:"Izquierdo",[Ep]:"Quitar borde(s)",[ap]:"Agregar comentario",[lp]:"Editar comentario",[up]:"Borrar comentario",[cp]:"Comentario Solo de lectura",[op]:"Unir celdas",[sp]:"Separar celdas",[Qm]:"Copiar",[Jm]:["Copiar con encabezado","Copiar con encabezados"],[ep]:["Copiar con encabezado de grupo","Copiar con encabezados de grupos"],[tp]:["Copiar solo el encabezado","Copiar solo los encabezados"],[np]:"Cortar",[_p]:"Insertar fila hija",[Tp]:"Separar del padre",[Mp]:["Esconder columna","Esconder columnas"],[Pp]:["Mostrar columna","Mostrar columnas"],[Ip]:["Esconder fila","Esconder filas"],[xp]:["Mostrar fila","Mostrar filas"],[od]:"Ninguna",[Op]:"Está vacío",[Hp]:"No está vacío",[Ap]:"Es igual a",[Np]:"No es igual a",[Dp]:"Comienza con",[kp]:"Termina con",[Lp]:"Contiene",[$p]:"No contiene",[Fp]:"Mayor que",[Vp]:"Mayor o igual que",[Wp]:"Menor que",[Bp]:"Menor o igual que",[jp]:"Es entre",[Up]:"No es entre",[zp]:"Después",[Yp]:"Antes",[Gp]:"Hoy",[Kp]:"Mañana",[qp]:"Ayer",[Dh]:"Celdas vacías",[Xp]:"Filtrar por condición",[Zp]:"Filtrar por valor",[Qp]:"Y",[sd]:"O",[Jp]:"Seleccionar todo",[ew]:"Borrar",[tw]:"OK",[nw]:"Cancelar",[iw]:"Buscar",[rw]:"Valor",[ow]:"Valor secundario"},gne={class:"d-flex flex-column align-center w-100 px-4"},mne={key:2,class:"mt-4 text-body-1"},pne={key:3,class:"mt-2 text-caption"},wne={__name:"LoadingOverlay",props:{isLoading:{type:Boolean,required:!0},loadingMessage:{type:String,default:""},loadingProgress:{type:Number,default:0},loadingError:{type:[Error,null],default:null},persistent:{type:Boolean,default:!1},size:{type:[Number,String],default:64},width:{type:[Number,String],default:5},color:{type:String,default:"primary"},opacity:{type:[Number,String],default:.7},showProgress:{type:Boolean,default:!1},progressType:{type:String,default:"circular",validator:t=>["circular","linear"].includes(t)}},setup(t){return(e,n)=>{const i=Ne("v-progress-circular"),r=Ne("v-progress-linear"),o=Ne("v-alert"),s=Ne("v-overlay");return on(),Zr(s,{"model-value":t.isLoading,persistent:t.persistent,class:"align-center justify-center text-center",opacity:t.opacity},{default:re(()=>[ue("div",gne,[t.progressType==="circular"?(on(),Zr(i,{key:0,indeterminate:!t.showProgress,"model-value":t.loadingProgress,size:t.size,width:t.width,color:t.color},null,8,["indeterminate","model-value","size","width","color"])):t.progressType==="linear"?(on(),Zr(r,{key:1,indeterminate:!t.showProgress,"model-value":t.loadingProgress,height:8,color:t.color,class:"mt-2 w-100",rounded:"",striped:""},null,8,["indeterminate","model-value","color"])):No("",!0),t.loadingMessage?(on(),Yr("div",mne,Tt(t.loadingMessage),1)):No("",!0),t.showProgress&&t.progressType==="circular"?(on(),Yr("div",pne,Tt(t.loadingProgress)+"% ",1)):No("",!0),t.loadingError?(on(),Zr(o,{key:4,type:"error",class:"mt-4"},{default:re(()=>[qe(" Error: "+Tt(t.loadingError.message),1)]),_:1})):No("",!0)])]),_:1},8,["model-value","persistent","opacity"])}}},vne=Tb(wne,[["__scopeId","data-v-fefc68f6"]]),bg={all:async()=>{try{return(await Ks.get("/planes/")).data}catch(t){throw console.error("Axios: fetch ",t),t}},porId:async t=>{try{return(await Ks.get("/planes/"+t+"/")).data}catch(e){throw console.error("Axios: fetch  id "+t,e),e}},crear:async t=>{try{return(await Ks.post("/planes/",t)).data}catch(e){throw console.error("Axios: Error al crear ",e),e}},update:async(t,e)=>{try{return(await Ks.put("/planes/"+t+"/",e)).data}catch(n){throw console.error("Axios: Error al actualizar  id "+t,n),n}},delete:async t=>{try{return(await Ks.del("/planes/"+t+"/")).data}catch(e){throw console.error("Axios: Error al eliminar  plan con  id"+t,e),e}},planIdProyecto:async t=>{try{return(await Ks.get("/planes/?proyecto_id="+t)).data}catch(e){throw console.error("Axios: fetch planes por id de proyecto "+t,e),e}},planProyecto:async t=>{try{return(await Ks.get("/proyectos/"+t+"/planificacion/")).data}catch(e){throw console.error("Axios: fetch plan por id de proyecto "+t,e),e}},getIndicadoresOgCount:async t=>(await Hw.get("/proyectos/"+t+"/indicadores-og/count/")).data.count||0,getResultadoOgCount:async t=>(await Hw.get("/proyectos/"+t+"/resultados-og/count/")).data.count||0,getColumnasCount:async t=>{try{return(await Hw.get("/proyectos/"+t+"/column-stats/")).data}catch(e){throw console.error("Axios: fallo al extraer conteos",e),e}}},Cne=SA("planificacion",()=>{const t=lt(!1),e=lt(null),n=lt(null),i=lt([]),r=lt(!1),o=lt(null),s=lt({columns:[],indicators:!0,version:1}),a=Object.freeze({objetivoPei:0,indicadorPei:1,objetivoGeneral:2,indicadorOg:3,resultadoOg:4,indicadorResultadoOg:5,objetivoEspecifico:6,indicadorOe:7,productoOe:8,resultadoOe:9,indicadorResultadoOe:10}),l=()=>({indicadores_og:1,resultados_og:1,objetivos_especificos:1,indicadores_oe:1,productos_oe:1}),u=Qn(()=>C=>{var E,b;return((b=(E=n.value)==null?void 0:E.proyecto)==null?void 0:b.id)===C}),c=Qn(()=>{var C;return((C=n.value)==null?void 0:C.version)||1}),h=async C=>{try{const E=await bg.getColumnasCount(C);return o.value=E,m(E),E}catch(E){console.error("Error fetching column stats:",E);const b=l();return m(b),b}},d=async C=>{try{t.value=!0,e.value=null;const[E,b]=await Promise.all([bg.planProyecto(C),h(C)]);return E.exists?(n.value=E.planificacion,console.log(b)):(await f(C),console.log(b)),r.value=!0,n.value}catch(E){throw e.value=E,E}finally{t.value=!1}},f=async(C,E=null)=>{try{t.value=!0,e.value=null;const b=E||await h(C),$={proyecto:C,table_config:y(b),rows_data:[],version:1},W=await bg.crear($);return n.value=W,W}catch(b){e.value=b}finally{t.value=!1}},m=C=>{const E=[];C.indicadores_og||E.push(a.indicadorOg),C.resultados_og||E.push(a.resultadoOg,a.indicadorResultadoOg),C.objetivos_especificos||E.push(a.objetivoEspecifico,a.indicadorOe),C.productos_oe||E.push(a.productoOe),C.resultados_oe||E.push(a.resultadoOe,a.indicadorResultadoOe),s.value={columns:[...new Set(E)].sort((b,$)=>b-$),indicators:!0,version:s.value.version+1}},y=C=>{const E=[];return C.indicadores_og||E.push(a.indicadorOg),C.resultados_og||E.push(a.resultadoOg,a.indicadorResultadoOg),C.objetivos_especificos||E.push(a.objetivoEspecifico,a.indicadorOe),C.productos_oe||E.push(a.productoOe),{hiddenColumns:{columns:[...new Set(E)].sort((b,$)=>b-$),indicators:!0}}};return{loading:t,error:e,inicializado:r,currentPlanificacion:n,columnStats:o,columnasEscondidas:s,revisiones:i,hasPlanificacion:u,getCurrentVersion:c,fetchPlanificacion:d}});function yne(t=!1){const e=lt(t),n=lt(""),i=lt(0),r=lt(null);return{isLoading:e,loadingMessage:n,loadingProgress:i,loadingError:r,withLoading:async(a,l="",u=!1)=>{e.value=!0,n.value=l,r.value=null,u&&(i.value=0);try{return await a}catch(c){throw r.value=c,c}finally{e.value=!1,n.value="",i.value=100}},setProgress:a=>{i.value=Math.min(100,Math.max(0,a))},startLoading:(a="")=>{e.value=!0,n.value=a},stopLoading:()=>{e.value=!1,n.value=""}}}function bne(t){return Object.keys(t).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]).join(", ")}function Sne(t){if(!t||typeof t!="object")return"";const e=t.id??"",n=t.codigo??"",i=t.descripcion??"";return`${e} - ${n} - ${i}`}const Rne={class:"hotWraper"},Ene={class:"content-wrapper"},_ne={class:"excel-panel"},Tne={key:0,class:"side-panel"},Mne={class:"panel-section"},Pne={class:"panel-section"},Ine={class:"stats-grid"},xne={class:"stat-item"},One={class:"stat-value"},Hne={class:"stat-item"},Ane={class:"stat-value"},Nne={class:"stat-item"},Dne={class:"stat-value"},kne={class:"panel-section"},Lne={class:"text-right"},$ne={class:"text-right"},Fne={class:"panel-section"},Vne={class:"chart-container"},Wne={class:"chart-legend"},Bne={class:"panel-section"},jne={class:"panel-section"},Une={class:"mb-3"},zne={class:"mb-3"},Yne={class:"mb-3"},Gne={class:"text-right"},Kne={class:"text-right"},qne={class:"text-center"},Xne={class:"font-weight-bold"},Zne={class:"text-right"},Qne={class:"text-right"},Jne={__name:"PlanificacionXls",props:{proyecto:{type:Object,required:!0},proyectoEstructura:{type:Object,required:!0},cargando:{type:Boolean,default:!0}},setup(t){const e=t;dne(),BS(fne);const n=RA("peiVigente"),r=XP().params.id,o=n.value.id,s=Sne(e.proyectoEstructura.objetivo_general),a=qA.tipo_actividad,l=bne(e.proyectoEstructura.instancia_gestora),{isLoading:u,loadingMessage:c,loadingProgress:h,loadingError:d}=yne(),{opcionesEntidadFinanciera:f,fetchOptions:m}=XA(),y=Cne(),{currentPlanificacion:C,columnasEscondidas:E,loading:b,inicializado:$}=ZP(y),{fetchPlanificacion:W}=y;console.log(E.value.columns);const F=lt([]),x=lt(["Objetivo PEI","Indicadores PEI","Objetivo General","Indicador OG","Resultado OG","Indicador Resultado OG","Objetivo Especifico","Indicador OE","Producto OE","Resultado OE","Indicador Resultado OE","Programa/Area","Responsable","Actividad Nueva","Proceso","Actividad Estructura","Actividad - CODIGO","Actividad","Proceso de la Actividad","Tipo actividad","Fecha Inicio","Fecha Cierre","Supuestos Riesgos","Presupuesto Programa","Presupuesto Global","Total Reportado","Total Ejecutado","Saldo","Grado de ejecucion","Medios de verificacion"]),A=Qn(()=>({columns:E.value.columns,indicators:!0})),Z=lt([{data:"objetivoPei",type:"dropdown",width:300,source:function(Y,_){fetch("http://127.0.0.1:8000/api/pei/"+o+"/listobj/").then(L=>L.json()).then(L=>{_(L.data)}).catch(L=>{console.error("Error:",L),_([])})},strict:!0,validator:function(Y,_){_(!0)}},{data:"indicadorPei",type:"dropdown",width:200,source:function(Y,_){const L=this.instance.getSourceDataAtRow(this.row);if(!(L!=null&&L.objetivoPei))return _([]);const J=L.objetivoPei.split("-")[0];fetch(`http://127.0.0.1:8000/api/objetivos/${J}/indicadores-compactos/`).then(_e=>_e.json()).then(_e=>{if(_e.data.length>0&&!L.idindpei){const ie=_e.data[0].split("-")[0];this.instance.setDataAtRowProp(this.row,"idindpei",ie)}_(_e.data)}).catch(()=>_([]))},afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"objetivoGeneral",type:"text",width:200,readOnly:!0},{data:"indicadorOg",type:"dropdown",width:200,source:function(Y,_){fetch("http://127.0.0.1:8000/api/proyectos/"+r+"/indicadores-og/").then(L=>L.json()).then(L=>{_(L.data)}).catch(L=>{console.error("Error:",L),_([])})},strict:!0,validator:function(Y,_){_(!0)}},{data:"resultadoOg",type:"dropdown",width:200,source:async function(Y,_){try{const J=await(await fetch(`http://127.0.0.1:8000/api/proyectos/${r}/resultados-og/`)).json();this.instance.resultadosOGData=J.data,_(J.data.map(_e=>_e.display_text))}catch(L){console.error("Error cargando resultados OG:",L),_([])}},afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"indicadorResultadoOg",type:"dropdown",width:200,source:async function(Y,_){const L=this.instance.getSourceDataAtRow(this.row),J=L==null?void 0:L.resultadoOgId;if(!J)return _([]);try{const ie=await(await fetch(`http://127.0.0.1:8000/api/resultados-og/${J}/indicadores/`)).json();this.instance.indicadoresResultadoOGData=ie.data,_(ie.data.map(me=>me.display_text))}catch(_e){console.error("Error cargando indicadores:",_e),_([])}},afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"objetivoEspecifico",type:"dropdown",width:200,source:function(Y,_){fetch("http://127.0.0.1:8000/api/proyectos/"+r+"/objetivos-especificos/").then(L=>L.json()).then(L=>{if(L.success){const J=[...L.data.proyecto,...L.data.objetivo_general];_(J)}else _([])}).catch(()=>_([]))}},{data:"indicadorOe",type:"dropdown",width:200,source:function(Y,_){const L=this.instance.getSourceDataAtRow(this.row),J=L==null?void 0:L.objetivoEspecifico;if(!J)return _([]);const _e=J.split("-")[0].trim();fetch(`http://127.0.0.1:8000/api/objetivos-especificos/${_e}/indicadores/`).then(ie=>ie.json()).then(ie=>{if(ie.success){if(_(ie.data),ie.data.length>0&&!L.idioe){const me=ie.data[0].split("-")[0];this.instance.setDataAtRowProp(this.row,"idioe",me)}}else _([])}).catch(ie=>{console.error("Error al cargar indicadores:",ie),_([])})},strict:!0,afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"productoOe",type:"dropdown",width:200,source:function(Y,_){const L=this.instance.getSourceDataAtRow(this.row),J=L==null?void 0:L.objetivoEspecifico;if(!J)return _([]);const _e=J.split("-")[0].trim();fetch(`http://127.0.0.1:8000/api/objetivos-especificos/${_e}/productos/`).then(ie=>ie.json()).then(ie=>{if(ie.success){if(_(ie.data),ie.data.length>0&&!L.idpoe){const me=ie.data[0].split("-")[0];this.instance.setDataAtRowProp(this.row,"idpoe",me)}}else _([])}).catch(ie=>{console.error("Error al cargar productos:",ie),_([])})},strict:!0,afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"resultadoOe",type:"dropdown",width:200,source:function(Y,_){const L=this.instance.getSourceDataAtRow(this.row),J=L==null?void 0:L.objetivoEspecifico;if(!J)return _([]);const _e=J.split("-")[0].trim();fetch(`http://127.0.0.1:8000/api/objetivos-especificos/${_e}/resultados/`).then(ie=>ie.json()).then(ie=>{if(ie.success){if(_(ie.data),ie.data.length>0&&!L.idresoe){const me=ie.data[0].split("-")[0];this.instance.setDataAtRowProp(this.row,"idresoe",me)}}else _([])}).catch(ie=>{console.error("Error al cargar resultados:",ie),_([])})},strict:!0,afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"indicadorResultadoOe",type:"dropdown",width:200,source:function(Y,_){const L=this.instance.getSourceDataAtRow(this.row),J=L==null?void 0:L.resultadoOe;if(!J)return _([]);const _e=J.split("-")[0].trim();fetch(`http://127.0.0.1:8000/api/resultados-oe/${_e}/indicadores/`).then(ie=>ie.json()).then(ie=>{if(ie.success){if(_(ie.data),ie.data.length>0&&!L.idiroe){const me=ie.data[0].split("-")[0];this.instance.setDataAtRowProp(this.row,"idiroe",me)}}else _([])}).catch(ie=>{console.error("Error al cargar indicadores:",ie),_([])})},strict:!0,afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"programa_area",type:"text",width:200},{data:"responsable",type:"text",width:200},{data:"actividad_nueva",type:"checkbox",width:150,className:"htCenter"},{data:"proceso",type:"autocomplete",width:200,async source(Y,_){fetch("http://127.0.0.1:8000/api/proyectos/"+r+"/procesos/").then(L=>L.json()).then(L=>{const J=L.map(_e=>_e.display_name);_(J)}).catch(L=>{console.error("Error cargando procesos:",L),_([])})},strict:!1,readOnly:!0},{data:"actividad",type:"dropdown",width:200,source:function(Y,_){fetch(`http://127.0.0.1:8000/api/proyectos/${r}/actividades/`).then(L=>L.json()).then(L=>{const J=L.map(_e=>_e.display_text);_(J),L.length>0&&(this.instance.actividadesData=L)}).catch(L=>{console.error("Error cargando actividades:",L),_([])})},readOnly:!0,strict:!0,afterGetColHeader:function(Y,_){Y===this.prop&&_.addEventListener("click",()=>{this.instance.updateSettings({})})}},{data:"actividad_cod",type:"text",width:150,readOnly:!1},{data:"actividad_titulo",type:"text",width:200,readOnly:!1},{data:"procesoActividad",type:"autocomplete",width:200,async source(Y,_){fetch("http://127.0.0.1:8000/api/proyectos/"+r+"/procesos/").then(L=>L.json()).then(L=>{const J=L.map(_e=>_e.display_name);_(J)}).catch(L=>{console.error("Error cargando procesos:",L),_([])})},strict:!1,readOnly:!1},{data:"tipo_actividad",type:"dropdown",width:200,source:a},{data:"fecha_inicio",type:"date",width:150},{data:"fecha_cierre",type:"date",width:150,source:[]},{data:"supuestosRiesgos",type:"text",width:200},{data:"presupuestoPrograma",type:"numeric",width:200,renderer:function(Y,_,L,J,_e,ie){_.innerHTML="";const me=document.createElement("div");return me.className="budget-cell",me.innerHTML=O(ie||0),me.onclick=un=>{un.stopPropagation()},_.appendChild(me),_}},{data:"presupuestoGlobal",type:"numeric",width:200},{data:"totalReportado",type:"numeric",width:200},{data:"totalEjecutado",type:"numeric",width:200},{data:"saldo",type:"numeric",width:200},{data:"gradoEjecucion",type:"dropdown",width:200,source:["PLANIFICADA","RETRASO","REPROGRAMACION","EN EJECUCION","EN REPORTE","FINALIZADO"]},{data:"medioVerificacion",type:"text",width:200,renderer:function(Y,_,L,J,_e,ie,me){_.innerHTML="";const un=document.createElement("button");return un.className="btn-celda",un.textContent="Acción",un.addEventListener("click",ai=>{ai.stopPropagation(),console.log("Botón clickeado en fila:",L),z(L)}),_.appendChild(un),_},editor:!1}]),K=Y=>{var _e;const _=(_e=ne.value)==null?void 0:_e.hotInstance;if(!_)return;const J=_.getSourceDataAtRow(Y).actividad_nueva;_.setCellMeta(Y,_.propToCol("proceso"),"readOnly",J),_.setCellMeta(Y,_.propToCol("actividad"),"readOnly",J),_.setCellMeta(Y,_.propToCol("actividad_cod"),"readOnly",!J),_.setCellMeta(Y,_.propToCol("actividad_titulo"),"readOnly",!J),J?(_.setDataAtRowProp(Y,"proceso",""),_.setDataAtRowProp(Y,"actividad","")):(_.setDataAtRowProp(Y,"actividad_cod",""),_.setDataAtRowProp(Y,"actividad_titulo","")),_.render()},z=Y=>{alert("Medios de verificacion"),console.log("Acción ejecutada para fila:",Y)};QP(async()=>{await le()});const le=async()=>{try{await W(r),await m()}catch(Y){console.error("Error al cargar datos",Y)}};JP(()=>{var Y;return(Y=C.value)==null?void 0:Y.rows_data},Y=>{Y&&JSON.stringify(Y)!==JSON.stringify(F.value)&&(F.value=[...Y])},{deep:!0});const ne=lt(null);Qn(()=>{var Y;return(Y=ne.value)==null?void 0:Y.hotInstance});const ve=(Y,_)=>{_==="edit"&&Y.forEach(([L,J,_e,ie])=>{var un,ai;const me=(un=ne.value)==null?void 0:un.hotInstance;if(me){if(J==="actividad_nueva"&&K(L),J==="objetivoPei"){if(me.setDataAtRowProp(L,"indicadorPei",""),me.setDataAtRowProp(L,"idindpei",""),ie){const De=ie.split("-")[0];fetch(`http://127.0.0.1:8000/api/objetivos/${De}/indicadores-compactos/`).then(ct=>ct.json()).then(ct=>{var br;if(((br=ct.data)==null?void 0:br.length)>0){const is=ct.data[0].split("-")[0];me.setDataAtRowProp(L,"idindpei",is)}})}me.updateSettings({})}if(J==="indicadorPei"&&ie){const De=ie.split("-")[0];me.setDataAtRowProp(L,"idindpei",De)}if(J==="objetivoEspecifico"&&(me.setDataAtRowProp(L,"indicadorOe",""),me.setDataAtRowProp(L,"idioe",""),me.setDataAtRowProp(L,"productoOe",""),me.setDataAtRowProp(L,"idpoe",""),me.setDataAtRowProp(L,"resultadoOe",""),me.setDataAtRowProp(L,"idresoe",""),me.setDataAtRowProp(L,"indicadorResultadoOe",""),me.setDataAtRowProp(L,"idiroe",""),ie&&ie.split("-")[0].trim(),me.updateSettings({})),J==="indicadorOe"&&ie){const De=ie.split("-")[0].trim();me.setDataAtRowProp(L,"idioe",De)}if(J==="productoOe"&&ie){const De=ie.split("-")[0].trim();me.setDataAtRowProp(L,"idpoe",De)}if(J==="resultadoOe"){if(me.setDataAtRowProp(L,"indicadorResultadoOe",""),me.setDataAtRowProp(L,"idiroe",""),ie){const De=ie.split("-")[0].trim();me.setDataAtRowProp(L,"idresoe",De)}me.updateSettings({})}if(J==="indicadorResultadoOe"&&ie){const De=ie.split("-")[0].trim();me.setDataAtRowProp(L,"idiroe",De)}if(J==="resultadoOg"&&(me.setDataAtRowProp(L,"indicadorResultadoOg",""),me.setDataAtRowProp(L,"indicadorResultadoOgId",""),ie&&me.resultadosOGData)){const De=me.resultadosOGData.find(ct=>ct.display_text===ie);De&&(me.setDataAtRowProp(L,"resultadoOgId",De.id),me.updateSettings({}))}if(J==="indicadorResultadoOg"&&ie&&me.indicadoresResultadoOGData){const De=me.indicadoresResultadoOGData.find(ct=>ct.display_text===ie);De&&me.setDataAtRowProp(L,"indicadorResultadoOgId",De.id)}if(J==="actividad"&&ie){const De=(ai=me.actividadesData)==null?void 0:ai.find(ct=>ct.display_text===ie);De!=null&&De.proceso?me.setDataAtRowProp(L,"proceso",`${De.proceso.codigo} - ${De.proceso.titulo}`):me.setDataAtRowProp(L,"proceso","")}if(J==="fecha_inicio"&&ie){const De=me.getDataAtRowProp(L,"fecha_cierre");De&&new Date(ie)>new Date(De)&&me.setDataAtRowProp(L,"fecha_cierre",ie)}if(J==="fecha_cierre"&&ie){const De=me.getDataAtRowProp(L,"fecha_inicio");De&&new Date(ie)<new Date(De)&&me.setDataAtRowProp(L,"fecha_inicio",ie)}J==="tipo_actividad"&&ie&&console.log(`Tipo de actividad cambiado a: ${ie}`)}})},ye={objetivoPei:"",indicadorPei:"",objetivoGeneral:s,programa_area:l,actividad_nueva:!0,actividad_cod:"",actividad_titulo:"",proceso:"",actividad:""},Ie=async()=>{F.value.push({...ye})},Nt=async()=>{alert("Reprogramar planificacion")},Me=async()=>{},je=async()=>{var Y;try{u.value=!0,c.value="Generando archivo Excel...";const _=(Y=ne.value)==null?void 0:Y.hotInstance;if(!_)throw new Error("No se pudo acceder a la tabla");const L=_.getSourceData(),J=_.getColHeader(),_e=L.map(ai=>{const De={};return J.forEach((ct,br)=>{const is=_.colToProp(br);De[ct]=ai[is],ct==="Fecha Inicio"||ct==="Fecha Cierre"?De[ct]=Rt(ai[is]):(ct.includes("Presupuesto")||ct==="Total Reportado"||ct==="Total Ejecutado"||ct==="Saldo")&&(De[ct]={t:"n",v:Number(ai[is])||0,z:"$#,##0.00"})}),De}),ie=qs.json_to_sheet(_e);ie["!cols"]=J.map(()=>({width:20}));const me=qs.book_new();qs.book_append_sheet(me,ie,"Planificación");const un=`Planificacion_${e.proyecto.nombre}_${new Date().toISOString().slice(0,10)}.xlsx`;KR(me,un)}catch(_){console.error("Error al exportar:",_),d.value="Error al generar el archivo Excel"}finally{u.value=!1,c.value=""}},Rt=Y=>{if(!Y)return"";const[_,L,J]=Y.split("/");return`${J}-${L}-${_}`},gn=async()=>{alert("Guardar planificacion");try{b.value=!0,await bg.update(C.value.id,{rows_data:F.value,proyecto:C.value.proyecto})}catch(Y){console.error("Error al guardar",Y)}finally{b.value=!1}},Sn=lt(!1),g=async()=>{Sn.value=!Sn.value},w=lt("info"),p=lt(15e4),H=lt(87500);Qn(()=>p.value-H.value);const k=Qn(()=>H.value/p.value*100),B=lt(24),G=lt(8),X=lt(5),v=Qn(()=>B.value-G.value-X.value),R=Qn(()=>X.value/B.value*100),S=Qn(()=>[{estado:"Completadas",cantidad:X.value,porcentaje:Math.round(X.value/B.value*100),icon:"mdi-check-circle",color:"success"},{estado:"En progreso",cantidad:G.value,porcentaje:Math.round(G.value/B.value*100),icon:"mdi-progress-clock",color:"warning"},{estado:"Pendientes",cantidad:v.value,porcentaje:Math.round(v.value/B.value*100),icon:"mdi-alert-circle",color:"error"}]),O=Y=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Y),P=Qn(()=>({items:{row_above:{name:"Insertar fila arriba",callback:function(){const Y=this.getSelectedLast();F.value.splice(Y[0],0,{...ye}),this.render()}},row_below:{name:"Insertar fila abajo",callback:function(){const Y=this.getSelectedLast();F.value.splice(Y[0]+1,0,{...ye}),this.render()}},hsep1:"---------",remove_row:{name:"Eliminar fila",disabled:function(){return this.getSelectedLast()[0]===void 0},callback:function(){const Y=this.getSelectedLast();F.value.splice(Y[0],1),this.render()}},hsep2:"---------",copy:{name:"Copiar",callback:function(){this.copy()}},paste:{name:"Pegar",callback:function(){this.paste()}},clear_custom:{name:"Limpiar contenido",callback:function(){const Y=this.getSelected();this.setDataAtCell(Y,"")}},hsep3:"---------",budget_breakdown:{name:"Desglose de presupuesto",callback:function(){const Y=this.getSelectedLast();Y[0]!==void 0&&st(Y[0])}},verification_media:{name:"Medios de verificación",callback:function(){const Y=this.getSelectedLast();Y[0]!==void 0&&z(Y[0])}},export_budget:{name:"Exportar desglose presupuesto",callback:function(){const Y=this.getSelectedLast();Y[0]!==void 0&&N(Y[0])}}}})),N=Y=>{var _;try{const L=(_=ne.value)==null?void 0:_.hotInstance;if(!L)throw new Error("No se pudo acceder a la tabla");const J=L.getSourceDataAtRow(Y);if(!J.desglosePresupuesto||J.desglosePresupuesto.length===0){alert("Esta fila no tiene desglose de presupuesto");return}const _e=[["INFORMACIÓN GENERAL"],["Actividad:",J.actividad_titulo||J.actividad||"Sin nombre"],["Presupuesto total:",J.presupuestoPrograma],["Ejecutado:",J.totalEjecutado],["Saldo:",J.saldo],[],["DETALLE DE PRESUPUESTO"],["Fuente","Monto","% del total","Tipo"]],ie=J.presupuestoPrograma||1;J.desglosePresupuesto.forEach(ct=>{_e.push([ct.nombre,ct.monto,{t:"n",v:ct.monto/ie,z:"0.00%"},ct.manual?"Manual":"Registrado"])});const me=J.desglosePresupuesto.reduce((ct,br)=>ct+br.monto,0);_e.push(["TOTAL",me,{t:"n",v:me/ie,z:"0.00%"},""]);const un=qs.aoa_to_sheet(_e);un["!cols"]=[{width:25},{width:15},{width:15},{width:15}],qs.sheet_add_aoa(un,[["","","",""]],{origin:-1,style:{fill:{fgColor:{rgb:"FFD9D9D9"}}}});const ai=qs.book_new();qs.book_append_sheet(ai,un,"Desglose Presupuesto");const De=`Desglose_${J.actividad_titulo||"presupuesto"}_${new Date().toISOString().slice(0,10)}.xlsx`;KR(ai,De)}catch(L){console.error("Error al exportar desglose:",L),alert("Error al exportar el desglose de presupuesto")}},j=lt(!1),T=lt([]),I=lt(0),V=lt(null),D=lt(null),U=lt({nombre:"",monto:0}),he=lt([]),ce=Qn(()=>T.value.reduce((Y,_)=>Y+(Number(_.monto)||0),0)),Pe=Qn(()=>I.value-ce.value),ze=Qn(()=>I.value>0?ce.value/I.value*100:0),st=Y=>{var J;const _=(J=ne.value)==null?void 0:J.hotInstance;if(!_)return;V.value=Y;const L=_.getSourceDataAtRow(Y);I.value=Number(L.presupuestoPrograma)||0,T.value=L.desglosePresupuesto?JSON.parse(JSON.stringify(L.desglosePresupuesto)):[],Ye(),j.value=!0},Te=()=>{j.value=!1,T.value=[],I.value=0,V.value=null,D.value=null,U.value={nombre:"",monto:0}},Ye=async()=>{try{await m(),he.value=f.value.map(Y=>({id:Y.id,nombre:Y.financiera}))}catch(Y){console.error("Error al cargar fuentes financieras:",Y),he.value=[]}},xt=()=>{if(!D.value)return;if(T.value.some(L=>L.id===D.value.id)){alert("Esta fuente ya ha sido agregada al desglose");return}const _={...D.value,monto:0};T.value.push(_),D.value=null},ao=()=>{if(!(!U.value.nombre||!U.value.monto)){if(Number(U.value.monto)>Pe.value){alert("El monto excede el saldo disponible");return}T.value.push({nombre:U.value.nombre,monto:Number(U.value.monto),manual:!0}),U.value={nombre:"",monto:0}}},ns=Y=>{T.value.splice(Y,1)},lo=Y=>{T.value[Y].monto<0&&(T.value[Y].monto=0),ce.value>I.value&&(T.value[Y].monto=Math.max(0,T.value[Y].monto-(ce.value-I.value))),T.value=[...T.value]},jt=Y=>I.value>0?(Number(Y)/I.value*100).toFixed(2):0,_i=()=>{var L;if(ce.value>I.value){alert("El total desglosado no puede exceder el presupuesto programado");return}const Y=(L=ne.value)==null?void 0:L.hotInstance;if(!Y||V.value===null)return;Y.setDataAtRowProp(V.value,"desglosePresupuesto",[...T.value]);const _=T.value.reduce((J,_e)=>J+(_e.ejecutado||0),0);Y.setDataAtRowProp(V.value,"totalEjecutado",_),Y.setDataAtRowProp(V.value,"saldo",I.value-_),Te()};return(Y,_)=>{const L=Ne("v-icon"),J=Ne("v-btn"),_e=Ne("v-tooltip"),ie=Ne("v-spacer"),me=Ne("v-toolbar"),un=Ne("v-tab"),ai=Ne("v-tabs"),De=Ne("v-divider"),ct=Ne("v-progress-linear"),br=Ne("v-window-item"),is=Ne("v-table"),uA=Ne("v-progress-circular"),cA=Ne("v-chip"),hA=Ne("v-list-item"),dA=Ne("v-list"),fA=Ne("v-window"),UR=Ne("v-card-text"),zR=Ne("v-card"),gA=Ne("v-toolbar-title"),mA=Ne("v-alert"),Gs=Ne("v-col"),Iw=Ne("v-row"),pA=Ne("v-autocomplete"),xw=Ne("v-text-field"),wA=Ne("v-card-actions"),vA=Ne("v-dialog");return on(),Yr(eh,null,[ue("div",Rne,[te(vne,{isLoading:Ai(u)||Ai(b),loadingMessage:Ai(c),loadingProgress:Ai(h),loadingError:Ai(d),progressType:"linear"},null,8,["isLoading","loadingMessage","loadingProgress","loadingError"]),ue("div",Ene,[ue("div",_ne,[te(me,{flat:"",density:"comfortable",class:"excel-toolbar"},{default:re(()=>[te(_e,{text:"Mostrar/Esconder Panel de informacion",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:g}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[7]||(_[7]=[qe("mdi-view-agenda")])),_:1,__:[7]})]),_:2},1040)]),_:1}),te(_e,{text:"Guardar Planificacion",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:gn}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[8]||(_[8]=[qe("mdi-content-save")])),_:1,__:[8]})]),_:2},1040)]),_:1}),te(_e,{text:"Reprogramar",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:Nt}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[9]||(_[9]=[qe("mdi-wrench-clock")])),_:1,__:[9]})]),_:2},1040)]),_:1}),te(_e,{text:"Agregar fila",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:Ie}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[10]||(_[10]=[qe("mdi-plus")])),_:1,__:[10]})]),_:2},1040)]),_:1}),te(_e,{text:"Eliminar fila seleccionada",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:Me}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[11]||(_[11]=[qe("mdi-delete")])),_:1,__:[11]})]),_:2},1040)]),_:1}),te(ie),te(_e,{text:"Exportar a Excel",location:"bottom"},{activator:re(({props:$e})=>[te(J,vl($e,{variant:"text",class:"excel-btn",onClick:je}),{default:re(()=>[te(L,{size:"18"},{default:re(()=>_[12]||(_[12]=[qe("mdi-microsoft-excel")])),_:1,__:[12]})]),_:2},1040)]),_:1})]),_:1}),Ai($)?(on(),Zr(Ai(zS),{key:0,ref_key:"hotTable",ref:ne,data:F.value,columns:Z.value,colHeaders:x.value,rowHeaders:!0,height:400,hiddenColumns:A.value,contextMenu:P.value,language:"es-Mx",afterChange:ve,licenseKey:"non-commercial-and-evaluation"},null,8,["data","columns","colHeaders","hiddenColumns","contextMenu"])):No("",!0)]),Sn.value?(on(),Yr("div",Tne,[te(zR,null,{default:re(()=>[te(ai,{modelValue:w.value,"onUpdate:modelValue":_[0]||(_[0]=$e=>w.value=$e),"bg-color":"primary"},{default:re(()=>[te(un,{value:"info"},{default:re(()=>[te(L,{left:""},{default:re(()=>_[13]||(_[13]=[qe("mdi-information")])),_:1,__:[13]}),_[14]||(_[14]=qe(" Información "))]),_:1,__:[14]}),te(un,{value:"presupuesto"},{default:re(()=>[te(L,{left:""},{default:re(()=>_[15]||(_[15]=[qe("mdi-cash")])),_:1,__:[15]}),_[16]||(_[16]=qe(" Presupuesto "))]),_:1,__:[16]}),te(un,{value:"actividades"},{default:re(()=>[te(L,{left:""},{default:re(()=>_[17]||(_[17]=[qe("mdi-checkbox-marked-circle")])),_:1,__:[17]}),_[18]||(_[18]=qe(" Actividades "))]),_:1,__:[18]})]),_:1},8,["modelValue"]),te(UR,null,{default:re(()=>[te(fA,{modelValue:w.value,"onUpdate:modelValue":_[2]||(_[2]=$e=>w.value=$e)},{default:re(()=>[te(br,{value:"info"},{default:re(()=>[ue("div",Mne,[_[21]||(_[21]=ue("h4",null,"Resumen del Proyecto",-1)),ue("p",null,[_[19]||(_[19]=ue("strong",null,"Nombre:",-1)),qe(" "+Tt(t.proyecto.nombre),1)]),ue("p",null,[_[20]||(_[20]=ue("strong",null,"Objetivo General:",-1)),qe(" "+Tt(Ai(s)),1)])]),te(De,{class:"my-4"}),ue("div",Pne,[_[25]||(_[25]=ue("h4",null,"Estadísticas",-1)),te(ct,{modelValue:R.value,"onUpdate:modelValue":_[1]||(_[1]=$e=>R.value=$e),height:"20",color:"primary",class:"mb-2"},{default:re(({value:$e})=>[ue("strong",null,Tt(Math.ceil($e))+"% completado",1)]),_:1},8,["modelValue"]),ue("div",Ine,[ue("div",xne,[ue("div",One,Tt(B.value),1),_[22]||(_[22]=ue("div",{class:"stat-label"},"Total",-1))]),ue("div",Hne,[ue("div",Ane,Tt(G.value),1),_[23]||(_[23]=ue("div",{class:"stat-label"},"En progreso",-1))]),ue("div",Nne,[ue("div",Dne,Tt(X.value),1),_[24]||(_[24]=ue("div",{class:"stat-label"},"Completadas",-1))])])])]),_:1}),te(br,{value:"presupuesto"},{default:re(()=>[ue("div",kne,[_[30]||(_[30]=ue("h4",null,"Resumen Presupuestario",-1)),te(is,{density:"compact",class:"budget-table"},{default:re(()=>[_[29]||(_[29]=ue("thead",null,[ue("tr",null,[ue("th",null,"Concepto"),ue("th",{class:"text-right"},"Monto")])],-1)),ue("tbody",null,[ue("tr",null,[_[26]||(_[26]=ue("td",null,"Presupuesto asignado",-1)),ue("td",Lne,Tt(O(p.value)),1)]),ue("tr",null,[_[27]||(_[27]=ue("td",null,"Ejecutado",-1)),ue("td",$ne,Tt(O(H.value)),1)]),ue("tr",null,[_[28]||(_[28]=ue("td",null,[ue("strong",null,"Saldo disponible")],-1)),ue("td",{class:YR(["text-right",{"text-error":Pe.value<0}])},[ue("strong",null,Tt(O(Pe.value)),1)],2)])])]),_:1,__:[29]})]),te(De,{class:"my-4"}),ue("div",Fne,[_[35]||(_[35]=ue("h4",null,"Distribución",-1)),ue("div",Vne,[te(uA,{rotate:90,size:150,width:15,value:k.value,color:"primary"},{default:re(()=>[qe(Tt(Math.round(k.value))+"% ",1)]),_:1},8,["value"]),ue("div",Wne,[ue("div",null,[te(L,{color:"primary"},{default:re(()=>_[31]||(_[31]=[qe("mdi-circle")])),_:1,__:[31]}),_[32]||(_[32]=qe(" Ejecutado"))]),ue("div",null,[te(L,{color:"grey"},{default:re(()=>_[33]||(_[33]=[qe("mdi-circle")])),_:1,__:[33]}),_[34]||(_[34]=qe(" Pendiente"))])])])])]),_:1}),te(br,{value:"actividades"},{default:re(()=>[ue("div",Bne,[_[36]||(_[36]=ue("h4",null,"Estado de Actividades",-1)),te(dA,{lines:"two",density:"compact"},{default:re(()=>[(on(!0),Yr(eh,null,GR(S.value,($e,Ku)=>(on(),Zr(hA,{key:Ku,title:$e.estado,"prepend-icon":$e.icon,subtitle:`${$e.cantidad} actividades`},{append:re(()=>[te(cA,{small:"",color:$e.color},{default:re(()=>[qe(Tt($e.porcentaje)+"%",1)]),_:2},1032,["color"])]),_:2},1032,["title","prepend-icon","subtitle"]))),128))]),_:1})]),te(De,{class:"my-4"}),ue("div",jne,[_[39]||(_[39]=ue("h4",null,"Acciones",-1)),te(J,{block:"",color:"primary",class:"mb-2",onClick:gn,"prepend-icon":"mdi-content-save"},{default:re(()=>_[37]||(_[37]=[qe(" Guardar cambios ")])),_:1,__:[37]}),te(J,{block:"",color:"secondary",onClick:je,"prepend-icon":"mdi-microsoft-excel"},{default:re(()=>_[38]||(_[38]=[qe(" Exportar a Excel ")])),_:1,__:[38]})])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])):No("",!0)])]),te(vA,{modelValue:j.value,"onUpdate:modelValue":_[6]||(_[6]=$e=>j.value=$e),"max-width":"800",persistent:""},{default:re(()=>[te(zR,null,{default:re(()=>[te(me,{color:"primary",dark:""},{default:re(()=>[te(gA,null,{default:re(()=>_[40]||(_[40]=[qe("Desglose de Presupuesto")])),_:1,__:[40]}),te(ie),te(J,{icon:"",onClick:Te},{default:re(()=>[te(L,null,{default:re(()=>_[41]||(_[41]=[qe("mdi-close")])),_:1,__:[41]})]),_:1})]),_:1}),te(UR,{class:"pa-4"},{default:re(()=>[ce.value>I.value?(on(),Zr(mA,{key:0,type:"error",class:"mb-4"},{default:re(()=>[qe(" La suma del desglose ("+Tt(O(ce.value))+") excede el presupuesto programado ("+Tt(O(I.value))+") ",1)]),_:1})):No("",!0),te(Iw,null,{default:re(()=>[te(Gs,{cols:"12",md:"6"},{default:re(()=>[ue("h4",Une,"Presupuesto Total: "+Tt(O(I.value)),1),ue("h4",zne,"Total Desglosado: "+Tt(O(ce.value)),1),ue("h4",Yne,[_[42]||(_[42]=qe(" Saldo Disponible: ")),ue("span",{class:YR({"text-error":Pe.value<0})},Tt(O(Pe.value)),3)])]),_:1}),te(Gs,{cols:"12",md:"6"},{default:re(()=>[te(ct,{value:ze.value,height:"20",color:ze.value>100?"error":"primary",striped:""},{default:re(({value:$e})=>[ue("strong",null,Tt(Math.ceil($e))+"% utilizado",1)]),_:1},8,["value","color"])]),_:1})]),_:1}),te(De,{class:"my-4"}),te(Iw,null,{default:re(()=>[te(Gs,{cols:"12",md:"8"},{default:re(()=>[te(pA,{modelValue:D.value,"onUpdate:modelValue":_[3]||(_[3]=$e=>D.value=$e),items:he.value,label:"Seleccionar fuente financiera","item-title":"nombre","item-value":"id","return-object":"",clearable:""},null,8,["modelValue","items"])]),_:1}),te(Gs,{cols:"12",md:"4"},{default:re(()=>[te(J,{color:"primary",block:"",disabled:!D.value,onClick:xt},{default:re(()=>_[43]||(_[43]=[qe(" Agregar Fuente ")])),_:1,__:[43]},8,["disabled"])]),_:1})]),_:1}),te(Iw,{class:"mt-2"},{default:re(()=>[te(Gs,{cols:"12",md:"5"},{default:re(()=>[te(xw,{modelValue:U.value.nombre,"onUpdate:modelValue":_[4]||(_[4]=$e=>U.value.nombre=$e),label:"Nombre de fuente nueva",clearable:""},null,8,["modelValue"])]),_:1}),te(Gs,{cols:"12",md:"5"},{default:re(()=>[te(xw,{modelValue:U.value.monto,"onUpdate:modelValue":_[5]||(_[5]=$e=>U.value.monto=$e),modelModifiers:{number:!0},type:"number",label:"Monto",min:"0",max:Pe.value,clearable:""},null,8,["modelValue","max"])]),_:1}),te(Gs,{cols:"12",md:"2"},{default:re(()=>[te(J,{color:"secondary",block:"",disabled:!U.value.nombre||!U.value.monto,onClick:ao},{default:re(()=>_[44]||(_[44]=[qe(" Agregar ")])),_:1,__:[44]},8,["disabled"])]),_:1})]),_:1}),te(is,{density:"compact",class:"mt-4"},{default:re(()=>[_[48]||(_[48]=ue("thead",null,[ue("tr",null,[ue("th",null,"Fuente"),ue("th",{class:"text-right"},"Monto"),ue("th",{class:"text-right"},"%"),ue("th",{class:"text-center"},"Acciones")])],-1)),ue("tbody",null,[(on(!0),Yr(eh,null,GR(T.value,($e,Ku)=>(on(),Yr("tr",{key:Ku},[ue("td",null,Tt($e.nombre),1),ue("td",Gne,[te(xw,{modelValue:$e.monto,"onUpdate:modelValue":[Ow=>$e.monto=Ow,Ow=>lo(Ku)],modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",min:0,max:I.value},null,8,["modelValue","onUpdate:modelValue","max"])]),ue("td",Kne,Tt(jt($e.monto))+"%",1),ue("td",qne,[te(J,{icon:"",size:"small",color:"error",onClick:Ow=>ns(Ku)},{default:re(()=>[te(L,null,{default:re(()=>_[45]||(_[45]=[qe("mdi-delete")])),_:1,__:[45]})]),_:2},1032,["onClick"])])]))),128)),ue("tr",Xne,[_[46]||(_[46]=ue("td",null,"Total",-1)),ue("td",Zne,Tt(O(ce.value)),1),ue("td",Qne,Tt(ze.value.toFixed(2))+"%",1),_[47]||(_[47]=ue("td",null,null,-1))])])]),_:1,__:[48]})]),_:1}),te(wA,{class:"pa-4"},{default:re(()=>[te(ie),te(J,{onClick:Te},{default:re(()=>_[49]||(_[49]=[qe("Cancelar")])),_:1,__:[49]}),te(J,{color:"primary",onClick:_i,disabled:ce.value>I.value},{default:re(()=>_[50]||(_[50]=[qe(" Guardar ")])),_:1,__:[50]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},eie=Tb(Jne,[["__scopeId","data-v-4a443bf2"]]),tie={__name:"ProyectoPlanificarView",setup(t){const e=lt(!1),n=lt(null),r=XP().params.id,o=CA(),{proyectoActual:s,cargando:a,proyectoEstructura:l}=ZP(o),{obtenerProyectoPorId:u,obtenerProyectoEstructuraPorId:c}=o;QP(async()=>{await h()}),JP([a,s,l],([d,f,m])=>{!d&&f&&m&&(e.value=!0)},{immediate:!0});const h=async()=>{try{n.value=null,await Promise.all([await u(r),await c(r)])}catch(d){console.erro("Error al cargar datos",d)}};return Qn(()=>a.value),(d,f)=>{const m=Ne("v-alert"),y=Ne("v-btn"),C=Ne("v-progress-circular"),E=Ne("v-overlay"),b=Ne("v-toolbar-title"),$=Ne("v-spacer"),W=Ne("v-toolbar"),F=Ne("v-card-text"),x=Ne("v-card"),A=Ne("v-col"),Z=Ne("v-row"),K=Ne("v-container");return on(),Zr(K,null,{default:re(()=>[te(E,{"model-value":!e.value,class:"align-center justify-center"},{default:re(()=>[n.value?(on(),Yr(eh,{key:0},[te(m,{type:"error",class:"mb-4"},{default:re(()=>[qe(Tt(n.value),1)]),_:1}),te(y,{color:"primary",onClick:h},{default:re(()=>f[0]||(f[0]=[qe("Reintentar")])),_:1,__:[0]})],64)):(on(),Yr(eh,{key:1},[te(C,{indeterminate:"",color:"primary",size:"64"}),f[1]||(f[1]=ue("p",{class:"mt-4 text-h6"},"Cargando Proyecto...",-1))],64))]),_:1},8,["model-value"]),e.value?(on(),Zr(Z,{key:0},{default:re(()=>[te(A,{cols:"12",md:"12"},{default:re(()=>[te(EA,{titulo:"planificacion",icon:"mdi-calendar"}),Ai(s)?(on(),Zr(_A,{key:0,proyecto:Ai(s)},null,8,["proyecto"])):No("",!0),te(x,{class:"mb-4","min-height":"800"},{default:re(()=>[te(W,{color:"info",density:"compact"},{default:re(()=>[te(b,null,{default:re(()=>f[2]||(f[2]=[qe("PLANIFICACION")])),_:1,__:[2]}),te($)]),_:1}),te(F,{class:"contenedor-planificacion"},{default:re(()=>[te(eie,{proyecto:Ai(s),"proyecto-estructura":Ai(l),cargando:!e.value},null,8,["proyecto","proyecto-estructura","cargando"])]),_:1})]),_:1})]),_:1})]),_:1})):No("",!0)]),_:1})}}},Hie=Tb(tie,[["__scopeId","data-v-69a6217d"]]);export{Hie as default};
