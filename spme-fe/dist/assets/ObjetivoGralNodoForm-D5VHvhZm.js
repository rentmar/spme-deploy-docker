import{y as F,r as c,c as M,z as R,e as r,g,f as y,w as l,d as e,h as T,l as d,t as A,p as H}from"./index-BV9e5Yt5.js";import{u as I,a as J,c as K}from"./ProyectoEstructuraView-DVKqiHsd.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./useProcedenciaFondos-DCzG2v-v.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const io={__name:"ObjetivoGralNodoForm",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(V,{emit:b}){const s=V,{updateObjetivoGeneral:C}=K(),{getNodes:x,getEdges:P,updateNode:w}=I(),{actualizarNodosEdges:N}=J(),k=b,E=F("proyectoEstructura"),t=c({...s.node.data}),p=c(!1),i=c(!1),v=M(()=>!s.node.id);R(()=>s.node,n=>{t.value={...n.data}},{deep:!0});const j=async()=>{try{const n=t.value.nodoProyecto.id,o=E.value.mapa_nodo.id;console.log(n),console.log(o),await C(n,t.value.nodoProyecto),w(t.value.id,t.value),await N(o,x.value,P.value),k("guardar")}catch(n){console.error("Update informacion",n)}},U=()=>{i.value=!0},D=async()=>{i.value=!1,p.value=!0};return(n,o)=>{const G=r("v-text-field"),m=r("v-textarea"),_=r("v-spacer"),u=r("v-btn"),f=r("v-card-actions"),O=r("v-icon"),q=r("v-card-title"),S=r("v-card-text"),$=r("v-card"),z=r("v-dialog"),B=r("v-form");return y(),g(B,{onSubmit:H(j,["prevent"])},{default:l(()=>[e(G,{modelValue:t.value.nodoProyecto.codigo,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.nodoProyecto.codigo=a),variant:"outlined",label:"Código",outlined:"",dense:"",clearable:"",rules:[a=>!!a||"Código requerido"]},null,8,["modelValue","rules"]),e(m,{modelValue:t.value.nodoProyecto.descripcion,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.nodoProyecto.descripcion=a),variant:"outlined",label:"Descripcion",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.supuestos,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.nodoProyecto.supuestos=a),variant:"outlined",label:"Supuestos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.riesgos,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.nodoProyecto.riesgos=a),variant:"outlined",label:"Riesgos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(f,null,{default:l(()=>[e(_),v.value?T("",!0):(y(),g(u,{key:0,color:"error",text:"",onClick:U},{default:l(()=>o[7]||(o[7]=[d(" Eliminar ")])),_:1,__:[7]})),e(u,{color:"error",text:"",onClick:o[4]||(o[4]=a=>n.$emit("cancelar"))},{default:l(()=>o[8]||(o[8]=[d("Cancelar")])),_:1,__:[8]}),e(u,{color:"primary",type:"submit",loading:p.value},{default:l(()=>[d(A(v.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),e(z,{modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=a=>i.value=a),"max-width":"400"},{default:l(()=>[e($,null,{default:l(()=>[e(q,{class:"text-h6"},{default:l(()=>[e(O,{left:"",color:"error"},{default:l(()=>o[9]||(o[9]=[d("mdi-alert-circle")])),_:1,__:[9]}),o[10]||(o[10]=d(" Confirmar eliminación "))]),_:1,__:[10]}),e(S,null,{default:l(()=>o[11]||(o[11]=[d(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[11]}),e(f,null,{default:l(()=>[e(_),e(u,{color:"grey",variant:"text",onClick:o[5]||(o[5]=a=>i.value=!1)},{default:l(()=>o[12]||(o[12]=[d(" Cancelar ")])),_:1,__:[12]}),e(u,{color:"error",variant:"flat",onClick:D},{default:l(()=>o[13]||(o[13]=[d(" Confirmar ")])),_:1,__:[13]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{io as default};
