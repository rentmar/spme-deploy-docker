import{y as J,o as K,r as p,c as Q,z as R,e as d,g as N,f as b,w as l,d as t,k as v,h as W,l as i,t as X,p as Y}from"./index-BV9e5Yt5.js";import{u as Z,a as h}from"./ProyectoEstructuraView-DVKqiHsd.js";import{S as y}from"./selectOptions-B5pGCBUk.js";import{u as oo}from"./useProyectoCrud-CvoteDjY.js";import{u as eo}from"./useProcedenciaFondos-DCzG2v-v.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const No={__name:"ProyectoNodoForm",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(C,{emit:x}){const m=C,E=y.instancia_gestora,U=y.estado,{updateProyecto:w}=oo(),{getNodes:P,getEdges:k,updateNode:F}=Z(),{actualizarNodosEdges:z}=h(),{fetchOptions:S,opcionesEntidadFinanciera:T}=eo(),q=x,D=J("proyectoEstructura");K(async()=>{await S()});const e=p({...m.node.data}),f=p(!1),r=p(!1),_=Q(()=>!m.node.id);R(()=>m.node,n=>{e.value={...n.data}},{deep:!0});const O=async()=>{try{const n=e.value.datosNodo.id,o=D.value.mapa_nodo.id;console.log(n),console.log(o),console.log("Form data"),console.log(e.value.datosNodo),await w(n,e.value.datosNodo),await F(e.value.id,e.value),await z(o,P.value,k.value),q("guardar")}catch(n){console.error("Update informacion",n)}},j=()=>{r.value=!0},$=async()=>{r.value=!1,f.value=!0};return(n,o)=>{const u=d("v-text-field"),B=d("v-textarea"),c=d("v-select"),g=d("v-spacer"),s=d("v-btn"),V=d("v-card-actions"),I=d("v-icon"),M=d("v-card-title"),G=d("v-card-text"),L=d("v-card"),A=d("v-dialog"),H=d("v-form");return b(),N(H,{onSubmit:Y(O,["prevent"])},{default:l(()=>[t(u,{modelValue:e.value.datosNodo.codigo,"onUpdate:modelValue":o[0]||(o[0]=a=>e.value.datosNodo.codigo=a),variant:"outlined",label:"Código",outlined:"",dense:"",clearable:"",rules:[a=>!!a||"Código requerido"]},null,8,["modelValue","rules"]),t(u,{modelValue:e.value.datosNodo.titulo,"onUpdate:modelValue":o[1]||(o[1]=a=>e.value.datosNodo.titulo=a),variant:"outlined",label:"Titulo",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),t(B,{modelValue:e.value.datosNodo.descripcion,"onUpdate:modelValue":o[2]||(o[2]=a=>e.value.datosNodo.descripcion=a),variant:"outlined",label:"Titulo",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),t(u,{label:"Fecha de inicio",modelValue:e.value.datosNodo.fecha_inicio,"onUpdate:modelValue":o[3]||(o[3]=a=>e.value.datosNodo.fecha_inicio=a),type:"date",variant:"outlined"},null,8,["modelValue"]),t(u,{label:"Fecha de finalizacion",modelValue:e.value.datosNodo.fecha_finalizacion,"onUpdate:modelValue":o[4]||(o[4]=a=>e.value.datosNodo.fecha_finalizacion=a),type:"date",variant:"outlined"},null,8,["modelValue"]),t(c,{modelValue:e.value.datosNodo.instancia_gestora,"onUpdate:modelValue":o[5]||(o[5]=a=>e.value.datosNodo.instancia_gestora=a),variant:"outlined",items:v(E),multiple:"",chips:"","item-value":"id","item-title":"instancia",label:"Instancia gestora",clearable:""},null,8,["modelValue","items"]),t(u,{modelValue:e.value.datosNodo.presupuesto,"onUpdate:modelValue":o[6]||(o[6]=a=>e.value.datosNodo.presupuesto=a),variant:"outlined",label:"Presupuesto",outlined:"",dense:"",clearable:""},null,8,["modelValue"]),t(c,{modelValue:e.value.datosNodo.estado,"onUpdate:modelValue":o[7]||(o[7]=a=>e.value.datosNodo.estado=a),variant:"outlined",items:v(U),"item-value":"valor","item-title":"etiqueta",label:"Estado del Proyecto",clearable:""},null,8,["modelValue","items"]),t(c,{modelValue:e.value.datosNodo.procedencia_fondos,"onUpdate:modelValue":o[8]||(o[8]=a=>e.value.datosNodo.procedencia_fondos=a),variant:"outlined",items:v(T),"item-value":"id","item-title":"financiera",label:"Procedencia de Fondos",multiple:"",chips:"",clearable:""},null,8,["modelValue","items"]),t(V,null,{default:l(()=>[t(g),_.value?W("",!0):(b(),N(s,{key:0,color:"error",text:"",onClick:j},{default:l(()=>o[12]||(o[12]=[i(" Eliminar ")])),_:1,__:[12]})),t(s,{color:"error",text:"",onClick:o[9]||(o[9]=a=>n.$emit("cancelar"))},{default:l(()=>o[13]||(o[13]=[i("Cancelar")])),_:1,__:[13]}),t(s,{color:"primary",type:"submit",loading:f.value},{default:l(()=>[i(X(_.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),t(A,{modelValue:r.value,"onUpdate:modelValue":o[11]||(o[11]=a=>r.value=a),"max-width":"400"},{default:l(()=>[t(L,null,{default:l(()=>[t(M,{class:"text-h6"},{default:l(()=>[t(I,{left:"",color:"error"},{default:l(()=>o[14]||(o[14]=[i("mdi-alert-circle")])),_:1,__:[14]}),o[15]||(o[15]=i(" Confirmar eliminación "))]),_:1,__:[15]}),t(G,null,{default:l(()=>o[16]||(o[16]=[i(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[16]}),t(V,null,{default:l(()=>[t(g),t(s,{color:"grey",variant:"text",onClick:o[10]||(o[10]=a=>r.value=!1)},{default:l(()=>o[17]||(o[17]=[i(" Cancelar ")])),_:1,__:[17]}),t(s,{color:"error",variant:"flat",onClick:$},{default:l(()=>o[18]||(o[18]=[i(" Confirmar ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{No as default};
