import{y as G,r as c,c as M,z as O,e as a,g,f as y,w as t,d as e,h as T,l as i,t as A,p as H}from"./index-BV9e5Yt5.js";import{u as I,a as J,b as L}from"./ProyectoEstructuraView-DVKqiHsd.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./useProcedenciaFondos-DCzG2v-v.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const io={__name:"KpiNodoForm",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(C,{emit:x}){const u=C,{updateKpi:V}=L(),{getNodes:b,getEdges:w,updateNode:k}=I(),{actualizarNodosEdges:N}=J(),E=x,m=G("proyectoEstructura"),r=c({...u.node.data}),p=c(!1),d=c(!1),v=M(()=>!u.node.id);O(()=>u.node,l=>{r.value={...l.data}},{deep:!0});const P=async()=>{try{const l=r.value.nodoProyecto.id;console.log(l);const o=m.value.mapa_nodo.id;console.log(m),await V(l,r.value.nodoProyecto),k(r.value.id,r.value),await N(o,b.value,w.value),E("guardar")}catch(l){console.error("Update informacion",l)}},D=()=>{d.value=!0},U=async()=>{d.value=!1,p.value=!0};return(l,o)=>{const q=a("v-text-field"),K=a("v-textarea"),_=a("v-spacer"),s=a("v-btn"),f=a("v-card-actions"),$=a("v-icon"),j=a("v-card-title"),z=a("v-card-text"),B=a("v-card"),F=a("v-dialog"),S=a("v-form");return y(),g(S,{onSubmit:H(P,["prevent"])},{default:t(()=>[e(q,{modelValue:r.value.nodoProyecto.codigo,"onUpdate:modelValue":o[0]||(o[0]=n=>r.value.nodoProyecto.codigo=n),variant:"outlined",label:"Código",outlined:"",dense:"",clearable:"",rules:[n=>!!n||"Código requerido"]},null,8,["modelValue","rules"]),e(K,{modelValue:r.value.nodoProyecto.descripcion,"onUpdate:modelValue":o[1]||(o[1]=n=>r.value.nodoProyecto.descripcion=n),variant:"outlined",label:"Descripción",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(f,null,{default:t(()=>[e(_),v.value?T("",!0):(y(),g(s,{key:0,color:"error",text:"",onClick:D},{default:t(()=>o[5]||(o[5]=[i(" Eliminar ")])),_:1,__:[5]})),e(s,{color:"error",text:"",onClick:o[2]||(o[2]=n=>l.$emit("cancelar"))},{default:t(()=>o[6]||(o[6]=[i("Cancelar")])),_:1,__:[6]}),e(s,{color:"primary",type:"submit",loading:p.value},{default:t(()=>[i(A(v.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),e(F,{modelValue:d.value,"onUpdate:modelValue":o[4]||(o[4]=n=>d.value=n),"max-width":"400"},{default:t(()=>[e(B,null,{default:t(()=>[e(j,{class:"text-h6"},{default:t(()=>[e($,{left:"",color:"error"},{default:t(()=>o[7]||(o[7]=[i("mdi-alert-circle")])),_:1,__:[7]}),o[8]||(o[8]=i(" Confirmar eliminación "))]),_:1,__:[8]}),e(z,null,{default:t(()=>o[9]||(o[9]=[i(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[9]}),e(f,null,{default:t(()=>[e(_),e(s,{color:"grey",variant:"text",onClick:o[3]||(o[3]=n=>d.value=!1)},{default:t(()=>o[10]||(o[10]=[i(" Cancelar ")])),_:1,__:[10]}),e(s,{color:"error",variant:"flat",onClick:U},{default:t(()=>o[11]||(o[11]=[i(" Confirmar ")])),_:1,__:[11]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{io as default};
