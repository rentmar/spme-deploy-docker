import{y as M,r as c,c as R,z as T,e as r,g,f as y,w as l,d as e,i as A,h as H,l as d,t as I,p as J}from"./index-BV9e5Yt5.js";import{u as K,a as L,g as Q}from"./ProyectoEstructuraView-DVKqiHsd.js";import"./proyectoStore-DvgR2axb.js";import"./proyectoService-wNf4fISD.js";import"./PaginaTituloIcono-CW0YRi1P.js";import"./ProyectoHeader-D5OgEq0F.js";import"./formatters-CqNDYFfu.js";import"./useInstanciaGestora-cSU6cze7.js";import"./peiService-DMb0o3t4.js";import"./xlsx-CM-TUkP_.js";import"./useProcedenciaFondos-DCzG2v-v.js";import"./ConfirmDialog-C6-Dbl5P.js";import"./useConfirmDialog-D-apekYG.js";/* empty css                                                                               */const so={__name:"ProductoOeNodoForm",props:{node:{type:Object,required:!0,default:()=>({id:null,data:{nodoProyecto:{codigo:"",descripcion:""}}})}},emits:["guardar","cancelar","eliminar"],setup(V,{emit:b}){const s=V,{updateProductoOe:x}=Q(),{getNodes:P,getEdges:C,updateNode:w}=K(),{actualizarNodosEdges:k}=L(),N=b,E=M("proyectoEstructura"),t=c({...s.node.data}),p=c(!1),u=c(!1),v=R(()=>!s.node.id);T(()=>s.node,n=>{t.value={...n.data}},{deep:!0});const U=async()=>{try{const n=t.value.nodoProyecto.id,o=E.value.mapa_nodo.id;console.log(n),console.log(o),await x(n,t.value.nodoProyecto),w(t.value.id,t.value),await k(o,P.value,C.value),N("guardar")}catch(n){console.error("Update informacion",n)}},D=()=>{u.value=!0},q=async()=>{u.value=!1,p.value=!0};return(n,o)=>{const B=r("v-text-field"),m=r("v-textarea"),O=r("v-checkbox"),_=r("v-spacer"),i=r("v-btn"),f=r("v-card-actions"),S=r("v-icon"),$=r("v-card-title"),j=r("v-card-text"),z=r("v-card"),F=r("v-dialog"),G=r("v-form");return y(),g(G,{onSubmit:J(U,["prevent"])},{default:l(()=>[e(B,{modelValue:t.value.nodoProyecto.codigo,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.nodoProyecto.codigo=a),variant:"outlined",label:"Codigo",outlined:"",dense:"",clearable:"",rules:[a=>!!a||"Código requerido"]},null,8,["modelValue","rules"]),e(m,{modelValue:t.value.nodoProyecto.descripcion,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.nodoProyecto.descripcion=a),variant:"outlined",label:"Descripcion",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.supuestos,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.nodoProyecto.supuestos=a),variant:"outlined",label:"Supuestos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(m,{modelValue:t.value.nodoProyecto.riesgos,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.nodoProyecto.riesgos=a),variant:"outlined",label:"Riesgos",outlined:"",dense:"",clearable:"",rows:"3"},null,8,["modelValue"]),e(O,{modelValue:t.value.nodoProyecto.entregado,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.nodoProyecto.entregado=a)},{label:l(()=>o[8]||(o[8]=[A("div",{class:"custom-label"},"Entregado",-1)])),_:1},8,["modelValue"]),e(f,null,{default:l(()=>[e(_),v.value?H("",!0):(y(),g(i,{key:0,color:"error",text:"",onClick:D},{default:l(()=>o[9]||(o[9]=[d(" Eliminar ")])),_:1,__:[9]})),e(i,{color:"error",text:"",onClick:o[5]||(o[5]=a=>n.$emit("cancelar"))},{default:l(()=>o[10]||(o[10]=[d("Cancelar")])),_:1,__:[10]}),e(i,{color:"primary",type:"submit",loading:p.value},{default:l(()=>[d(I(v.value?"Crear":"Guardar"),1)]),_:1},8,["loading"])]),_:1}),e(F,{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=a=>u.value=a),"max-width":"400"},{default:l(()=>[e(z,null,{default:l(()=>[e($,{class:"text-h6"},{default:l(()=>[e(S,{left:"",color:"error"},{default:l(()=>o[11]||(o[11]=[d("mdi-alert-circle")])),_:1,__:[11]}),o[12]||(o[12]=d(" Confirmar eliminación "))]),_:1,__:[12]}),e(j,null,{default:l(()=>o[13]||(o[13]=[d(" ¿Está seguro que desea eliminar este elemento? ")])),_:1,__:[13]}),e(f,null,{default:l(()=>[e(_),e(i,{color:"grey",variant:"text",onClick:o[6]||(o[6]=a=>u.value=!1)},{default:l(()=>o[14]||(o[14]=[d(" Cancelar ")])),_:1,__:[14]}),e(i,{color:"error",variant:"flat",onClick:q},{default:l(()=>o[15]||(o[15]=[d(" Confirmar ")])),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{so as default};
